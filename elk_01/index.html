<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Centos7 安装 ELK 7.6.2 - 易波叶平</title><meta name="Description" content="centos7 安装 ELK 7.6.2"><meta property="og:title" content="Centos7 安装 ELK 7.6.2" />
<meta property="og:description" content="centos7 安装 ELK 7.6.2" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.zhaouncle.com/elk_01/" />
<meta property="og:image" content="https://www.zhaouncle.com/logo.png"/>
<meta property="article:published_time" content="2020-06-08T15:36:44+08:00" />
<meta property="article:modified_time" content="2020-08-24T14:00:58+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.zhaouncle.com/logo.png"/>

<meta name="twitter:title" content="Centos7 安装 ELK 7.6.2"/>
<meta name="twitter:description" content="centos7 安装 ELK 7.6.2"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.zhaouncle.com/elk_01/" /><link rel="prev" href="https://www.zhaouncle.com/hugo/" /><link rel="next" href="https://www.zhaouncle.com/20200626/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><meta name="google-site-verification" content="L0x8CmbrOx9V21ZwTit7tRmDxdYk3kxALRLqR8GSFg0" /><meta name="msvalidate.01" content="C7D99901D0D018E2FA741CC205405B28" /><meta name="baidu-site-verification" content="Dnx20VKWrw" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Centos7 安装 ELK 7.6.2",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.zhaouncle.com\/elk_01\/"
        },"image": ["https:\/\/www.zhaouncle.com\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "elk, elasticsearch, kibana, logstash","wordcount":  3609 ,
        "url": "https:\/\/www.zhaouncle.com\/elk_01\/","datePublished": "2020-06-08T15:36:44+08:00","dateModified": "2020-08-24T14:00:58+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "目瞪狗呆","logo": "https:\/\/cdn.jsdelivr.net\/gh\/ZhaoUncle\/zhaouncle.github.io\/images\/blog\/avatar.png"},"author": {
                "@type": "Person",
                "name": "赵叔"
            },"description": "centos7 安装 ELK 7.6.2"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="易波叶平"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>易波叶平</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about"> 关于 </a><a class="menu-item" href="/categories/thoughts/" title="杂谈"> 杂谈 </a><a class="menu-item" href="https://link.zhaouncle.com" rel="noopener noreffer" target="_blank"><i class='fas fa-link fa-fw'></i>  </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><a class="menu-item" href="https://zhaouncle.com/uptime-status/" title="UpStatus" rel="noopener noreffer" target="_blank"><i class='fas fa-heart fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/elk_01/" selected>简体中文</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="易波叶平"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>易波叶平</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about" title="">关于</a><a class="menu-item" href="/categories/thoughts/" title="杂谈">杂谈</a><a class="menu-item" href="https://link.zhaouncle.com" title="" rel="noopener noreffer" target="_blank"><i class='fas fa-link fa-fw'></i></a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a class="menu-item" href="https://zhaouncle.com/uptime-status/" title="UpStatus" rel="noopener noreffer" target="_blank"><i class='fas fa-heart fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/elk_01/" selected>简体中文</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Centos7 安装 ELK 7.6.2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="http://zhaouncle.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>赵叔</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/elk/"><i class="far fa-folder fa-fw"></i>elk</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-06-08">2020-06-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3609 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;<span id="/elk_01/" class="leancloud_visitors" data-flag-title="Centos7 安装 ELK 7.6.2">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#10-初始化环境官网参考">1.0 初始化环境官网参考</a></li>
    <li><a href="#11-架构">1.1 架构</a></li>
    <li><a href="#12-配置-hosts">1.2 配置 hosts</a></li>
    <li><a href="#13-修改-hostname">1.3 修改 hostname</a></li>
    <li><a href="#14-时间同步联网状态">1.4 时间同步(联网状态)</a></li>
    <li><a href="#15-关闭-selinux">1.5 关闭 selinux</a></li>
    <li><a href="#16-关闭防火墙">1.6 关闭防火墙</a></li>
    <li><a href="#17-内存解锁和文件限制">1.7 内存解锁和文件限制</a></li>
    <li><a href="#18-关闭-swap-缓存">1.8 关闭 swap 缓存</a></li>
    <li><a href="#19-设置-es-用户内存限制大小">1.9 设置 es 用户内存限制大小</a></li>
    <li><a href="#110-不能-root-用户启动">1.10 不能 root 用户启动</a></li>
    <li><a href="#111-java版本">1.11 java版本</a></li>
  </ul>

  <ul>
    <li><a href="#21-官网下载">2.1 官网下载</a></li>
    <li><a href="#22-yum-直接安装则可">2.2 yum 直接安装则可</a></li>
    <li><a href="#23-es-配置修改3-台机都要其中-nodename-配置不同其他一样">2.3 es 配置修改，3 台机都要，其中 node.name 配置不同，其他一样</a></li>
    <li><a href="#24-如果是-yum-安装的方式需要修改es的启动文件">2.4 如果是 yum 安装的方式需要修改es的启动文件</a></li>
    <li><a href="#25-如果你要设置-es-的内存大小有两个地方">2.5 如果你要设置 es 的内存大小，有两个地方</a></li>
    <li><a href="#26--在-node01-配置证书我这里设置的空密码直接回车便可">2.6  在 node01 配置证书，我这里设置的空密码，直接回车便可。</a></li>
    <li><a href="#27-node01启动-es">2.7 node01启动 es</a></li>
    <li><a href="#28-node01配置账号密码完成tls通信">2.8 node01，配置账号密码完成tls通信</a></li>
    <li><a href="#29-将-node01-的证书-scp-到-02-和-03并启动-02-和-03的-es">2.9 将 node01 的证书 scp 到 02 和 03，并启动 02 和 03的 es</a></li>
    <li><a href="#210-基于-api-的检查集群是否搭建成功">2.10 基于 api 的检查，集群是否搭建成功。</a></li>
  </ul>

  <ul>
    <li><a href="#30-有哪些-web-ui">3.0 有哪些 web ui</a></li>
    <li><a href="#31-如果带账号密码访问的话-url">3.1 如果带账号密码访问的话 url</a></li>
    <li><a href="#32-安装web-ui管理工具elastichd">3.2 安装web UI管理工具ElasticHD:</a></li>
    <li><a href="#33-安装-elasticsearch--hq">3.3 安装 elasticsearch -HQ</a></li>
  </ul>

  <ul>
    <li><a href="#41-引用">4.1 引用：</a></li>
    <li><a href="#42-安装">4.2 安装：</a></li>
    <li><a href="#43-修改配置文件">4.3 修改配置文件</a></li>
    <li><a href="#44-启动">4.4 启动</a></li>
    <li><a href="#45-open-kibana-url">4.5 open kibana url</a></li>
    <li><a href="#46-内存限制">4.6 内存限制</a></li>
  </ul>

  <ul>
    <li><a href="#51-安装-logstash">5.1 安装 logstash</a></li>
    <li><a href="#52-配置文件">5.2 配置文件</a></li>
    <li><a href="#53-修改内存地址">5.3 修改内存地址</a></li>
    <li><a href="#54-手动测试输入-hello">5.4 手动测试，输入 hello</a></li>
  </ul>

  <ul>
    <li><a href="#61-安装">6.1 安装</a></li>
  </ul>

  <ul>
    <li><a href="#案例一官方例子">案例一：官方例子</a></li>
    <li><a href="#参考">参考：</a></li>
    <li><a href="#711在-node02-调整-logstash-配置">7.1.1在 node02 调整 logstash 配置</a></li>
    <li><a href="#712检查端口是否启动">7.1.2检查端口是否启动：</a></li>
    <li><a href="#713-在-node02-配置-filebeat">7.1.3 在 node02 配置 filebeat</a></li>
    <li><a href="#714-启动-filebeat">7.1.4 启动 filebeat</a></li>
    <li><a href="#715-在-kibana-打开management-elasticsearch-indexmanagement可以看到-filebeat-的索引">7.1.5 在 kibana 打开“Management”-&raquo;“Elasticsearch”-&raquo;“IndexManagement”，可以看到 filebeat 的索引</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="1-初始化环境">1. 初始化环境</h1>
<h2 id="10-初始化环境官网参考">1.0 初始化环境官网参考</h2>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config.html</a></p>
<h2 id="11-架构">1.1 架构</h2>
<table>
<thead>
<tr>
<th>主机 ip</th>
<th>hostname</th>
<th>安装的服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.110.245</td>
<td>node01</td>
<td>es、kibana</td>
</tr>
<tr>
<td>192.168.110.246</td>
<td>node02</td>
<td>es、logstash、filebeat、auditbeat</td>
</tr>
<tr>
<td>192.168.110.247</td>
<td>node03</td>
<td>es、filebeat、auditbeat</td>
</tr>
</tbody>
</table>
<h2 id="12-配置-hosts">1.2 配置 hosts</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">cat <span class="s">&lt;&lt; EOF &gt;&gt; /etc/hosts
</span><span class="s">192.168.110.245 node01
</span><span class="s">192.168.110.246 node02 
</span><span class="s">192.168.110.247 node03
</span><span class="s">EOF</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="13-修改-hostname">1.3 修改 hostname</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">hostnamectl set-hostname node01
hostnamectl set-hostname node02
hostnamectl set-hostname node03
</code></pre></td></tr></table>
</div>
</div><h2 id="14-时间同步联网状态">1.4 时间同步(联网状态)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">yum -y install ntpdate
/bin/echo <span class="s2">&#34;* */1 * * * /usr/sbin/ntpdate pool.ntp.org &gt; /dev/null 2&gt;&amp;1&#34;</span> &gt;&gt; /var/spool/cron/root
</code></pre></td></tr></table>
</div>
</div><h2 id="15-关闭-selinux">1.5 关闭 selinux</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">setenforce <span class="m">0</span> <span class="c1">#临时，马上生效</span>
sed -i <span class="s1">&#39;s/enforcing/disabled/&#39;</span> /etc/selinux/config <span class="c1">#永久，重启生效</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="16-关闭防火墙">1.6 关闭防火墙</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">iptables -F 
systemctl stop firewalld
systemctl disable firewalld
</code></pre></td></tr></table>
</div>
</div><h2 id="17-内存解锁和文件限制">1.7 内存解锁和文件限制</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#临时修改，重启失效</span>
<span class="nb">ulimit</span> -n <span class="m">65535</span>
<span class="c1">#永久修改，重启生效</span>
cat <span class="s">&lt;&lt; EOF &gt;&gt;/etc/security/limits.conf
</span><span class="s">elasticsearch soft memlock unlimited   
</span><span class="s">elasticsearch hard memlock unlimited   
</span><span class="s">* soft nofile 65535        
</span><span class="s">* hard nofile 65535
</span><span class="s">EOF</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="18-关闭-swap-缓存">1.8 关闭 swap 缓存</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">swapoff -a <span class="c1">#临时</span>
sed -i <span class="s1">&#39;/swap/s/^/#/&#39;</span> /etc/fstab <span class="c1">#永久</span> 
</code></pre></td></tr></table>
</div>
</div><h2 id="19-设置-es-用户内存限制大小">1.9 设置 es 用户内存限制大小</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sysctl -w vm.max_map_count<span class="o">=</span><span class="m">262144</span>
<span class="nb">echo</span> <span class="s1">&#39;vm.max_map_count=262144&#39;</span> &gt;&gt; /etc/sysctl.conf
</code></pre></td></tr></table>
</div>
</div><h2 id="110-不能-root-用户启动">1.10 不能 root 用户启动</h2>
<h2 id="111-java版本">1.11 java版本</h2>
<blockquote>
<p>es 7.*之后的版本不需要安装环境 java，默认自带 jdk 环境，但是其他的服务还是需要 jdk 环境的，所以还是要统一安装，另外 jdk 版本要为 8 或者 11，我这里默认 8 就好了，直接 yum 安装</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel
</code></pre></td></tr></table>
</div>
</div><h1 id="2-安装-es-集群">2. 安装 es 集群</h1>
<h2 id="21-官网下载">2.1 官网下载</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.2-x86_64.rpm
wget https://artifacts.elastic.co/downloads/kibana/kibana-7.6.2-x86_64.rpm
wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.6.2-x86_64.rpm
wget https://artifacts.elastic.co/downloads/logstash/logstash-7.6.2.rpm
wget https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-7.6.2-x86_64.rpm
</code></pre></td></tr></table>
</div>
</div><h2 id="22-yum-直接安装则可">2.2 yum 直接安装则可</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">yum -y install elasticsearch
yum -y install kibana
yum -y install filebeat
yum -y install auditbeat
</code></pre></td></tr></table>
</div>
</div><h2 id="23-es-配置修改3-台机都要其中-nodename-配置不同其他一样">2.3 es 配置修改，3 台机都要，其中 node.name 配置不同，其他一样</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /etc/elasticsearch/ &amp;&amp; cp elasticsearch.yml elasticsearch.yml.orig

cat &lt;&lt; EOF &gt; elasticsearch.yml
cluster.name: es-cluster
node.name: node01
path.data: /var/lib/elasticsearch
path.logs: /var/log/elasticsearch
bootstrap.memory_lock: true
network.host: 0.0.0.0
http.port: 9200
discovery.seed_hosts: [&#34;192.168.110.245&#34;, &#34;192.168.110.246&#34;, &#34;192.168.110.247&#34;]
cluster.initial_master_nodes: [&#34;node01&#34;]
xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
xpack.security.transport.ssl.verification_mode: certificate
xpack.security.transport.ssl.keystore.path: elastic-certificates.p12
xpack.security.transport.ssl.truststore.path: elastic-certificates.p12
xpack.security.audit.enabled: true
xpack.security.audit.logfile.events.emit_request_body: true
EOF

#node02: sed -i &#39;s#node\.name\:\ node01#node.name: node02#&#39; /etc/elasticsearch/elasticsearch.yml       
#node03: sed -i &#39;s#node\.name\:\ node01#node.name: node03#&#39; /etc/elasticsearch/elasticsearch.yml
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">解释说明：
cluster.name 集群名字，同一个集群中使用相同名字，单机就随意
node.name: es-cluster 节点名字，每台机都不一样
bootstrap.memory_lock: true 将进程地址所在 RAM 空间中，以防止 es 内存被换出，交换对性能，节点稳定性非常不利，应不惜一切代价避免交换。它可能导致垃圾收集持续数分钟而不是毫秒，并且可能导致节点响应缓慢甚至断开与群集的连接。在弹性分布式系统中，让操作系统杀死该节点更为有效。
    1、如果你的机器已经全局进制swap，那么不开启这个配置也无所谓。详情查看 1.8 配置
    2、或者配置了/etc/sysctl.conf 的 vm.swappiness = 1 ，所以也不需要配置 true
    3、如果以上两个你都没做，那你还是乖乖把 true 配置上。我这里都做了，也不影响。
network.host: 0.0.0.0 需要外网 ip 可以这么配置，不然配置内网也行
http.port: 9200 端口号，不配置的话默认9200
discovery.seed_hosts: [&#34;192.168.110.245&#34;, &#34;192.168.110.246&#34;, &#34;192.168.110.247&#34;] 这里可以不指定，不过避免 es 回环查找，直接指定方便
cluster.initial_master_nodes: [&#34;node-1&#34;] 首次启动 es 集群指定 master 机器，之后重启和添加新服务器都无需更改
xpack.security.enabled: true  启用 xpack 安全模块
xpack.security.transport.ssl.enabled: true  TLS 功能，可对通信进行加密
</code></pre></td></tr></table>
</div>
</div><h2 id="24-如果是-yum-安装的方式需要修改es的启动文件">2.4 如果是 yum 安装的方式需要修改es的启动文件</h2>
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/setting-system-settings.html#systemd" target="_blank" rel="noopener noreffer">参考地址</a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">cat /usr/lib/systemd/system/elasticsearch.service
<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">LimitMEMLOCK</span><span class="o">=</span>infinity

修改命令：
sed -i <span class="s1">&#39;/\[Service\]/a\LimitMEMLOCK=infinity&#39;</span> /usr/lib/systemd/system/elasticsearch.service
修改完之后要reload 一下
sudo systemctl daemon-reload
</code></pre></td></tr></table>
</div>
</div><h2 id="25-如果你要设置-es-的内存大小有两个地方">2.5 如果你要设置 es 的内存大小，有两个地方</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">1、jvm.options
cat /etc/elasticsearch/jvm.options 
-Xms512m
-Xmx512m

2、这里不做介绍，以上一种为常用方法，如果你设置的 java PATH 有问题，可以在这里面指定 java 环境。
/etc/sysconfig/elasticsearch 
</code></pre></td></tr></table>
</div>
</div><h2 id="26--在-node01-配置证书我这里设置的空密码直接回车便可">2.6  在 node01 配置证书，我这里设置的空密码，直接回车便可。</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/usr/share/elasticsearch/bin/elasticsearch-certutil ca
/usr/share/elasticsearch/bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 
cp /usr/share/elasticsearch/{elastic-stack-ca.p12,elastic-certificates.p12} /etc/elasticsearch/
chmod 640 /etc/elasticsearch/elastic-certificates.p12 

#scp /etc/elasticsearch/elastic-certificates.p12 root@node02:/etc/elasticsearch/
#scp /etc/elasticsearch/elastic-certificates.p12 root@node03:/etc/elasticsearch/
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">生成CA证书 bin/elasticsearch-certutil ca，将产生新文件 elastic-stack-ca.p12。该 elasticsearch-certutil 命令还会提示你输入密码以保护文件和密钥，请保留该文件的副本并记住其密码。
为集群中的每个节点生成证书和私钥 bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12，将产生新文件 elastic-certificates.p12。系统还会提示你输入密码，你可以输入证书和密钥的密码，也可以按Enter键将密码留空。默认情况下 elasticsearch-certutil 生成没有主机名信息的证书，这意味着你可以将证书用于集群中的每个节点，另外要关闭主机名验证。

注意：如果你在创建证书时输入了密码，那可以通过下面的方法设置。
/usr/share/elasticsearch/bin/elasticsearch-keystore add xpack.security.transport.ssl.keystore.secure_password

/usr/share/elasticsearch/bin/elasticsearch-keystore add xpack.security.transport.ssl.truststore.secure_password
</code></pre></td></tr></table>
</div>
</div><h2 id="27-node01启动-es">2.7 node01启动 es</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">systemctl start elasticsearch
systemctl enable elasticsearch
systemctl status elasticsearch
</code></pre></td></tr></table>
</div>
</div><h2 id="28-node01配置账号密码完成tls通信">2.8 node01，配置账号密码完成tls通信</h2>
<p>命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive
</code></pre></td></tr></table>
</div>
</div><p>结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node01 elasticsearch]# /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive
Initiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user.
You will be prompted to enter passwords as the process progresses.
Please confirm that you would like to continue [y/N]y


Enter password for [elastic]: 
Reenter password for [elastic]: 
Passwords do not match.
Try again.
Enter password for [elastic]: 
Reenter password for [elastic]: 
Enter password for [apm_system]: 
Reenter password for [apm_system]: 
Enter password for [kibana]: 
Reenter password for [kibana]: 
Enter password for [logstash_system]: 
Reenter password for [logstash_system]: 
Enter password for [beats_system]: 
Reenter password for [beats_system]: 
Enter password for [remote_monitoring_user]: 
Reenter password for [remote_monitoring_user]: 
Changed password for user [apm_system]
Changed password for user [kibana]
Changed password for user [logstash_system]
Changed password for user [beats_system]
Changed password for user [remote_monitoring_user]
Changed password for user [elastic]
</code></pre></td></tr></table>
</div>
</div><p>检查：检查 node01是否启动并且密码访问正常</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456
ip              heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name
192.168.110.245           12          90   3    0.07    0.08     0.08 dilm      *      node01
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意的问题：</p>
</blockquote>
<blockquote>
<ol>
<li>证书权限没设置，创建好默认为 600，手动修改为 640</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">启动报错相关：
org.elasticsearch.ElasticsearchSecurityException: failed to load SSL configuration [xpack.security.transport.ssl]
Caused by: org.elasticsearch.ElasticsearchException: failed to initialize SSL TrustManager - not permitted to read truststore file [/etc/elasticsearch/elastic-certificates.p12]
Caused by: java.nio.file.AccessDeniedException: /etc/elasticsearch/elastic-certificates.p12
</code></pre></td></tr></table>
</div>
</div><blockquote>
<ol start="2">
<li>权限查看及修改</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node01 elasticsearch]# ll /etc/elasticsearch/elastic-certificates.p12
-rw------- 1  640 elasticsearch  3451 Apr 16 18:57 elastic-certificates.p12
[root@node01 elasticsearch]# chmod 640 /etc/elasticsearch/elastic-certificates.p12 
</code></pre></td></tr></table>
</div>
</div><h2 id="29-将-node01-的证书-scp-到-02-和-03并启动-02-和-03的-es">2.9 将 node01 的证书 scp 到 02 和 03，并启动 02 和 03的 es</h2>
<blockquote>
<p>这里有三个证书</p>
<blockquote>
<p>elasticsearch.keystore：这里存放的是 elastic和 123456 的账号密码，给 es 集群使用，默认读取
elastic-stack-ca.p12：这个是 ca 初始证书，保存好就行，生成完 cert 之后用处不大
elastic-certificates.p12：这个是 cert 验证证书，es 集群就是通过这个证书完成</p>
</blockquote>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">scp /etc/elasticsearch/{elasticsearch.keystore,elastic-stack-ca.p12,elastic-certificates.p12} root@node02:/etc/elasticsearch/
scp /etc/elasticsearch/{elasticsearch.keystore,elastic-stack-ca.p12,elastic-certificates.p12} root@node03:/etc/elasticsearch/

systemctl start elasticsearch
systemctl enable elasticsearch
systemctl status elasticsearch
</code></pre></td></tr></table>
</div>
</div><h2 id="210-基于-api-的检查集群是否搭建成功">2.10 基于 api 的检查，集群是否搭建成功。</h2>
<blockquote>
<p>#查看集群健康状态</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">curl http://192.168.110.245:9200/_cat/health?v -u elastic:123456
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>#查看集群节点</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以发现 es 集群 ok 了！我们可以发现 node01 的 master 字段值为*，没错，它就是 master 节点了。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/health?v -u elastic:123456
epoch      timestamp cluster    status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent
1591345666 08:27:46  es-cluster green           3         3      2   1    0    0        0             0                  -                100.0%
[root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456
ip              heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name
192.168.110.245           20          91   0    0.00    0.01     0.05 dilm      *      node01
192.168.110.246           21          78  63    0.42    0.14     0.08 dilm      -      node02
192.168.110.247           29          76  13    0.89    0.29     0.13 dilm      -      node03
</code></pre></td></tr></table>
</div>
</div><h1 id="3-安装-es-的-web-ui">3. 安装 es 的 web UI</h1>
<h2 id="30-有哪些-web-ui">3.0 有哪些 web ui</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ElasticHD</td>
<td>我喜欢用这个，因为临时使用可以直接./ElasticHD 启动，方便快捷。 有 sql 转 json 的小工具，很好用</td>
<td><a href="https://github.com/360EntSecGroup-Skylar/ElasticHD/">https://github.com/360EntSecGroup-Skylar/ElasticHD/</a></td>
</tr>
<tr>
<td>elasticsearch-HQ</td>
<td>要安装 python3.6 有 es 默认的接口查询，还有 node 节点的监控数据</td>
<td><a href="https://github.com/ElasticHQ/elasticsearch-HQ/">https://github.com/ElasticHQ/elasticsearch-HQ/</a></td>
</tr>
<tr>
<td>dejavu</td>
<td>支持从 json 和 csv 导入导出数据</td>
<td><a href="https://github.com/appbaseio/dejavu/">https://github.com/appbaseio/dejavu/</a></td>
</tr>
<tr>
<td>cerebro</td>
<td></td>
<td><a href="https://github.com/lmenezes/cerebro">https://github.com/lmenezes/cerebro</a></td>
</tr>
<tr>
<td>elasticsearch-head</td>
<td></td>
<td><a href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a></td>
</tr>
<tr>
<td>elasticsearch-browser</td>
<td>不支持 5.0 之后</td>
<td><a href="https://github.com/OlegKunitsyn/elasticsearch-browser">https://github.com/OlegKunitsyn/elasticsearch-browser</a></td>
</tr>
<tr>
<td>elasticsearch-kopf</td>
<td>支持 2.0之前</td>
<td><a href="https://github.com/lmenezes/elasticsearch-kopf">https://github.com/lmenezes/elasticsearch-kopf</a></td>
</tr>
</tbody>
</table>
<h2 id="31-如果带账号密码访问的话-url">3.1 如果带账号密码访问的话 url</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">http://elastic:123456@192.168.110.245:9200
</code></pre></td></tr></table>
</div>
</div><h2 id="32-安装web-ui管理工具elastichd">3.2 安装web UI管理工具ElasticHD:</h2>
<blockquote>
<p>普通安装：</p>
</blockquote>
<p>（1）安装supervisord</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum -y install supervisor
echo_supervisord_conf &gt; supervisord.conf
systemctl start supervisord
systemctl enable supervisord
</code></pre></td></tr></table>
</div>
</div><p>（2）安装 elasticHD</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum -y install xdg-utils
cd /usr/local/src/
wget https://github.com/360EntSecGroup-Skylar/ElasticHD/releases/download/1.4/elasticHD_linux_amd64.zip
unzip elasticHD_linux_amd64.zip 
chmod 0777 ElasticHD
mv ElasticHD /usr/local/bin/
cat &lt;&lt;EOF&gt; /etc/supervisord.d/ElasticHD.ini
[program:ElasticHD]
command=/usr/local/bin/ElasticHD -p 0.0.0.0:9800
autostart=true
autorestart=true
user=elasticsearch
redirect_stderr=true
stdout_logfile=/tmp/ElasticHD.log
EOF

supervisorctl update
supervisorctl reload
supervisorctl status
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>docker 安装：</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">docker run -p 9800:9800 -d --link elasticsearch:demo containerize/elastichd
</code></pre></td></tr></table>
</div>
</div><p>web端访问结果：http://192.168.110.245:9800/</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_01.png" width="800" hegiht="250" align=center /></p>
<h2 id="33-安装-elasticsearch--hq">3.3 安装 elasticsearch -HQ</h2>
<blockquote>
<p>普通安装：</p>
</blockquote>
<p>(1)安装python3.6</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum install python3 python3-pip python3-devel -y
</code></pre></td></tr></table>
</div>
</div><p>(2) 安装 elasticsearch-HQ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /usr/local/src/
wget -O elasticsearch-HQ.zip  https://github.com/ElasticHQ/elasticsearch-HQ/archive/master.zip
unzip elasticsearch-HQ.zip 
mv elasticsearch-HQ-master /usr/local/elasticsearch-HQ
cd /usr/local/elasticsearch-HQ
pip3 install -r requirements.txt
cat &lt;&lt;EOF&gt; /etc/supervisord.d/ElasticHQ.ini
[program:ElasticHQ]
command=/usr/bin/python3 /usr/local/elasticsearch-HQ/application.py --host 0.0.0.0 --port 5000
autostart=true
autorestart=true
#user=elasticsearch
redirect_stderr=true
stdout_logfile=/tmp/ElasticHQ.log
EOF

supervisorctl update
supervisorctl reload
supervisorctl status
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>docker 安装</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">docker run -p 5000:5000 elastichq/elasticsearch-hq
</code></pre></td></tr></table>
</div>
</div><p>web端访问结果：http://192.168.110.245:5000/</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_02.png" width="800" hegiht="250" align=center /></p>
<h1 id="4-安装-kibana">4. 安装 Kibana</h1>
<h2 id="41-引用">4.1 引用：</h2>
<blockquote>
<p>Kibana是一个针对Elasticsearch的开源分析及可视化平台，用来搜索、查看交互存储在Elasticsearch索引中的数据。使用Kibana，可以通过各种图表进行高级数据分析及展示。</p>
</blockquote>
<blockquote>
<p>Kibana让海量数据更容易理解。它操作简单，基于浏览器的用户界面可以快速创建仪表板（dashboard）实时显示Elasticsearch查询动态。</p>
</blockquote>
<h2 id="42-安装">4.2 安装：</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum -y install kibana-7.6.2-x86_64.rpm 

#创建日志路径
mkdir /var/log/kibana
touch /var/log/kibana/kibana.log
chmod -R 755 /var/log/kibana/
chown -R kibana /var/log/kibana/
</code></pre></td></tr></table>
</div>
</div><h2 id="43-修改配置文件">4.3 修改配置文件</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node01 elk]# cat /etc/kibana/kibana.yml |grep -Ev &#39;^#|^$&#39;
#kibana 端口号
server.port: 5601
#kibana 内网 ip
server.host: &#34;192.168.110.245&#34;
#es 的地址
elasticsearch.hosts: [&#34;http://192.168.110.245:9200&#34;]
#es 的账号密码，在配置 tls 通信的时候那里就设置了的
elasticsearch.username: &#34;kibana&#34;  
elasticsearch.password: &#34;123456&#34;
#记录发送到 es 的查询
elasticsearch.logQueries: true
# 日志路径
logging.dest: /var/log/kibana/kibana.log
# 禁止显示除错误消息以外的所有日志记录输出。
logging.quiet: true
# 记录所有日志事件，包括系统使用情况信息和所有请求
logging.verbose: false
# 开启 xpack
xpack.security.enabled: true
</code></pre></td></tr></table>
</div>
</div><h2 id="44-启动">4.4 启动</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">systemctl restart kibana
systemctl status kibana
</code></pre></td></tr></table>
</div>
</div><h2 id="45-open-kibana-url">4.5 open kibana url</h2>
<p>http://192.168.110.245:5601/ ，这里要用 elastic 账号登录，使用 kibana 登录是无法，会报错 403 没权限</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_03.png" width="800" hegiht="250" align=center /></p>
<h2 id="46-内存限制">4.6 内存限制</h2>
<p>参考资料：<a href="https://www.elastic.co/guide/en/kibana/7.2/production.html#load-balancing-es">https://www.elastic.co/guide/en/kibana/7.2/production.html#load-balancing-es</a></p>
<p>默认内存限制 1.4GB，如果过需要可以通过环境变量进行替换，一般不需要更改。</p>
<h1 id="5-node02-安装-logstash">5. node02 安装 logstash</h1>
<h2 id="51-安装-logstash">5.1 安装 logstash</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum -y install logstash-7.6.2.rpm
cp /etc/logstash/logstash.yml /etc/logstash/logstash.yml.orig
</code></pre></td></tr></table>
</div>
</div><h2 id="52-配置文件">5.2 配置文件</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node02 elk]# cat /etc/logstash/logstash.yml|grep -Ev &#39;#|^$&#39;
path.data: /var/lib/logstash
# 配置自动加载配置，这样就无须在更改配置时手动重启 logstash 引起数据丢失
config.reload.automatic: true
# 自动加载的时间
config.reload.interval: 10s
path.logs: /var/log/logstash
</code></pre></td></tr></table>
</div>
</div><h2 id="53-修改内存地址">5.3 修改内存地址</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">vim /etc/logstash/jvm.options
-Xms1g
-Xmx1g
</code></pre></td></tr></table>
</div>
</div><h2 id="54-手动测试输入-hello">5.4 手动测试，输入 hello</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /usr/share/logstash
./bin/logstash -e &#39;input { stdin { } } output { stdout { } }&#39;
hello
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_04.png" width="800" hegiht="250" align=center /></p>
<h1 id="6-node0203安装-filebeat">6. node02、03安装 filebeat</h1>
<h2 id="61-安装">6.1 安装</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">yum -y install filebeat-7.6.2-x86_64.rpm 
cd /etc/filebeat
cp filebeat.yml filebeat.yml.orig
</code></pre></td></tr></table>
</div>
</div><h1 id="7-日志处理">7. 日志处理</h1>
<h2 id="案例一官方例子">案例一：官方例子</h2>
<h2 id="参考">参考：</h2>
<p><a href="https://www.elastic.co/guide/en/logstash/7.7/plugins-inputs-beats.html">https://www.elastic.co/guide/en/logstash/7.7/plugins-inputs-beats.html</a>
<a href="https://www.elastic.co/guide/en/logstash/current/advanced-pipeline.html">https://www.elastic.co/guide/en/logstash/current/advanced-pipeline.html</a></p>
<h2 id="711在-node02-调整-logstash-配置">7.1.1在 node02 调整 logstash 配置</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /etc/logstash/conf.d/
cat &lt;&lt;EOF&gt; /etc/logstash/conf.d/example.conf 
input {
  beats {
    port =&gt; 5044
  }
}

output {
  elasticsearch {
    hosts =&gt; [&#34;http://192.168.110.245:9200&#34;]
    index =&gt; &#34;%{[@metadata][beat]}-%{[@metadata][version]}&#34; 
    user =&gt; &#34;elastic&#34;
    password =&gt; &#34;123456&#34;
  }
}
EOF
systemctl restart logstash
</code></pre></td></tr></table>
</div>
</div><h2 id="712检查端口是否启动">7.1.2检查端口是否启动：</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[root@node02 elk]# netstat -nltp|grep 5044
tcp6       0      0 :::5044                 :::*                    LISTEN      31422/java   
</code></pre></td></tr></table>
</div>
</div><h2 id="713-在-node02-配置-filebeat">7.1.3 在 node02 配置 filebeat</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /root/src/elk
wget https://download.elastic.co/demos/logstash/gettingstarted/logstash-tutorial.log.gz
gzip -d logstash-tutorial.log.gz 
cat &lt;&lt;EOF&gt; filebeat.yml
filebeat.inputs:
- type: log
  paths:
    - /root/src/elk/logstash-tutorial.log 
output.logstash:
  hosts: [&#34;192.168.110.246:5044&#34;]
EOF
</code></pre></td></tr></table>
</div>
</div><h2 id="714-启动-filebeat">7.1.4 启动 filebeat</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/usr/share/filebeat/bin/filebeat -e -c filebeat.yml  -d &#34;publish&#34;
</code></pre></td></tr></table>
</div>
</div><p>启动结果部分截图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_05.png" width="800" hegiht="250" align=center /></p>
<h2 id="715-在-kibana-打开management-elasticsearch-indexmanagement可以看到-filebeat-的索引">7.1.5 在 kibana 打开“Management”-&raquo;“Elasticsearch”-&raquo;“IndexManagement”，可以看到 filebeat 的索引</h2>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk_06.png" width="800" hegiht="250" align=center /></p>
<p>然后我们到 kiabana 那里添加 index 试试。</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk10.png" width="800" hegiht="250" align=center /></p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk07.png" width="800" hegiht="250" align=center /></p>
<p>创建成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk08.png" width="800" hegiht="250" align=center /></p>
<p>最后我们到 Discover 这里就可以看到相关试图了</p>
<p><img src="https://cdn.jsdelivr.net/gh/ZhaoUncle/images/blog/elk09.png" width="800" hegiht="250" align=center /></p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020-08-24&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/bd45a427afa4bfbbbd23b3c27d6664fa7071c6d6" target="_blank" title="commit by Aomine(123zhaoweiping@gmail.com) bd45a427afa4bfbbbd23b3c27d6664fa7071c6d6: rm images">
                                    <i class="fas fa-hashtag fa-fw"></i>bd45a42</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/elk_01/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/elk/">elk</a>,&nbsp;<a href="/tags/elasticsearch/">elasticsearch</a>,&nbsp;<a href="/tags/kibana/">kibana</a>,&nbsp;<a href="/tags/logstash/">logstash</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/hugo/" class="prev" rel="prev" title="Hugo（一）Github Pages 搭建个人博客"><i class="fas fa-angle-left fa-fw"></i>Hugo（一）Github Pages 搭建个人博客</a>
            <a href="/20200626/" class="next" rel="next" title="于 2020 年 6 月 26 日">于 2020 年 6 月 26 日<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.67.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="http://zhaouncle.github.io" target="_blank">赵叔</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"qC7mcE4DIvgzHTOc5YaLNdUp-MdYXbMMI","appKey":"aBX50Ypl9zqu3sGf0PNLlPaW","avatar":"robohash","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"博主很懒，什么都没有留下！","recordIP":true,"visitor":true}},"search":{"algoliaAppID":"8GC6CRN3M8","algoliaIndex":"index.zh-cn","algoliaSearchKey":"d4467e8c57c2b12f53da9c8ec1c629be","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-168242983-1');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-168242983-1" async></script></body>
</html>
