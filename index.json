[{"categories":["git"],"content":"问题： ‘public’ already exists in the index 场景：github repo 添加 submodule 子模块，使用命令 git submodule add git@github.com:test.git public 报错 尝试解决：rm -rf public 删除目录在执行也不生效 最终解决办法： git rm -r --cached public git submodule add git@github.com:test.git public ","date":"2022-01-17","objectID":"/%E5%AD%90%E6%A8%A1%E5%9D%97%E7%B4%A2%E5%BC%95%E5%B7%B2%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/:0:0","series":null,"tags":["git"],"title":"子模块索引已存在问题处理","uri":"/%E5%AD%90%E6%A8%A1%E5%9D%97%E7%B4%A2%E5%BC%95%E5%B7%B2%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/#"},{"categories":["unraid","dns","ddns"],"content":"一、DNS 简约 有需要可以看一下参考文章： 阮一峰 的 DNS 原理入门 CloudFlare DNS 基础知识 Google DNS 基础知识 DNS功能介绍 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#一dns-简约"},{"categories":["unraid","dns","ddns"],"content":"1. 什么是 DNS 答： DNS（Domain Name System） 是域名系统，简单理解为根据域名找出ip地址，可以在网上通过域名来转化为你的ipv4或者ipv6地址，找到你的访问地址，而不是记住冗长的ip地址，当然，有些域名耶不好记忆，这个很正常，不抬杠。 常见的资源记录有：SOA（起始授权结构）、A（主机）、NS（名称服务器）、CNAME（别名）和MX（邮件交换器），其中A记录用于映射ipv4或ipv6地址，CNAME记录映射为CDN地址或者其他域名（不能用ip，不过AWS的好像可以用ip表达，其他dns厂商没见过），这两种使用方式是最为常见的。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-什么是-dns"},{"categories":["unraid","dns","ddns"],"content":"2. 什么是DNS NS记录和域名服务器 答： NS 代表域名服务器，可以简单理解为你要把你的域名放在那里做解析，如果我要把freenom购买的域名放到阿里云做DNS解析，NS就要修改为阿里云的dns ns 域名服务器，否则无法在阿里云上面做 A 解析记录，映射到你的公网ip上； 域名服务器一般是2个以上进行负载均衡，避免一个挂了，导致网站解析异常； 每个dns解析厂商，都有自己的NS服务器，不要混用； 有些dns服务商不支持解析为内网地址； ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-什么是dns-ns记录和域名服务器"},{"categories":["unraid","dns","ddns"],"content":"3. 何时应更新或更改 NS 记录？ 答： 当你的ip或者cname改变时，就需要修改dns的A记录或者CNMAE记录； NS更新记录一般需要等待几分钟，最长24小时，才能在全网进行更新； 如果更新没成功，建议你先刷新dns、关闭网络在重连（比如拔掉网线，不会弄又急的话就重启电脑咯）、浏览器用无痕模式等去验证解析是否成功； 可以使用站长工具在线测试dns解析结果：https://tool.chinaz.com/dns/?type=1\u0026host=\u0026ip= ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-何时应更新或更改-ns-记录"},{"categories":["unraid","dns","ddns"],"content":"4. 什么是 DDNS ？ 答： DDNS（Dynamic Domain Name Serve） 是指动态域名服务，比如，我们家用宽带的ip是动态的，随着每一次的路由重启，断线重连，或者移动商的定期重连，都会导致你的家用公网ip变化（当然你也可能没有，也可能只有ipv6），甚至是服务器没购买绑定公网ip，停机重启后导致公网ip变化，我们需要把动态ip映射到一个固定的域名解析服务器上（阿里云、dnspod）等，然后由服务器提供DNS服务实现动态域名解析。也就是说DDNS捕获的是用户每次变化的IP，然后与其域名相对应，我们需要记住的只是域名就好，而无需管他后面的ip是啥。 参考：DDNS是什么？DDNS的工作原理是怎样的? ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:4:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#4-什么是-ddns-"},{"categories":["unraid","dns","ddns"],"content":"二、Freenom 域名 ⚠️⚠️⚠️freenom的免费域名千万千万🙅🏻‍♀️不要🙅🏻‍♀️用于生产环境，否则等你流量起来之后，freenom会被莫名其妙的把你网站给封了，然后卖给别人，就等着哭吧。不过只是用于家庭环境使用，也无所谓了，不要就换一个的心态，那就无所谓。要不然还不如去买一下xyz这种便宜的顶级域名，一年6块钱的，就一瓶大可乐的零花钱就够了。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#二freenom-域名"},{"categories":["unraid","dns","ddns"],"content":"1. 申请 freenom 免费域名 1.0 Freenom是世界上第一个也是唯一的免费域名提供商。 1.1 由于该网站没有国内解析，所以比较卡访问慢，没条件的同学可以上阿里云或者腾讯云买一台香港最低配置的临时 ubuntu desktop 或者 windows desktop 云主机，按量付费，基本上15 分钟内都能搞定，花不了两块钱然后可以开始进行注册了。 1.2 点击 👉🏻 注册地址 👈🏻 即可跳转登录 1.3 免费域名只支持**.tk**、.ml、.ga、.cf、.gq，另外，最多支持 12 个月的免费续订，到期要后续期，否则会被回收。 1.4 开始进行注册 “Register a New Domain”，输入自己想要的域名，然后点击 Check Availability 1.5 如果显示以下信息“Yes,domain is available!\"，则表示该域名可以注册，然后选择”Select“，点击 checkout 进行跳转即可 1.6 需要手动选择 Period 时间为12个月，默认是 3 Months 1.7 最左边”Enter Your Email Address“的位置可以直接填写邮箱，然后点击”Verify My Email Address“，会发送一封验证邮件到你的邮箱，然后去邮箱打开 freenom 发过来的验证邮件，点击里面的邮件地址进行跳转即可，当然你也可以在最右边登录第三方 gmail 账号进行注册，原理都一样 1.8 我用的是 gmail 第三方登录的方式，点击👆🏻最右边的“登录”，如下 1.9 然后填写注意的信息，一个是 address1 指的ip，可以不填，默认会获取ip自动写入，一个是** city** 要和ip对应的地区一致，这两个要分别对应，我选取ipinfo.io的地址里面获取到的city：”Hong Kong“，然后填进去 1.10 如果出现以下报错，就要考虑ip和city是否填写正确了，改完之后多重新尝试几次 1.11 免费域名的注册到这里就结束了，因为免费域名是最多时长为 12 个月，默认是 3 个月（要记得自己修改哦），到期前 15 天我们要自动续期，否则就会被取消域名所有权，会被 freenom 回收，另外续期是免费的，不会像奸商一样续期要加钱。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-申请-freenom-免费域名"},{"categories":["unraid","dns","ddns"],"content":"2. 如何更改 freenom 的 NameServers 注册成功后，我们去检查我们选择的域名，选择“Manage Domain”然后修改 NS 服务器地址，可以指向 aws 的 router53，阿里云的 ddns，腾讯云的 dnspod，cloudfare 免费 cdn dns 解析商== ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-如何更改-freenom-的-nameservers"},{"categories":["unraid","dns","ddns"],"content":"3. 如何手动续订域名 选择“Renew Domains”，然后进入域名类别，点击最右侧的 “Renew This Domain” ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-如何手动续订域名"},{"categories":["unraid","dns","ddns"],"content":"4. 如果上面的city地址填错，可以手动更改 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:4:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#4-如果上面的city地址填错可以手动更改"},{"categories":["unraid","dns","ddns"],"content":"5. 如何修改freenom 密码 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:5:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#5-如何修改freenom-密码"},{"categories":["unraid","dns","ddns"],"content":"6. 忘记密码如何重置？ 📢：特别是使用gmail邮箱登录的，都不会有初始密码，需要使用重置功能，直接发送邮件到你的gmail📮进行重置方可。另外要注意的一个点就是，gmail只是第三方登录，freenom和gmail的密码是不通用的，两个不同的系统，互相改密码都不影响对方。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:6:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#6-忘记密码如何重置"},{"categories":["unraid","dns","ddns"],"content":"7. 如何删除不用的域名 你也可以等到过期自动回收。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:7:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#7-如何删除不用的域名"},{"categories":["unraid","dns","ddns"],"content":"8. 一些官方 Questions 地址：http://www.freenom.com/zh/support.html ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:8:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#8-一些官方-questions"},{"categories":["unraid","dns","ddns"],"content":"三、unraid 如何自动续期 freenom？ 以下两个docker镜像，推荐使用 luolongfei/freenom ，只拿他做个例子，另一个作为备用。 luolongfei/freenom rouroux/freenom-automatic-renewal unraid 配置freenom-ddns Name: freenom-ddns Overview: https://github.com/luolongfei/freenom Repository: luolongfei/freenom Docker Hub URL: https://hub.docker.com/r/luolongfei/freenom Icon URL: https://my.freenom.com/templates/freenom/img/logo.png PATH1: /mnt/user/appdata/freenom/conf ###配置文件要导入本地,升级镜像才丢失数据 Container Path: /conf PATH2: /mnt/user/appdata/freenom/logs ### 日志，可以不用设置 Container Path: /app/logs RUN_AT: 0 1 * * 6 ### 何时执行更新，可以不用设置，我只是举个例子 Container Variable: RUN_AT FREENOM_USERNAME: freenom登录邮箱 ### freenom的登录邮箱 Container Variable: FREENOM_USERNAME FREENOM_PASSWORD: freenom密码 ### 如果是第三方登录账号，比如gmail，一定要去把密码改了，不是gmail的密码，双方账号密码不通用 Container Variable: FREENOM_PASSWORD MAIL_ENABLE: 0 ### 关闭邮件通知，如果没设置邮箱登录的开启会报错，特别烦 Container Variable: MAIL_ENABLE 3. 配置文件 📢：推荐使用 Filebrowser 这个 docker 容器去挂载unraid 的 /mnt/user，这样就可以在线直接修改配置文件了，而不需要去命令行里面修改，很方便 查看默认配置.env.example，除了一开始的freenom账号密码设置为变量外，你也可以去掉，然后在配置文件里面进行更改, 他的通知方式除了看日志，还支持邮件、Telegram Bot、企业微信、Server 酱 微信通知、Bark 送信 ios app端，可惜不支持钉钉。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#三unraid-如何自动续期-freenom"},{"categories":["unraid","dns","ddns"],"content":"四、ddns 服务列表推荐 👂🏻推荐使用：80x86/ddns-updater、newfuture/ddns、jeessy/ddns-go、sanjusss/aliyun-ddns 👂🏻域名购买商：NameSilo 推荐 功能 qmcgaw/ddns-updater 80x86/ddns-updater newfuture/ddns jeessy/ddns-go sanjusss/aliyun-ddns maxisoft/freenom-dns-updater crazymax/ddns-route53 支持多域名 ✅ ✅ ✅ ✅ ✅ ✅ ✅ 支持不同dns解析平台同时登录 ✅ ✅ 更新方式 只能修改，不能新增 可新增 可新增 可新增 可新增 ipv4 ✅ ✅ ✅ ✅ ✅ ✅ ✅ ipv6 ✅ ✅ ✅ ✅ ✅ ✅ ✅ dnspod ✅ ✅ ✅ ✅ dnspod 国际 ✅ ✅ ✅ ✅ 阿里云 dns ✅ ✅ ✅ ✅ ✅ cloudflare ✅ ✅ ✅ ✅ AWS router53 ✅ Freenom ✅ 华为云 ✅ ✅ dns.com ✅ HE.net ✅ ✅ DD24 ✅ DDNSS.de ✅ DigitalOcean ✅ DonDominio ✅ DremHost ✅ ✅ DuckDNS ✅ ✅ DynDNS ✅ FreeDNS ✅ Gandi ✅ GoDaddy ✅ ✅ Google ✅ Infomaniak ✅ Linode ✅ LuaDNS ✅ Namecheap ✅ ✅ NoIP ✅ ✅ Njalla ✅ OpenDNS ✅ OVH ✅ Porkbun ✅ Selfhost.de ✅ Servercow.de ✅ Spdyn ✅ Strato.de ✅ Variomedia.de ✅ ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#四ddns-服务列表推荐"},{"categories":["unraid","dns","ddns"],"content":"0. 公网ip获取渠道有哪些？ ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#0-公网ip获取渠道有哪些"},{"categories":["unraid","dns","ddns"],"content":"1. http 测试： ipv4 ipv6 https://ipv4.lookup.test-ipv6.com/ip/ https://v6.ident.me/ https://myip.ipip.net/ https://test-ipv6.com/ http://ip-api.com/json/?fields=query http://ds.test-ipv6.com/ https://ip.3322.net http://checkipv6.dyndns.com/ https://www.nsupdate.info/myip https://api-ipv6.ip.sb/ip https://ident.me/ http://v6.ident.me/ https://v4.ident.me/ https://api6.ipify.org/ https://icanhazip.com/ https://ipv6.lookup.test-ipv6.com/ip/ http://whatismyip.akamai.com/ https://myip.dnsomatic.com/ http://ip.cip.cc/ http://members.3322.org/dyndns/getip https://www.pubyun.com/dyndns/getip https://myip.dnsomatic.com/ http://checkip.dyndns.com/ ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-http-测试"},{"categories":["unraid","dns","ddns"],"content":"2. 命令行测试 ### ipv4 host -4 myip.opendns.com resolver1.opendns.com dig -4 +short myip.opendns.com @resolver1.opendns.com ### ipv6 host -6 myip.opendns.com resolver1.opendns.com dig -6 +short myip.opendns.com @resolver1.opendns.com ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:2","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-命令行测试"},{"categories":["unraid","dns","ddns"],"content":"1. unraid安装ddns-go用于动态域名解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-unraid安装ddns-go用于动态域名解析"},{"categories":["unraid","dns","ddns"],"content":"1.1 安装 ddns-go 步骤就不讲了，直接上图 Name: ddns-go Overview: https://github.com/jeessy2/ddns-go Repository: jeessy/ddns-go Docker Hub URL: https://registry.hub.docker.com/r/jeessy/ddns-go Icon URL: https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/DDNSIcon.png WebUI: http://[IP]:[PORT:9876] Port: 9876 Path: /mnt/user/appdata/ddns-go ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#11-安装-ddns-go-步骤就不讲了直接上图"},{"categories":["unraid","dns","ddns"],"content":"1.2 ddns-go配置简介 因为ddns-go不支持多dns解析商的配置，所以你只能配置以下一个，比如我配置了cloudflare，就不能再配置阿里云了，不过家用环境下，其实一个也够用了，要不然你也可以选择开多个ddns-go的docker，配置不同的运营商 一般通过接口获取就足够使用了，不过要是有同学走了代理网络，这里就会有问题，要注意支持哟！另外支持配置多个不同的域名，以下举个例子，只支持自动解析到 A记录（主机） test.com ddns-go.test.com fucker.com dns.fucker.com 我这里直接禁止公网访问web，打了个勾，然后还设置了账号密码登录访问，已经成为使用习惯了，你自己的话就看着办吧 Webhook，看文档说支持Server酱（强烈推荐），可以使用微信收到回调信息，不管更新成功还是不成功的结果。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:2","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#12-ddns-go配置简介"},{"categories":["unraid","dns","ddns"],"content":"2. unraid 安装 qmcgaw/ddns-updater 用于动态域名解析 ⚠️⚠️⚠️一开始不管是不是代理环境，获取 ip 都不准，因为使用的都是国外的获取工具，现在我都改成国内了，就可以使用了，真的挺不错，不过可以直接用荒野无灯大佬提供的带web编辑的也很香。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-unraid-安装-qmcgawddns-updater-用于动态域名解析"},{"categories":["unraid","dns","ddns"],"content":"1. 安装 qmcgaw/ddns-updater Name: ddns-updater-qmcgaw Overview: https://github.com/qdm12/ddns-updater Repository: qmcgaw/ddns-updater Docker Hub URL: https://registry.hub.docker.com/r/qmcgaw/ddns-updater Icon URL: https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/DDNSIcon.png WebUI: http://[IP]:[PORT:8000] Path: /mnt/user/appdata/ddns-updater-qmcgaw ###保存配置文件，更新镜像也不影响数据 Container Path: /updater/data Port: 28080 Container Port: 8000 PUBLICIP_FETCHERS: http ### 改成http获取方式，不用dns Container Variable: PUBLICIP_FETCHERS PUBLICIP_HTTP_PROVIDERS: https://myip.ipip.net,https://ip.3322.net ### 改成国内的ipv4获取地址即可 Container Variable: PUBLICIP_HTTP_PROVIDERS PUBLICIPV4_HTTP_PROVIDERS: https://myip.ipip.net,https://ip.3322.net ### 改成国内的ipv4获取地址即可 Container Variable: PUBLICIPV4_HTTP_PROVIDERS ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-安装-qmcgawddns-updater"},{"categories":["unraid","dns","ddns"],"content":"2. qmcgaw/ddns-updater 的配置文件 { \"settings\": [ { \"provider\": \"aliyun\", ### 阿里云 dns 解析 \"domain\": \"test.ml\", ### 解析的域名 \"host\": \"@,ddns-go,www,blog\", ### 二级域名前缀 \"access_key_id\": \"\", ### 阿里云的ck id \"access_secret\": \"\", ### 阿里云的ck secret \"ip_version\": \"ipv4\" ### 获取 ipv4 地址 }, { \"provider\": \"cloudflare\", ### cloudflare dns 解析 \"domain\": \"test.com\", ### 解析的域名 \"host\": \"ddns-go,www,blog\", ### 二级域名前缀 \"ttl\": 600, ### cf 上面的 ttl 值，单位秒 \"zone_identifier\": \" 每个域名点击进去的 zone id\", \"token\": \"\", ### cf 的 token \"ip_version\": \"ipv4\" ### 获取 ipv4 地址 }, { \"provider\": \"dnspod\", ### dnspod dns 解析 \"domain\": \"test.com\", ### 解析的域名 \"host\": \"ddns-go,www,blog\", ### 二级域名前缀 \"token\": \"id,token\", ### 这里要用dnspod 的“ID,Token”，用逗号分隔开填写进去 \"ip_version\": \"ipv4\" ### 获取 ipv4 地址 }, { \"provider\": \"dnspod\", ### dnspod dns 解析 \"domain\": \"test.ml\", ### 解析的域名 \"host\": \"ddns-go,www,blog\", ### 二级域名前缀 \"token\": \"id,token\", ### 这里要用dnspod 的“ID,Token”，用逗号分隔开填写进去 \"ip_version\": \"ipv4\" ### 获取 ipv4 地址 }, ] } ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:2","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-qmcgawddns-updater-的配置文件"},{"categories":["unraid","dns","ddns"],"content":"3. 如何知道这些配置怎么来的呢？ 答： 打开对应的md文件，github 地址有提供配置案例：https://github.com/qdm12/ddns-updater/tree/master/docs ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:3","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-如何知道这些配置怎么来的呢"},{"categories":["unraid","dns","ddns"],"content":"4. 注意要点： 不能添加，只能更新，就是必须要dns解析厂商那里先手动配置一次A记录，才能使用，否则会有以下报错 dnspod 要把\"id,token\"一起填写进去到token配置里面。 如果遇到更新不及时，需要手动吧update.json删掉。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:4","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#4-注意要点"},{"categories":["unraid","dns","ddns"],"content":"3. unraid 安装 newfuture/ddns 用于动态域名解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:4:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-unraid-安装-newfutureddns-用于动态域名解析"},{"categories":["unraid","dns","ddns"],"content":"1. 安装 newfuture/ddns 1.1 先配置 config.json，等会需要挂载到 docker 镜像，我这里用 Filebrowser 管理 { \"$schema\": \"https://ddns.newfuture.cc/schema/v2.8.json\", \"debug\": false, \"dns\": \"dnspod\", \"id\": \"YOUR ID or EMAIL for DNS Provider\", \"index4\": \"default\", \"index6\": \"default\", \"ipv4\": [ \"newfuture.cc\", \"ddns.newfuture.cc\" ], \"ipv6\": [ \"newfuture.cc\", \"ipv6.ddns.newfuture.cc\" ], \"proxy\": null, \"token\": \"YOUR TOKEN or KEY for DNS Provider\", \"ttl\": null } 1.2 unraid 配置 Name: ddns-newfuture Overview: https://github.com/NewFuture/DDNS Repository: newfuture/ddns Docker Hub URL: https://registry.hub.docker.com/r/newfuture/ddns Icon URL: https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/DDNSIcon.png Path: /mnt/user/appdata/ddns-newfuture/config.json # 我先手动创建了config.json，要不然会变成挂载目录，导致出问题 Container Path: /config.json 1.3 根据你自身的网络环境，修改相应配置，ipv4 我直接用的公网解析 “public”，因为我是 unraid，不是在路由器上面，如果是路由器比如 openwrt 直接安装 docker 可以指定网卡。 官网配置参考：https://github.com/NewFuture/DDNS ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:4:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-安装-newfutureddns"},{"categories":["unraid","dns","ddns"],"content":"4. unraid 安装 sanjusss/aliyun-ddns 用于动态域名解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:5:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#4-unraid-安装-sanjusssaliyun-ddns-用于动态域名解析"},{"categories":["unraid","dns","ddns"],"content":"1. 安装 sanjusss/aliyun-ddns Name: ddns-aliyun Overview: https://github.com/sanjusss/aliyun-ddns Repository: sanjusss/aliyun-ddns Docker Hub URL: https://registry.hub.docker.com/r/sanjusss/aliyun-ddns Icon URL: https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/DDNSIcon.png 阿里云的 AccessKey ID: 你自己的阿里云AccessKey ID Container Variable: AKID 阿里云的 AccessKey Secret: 你自己的 AccessKey Secret Container Variable: AKSCT 域名: unraid.test.top,www.test.top,test.top,ddns-go.test2.com ### 支持多域名 Container Variable: DOMAIN 更新间隔: 300 ### 5分钟自动更新一次ip上传 Container Variable: REDO 是否检查本地网卡IP: false ### 如果是路由器，可以使用检查本地网卡ip Container Variable: CHECKLOCAL 检查IPv4地址时，仅使用中国服务器: true ### 国内，不管走不走代理，都用 Container Variable: CNIPV4 需要更改的记录类型: A ### 只支持A或者AAAA记录 Container Variable: TYPE 服务器缓存解析记录的时长: 600 Container Variable: TTL 变量推荐 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:5:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-安装-sanjusssaliyun-ddns"},{"categories":["unraid","dns","ddns"],"content":"5. unraid 安装 80x86/ddns-updater 用于动态域名解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:6:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#5-unraid-安装-80x86ddns-updater-用于动态域名解析"},{"categories":["unraid","dns","ddns"],"content":"1. 安装80x86/ddns-updater Name: ddns-updater Overview: 使用荒野无灯大神的ddns-updater镜像，具体使用教程可访问https://hub.docker.com/r/80x86/ddns-updater查看 Repository: 80x86/ddns-updater:amd64 Docker Hub URL: https://hub.docker.com/r/80x86/ddns-updater Icon URL: https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/DDNSIcon.png WebUI: http://[IP]:[PORT:8020] Extra Parameters: --mount type=tmpfs,destination=/tmp Host Path 1: /mnt/user/appdata/ddns-updater ###将数据挂载到unraid本地，避免更新镜像丢失数据 Container Path: /app/data Key 1: 8020 ### 内部服务启动时的端口，要和上面的 WebUI 端口匹配 Container Variable: LISTENINGPORT Key 2: admin ### web 页面登录账号 Container Variable: HTTP_USERNAME Key 3: admin ### web 页面登录密码 Container Variable: HTTP_PASSWORD Key 4: 114.114.114.114:53,8.8.8.8:53,208.67.222.222:443 ### Container Variable: GO_DNS_SERVERS Key 5: Container Variable: SERVERCHAN_KEY ### server酱 微信接受通知 进入web页面进行编辑 将配置进行整理复制进去就好了，这个配置一个settings只支持一个域名和一个host，多个就得复制多份进行配置 配置举例：https://hub.docker.com/r/80x86/ddns-updater # use [[settings]] to start a new domain config # setup for example.com, DNS only [[settings]] provider = \"cloudflare\" domain = \"example.com\" host = \"@\" proxied = false ip_method = \"dnspod\" delay = 300 token = \"YOUR-CF-API-TOKEN-HERE\" # setup for foo.example.com, Proxied [[settings]] provider = \"cloudflare\" domain = \"example.com\" host = \"foo\" proxied = true # for proxied record, remember to set no_dns_lookup = true no_dns_lookup = true ip_method = \"dnspod\" delay = 300 token = \"YOUR-CF-API-TOKEN-HERE\" # setup for example.com [[settings]] provider = \"alidns\" domain = \"example.com\" host = \"@\" ip_method = \"dnspod\" delay = 300 key = \"AccessKey ID\" secret = \"AccessKey Secret\" # setup for foo.example.com [[settings]] provider = \"alidns\" domain = \"example.com\" host = \"foo\" ip_method = \"dnspod\" delay = 300 key = \"AccessKey ID\" secret = \"AccessKey Secret\" # use [[settings]] to start a new domain config # setup for example.com [[settings]] provider = \"dnspod\" domain = \"example.com\" host = \"@\" ip_method = \"dnspod\" delay = 300 token = \"id,token\" # setup for foo.example.com [[settings]] provider = \"dnspod\" domain = \"example.com\" host = \"foo\" ip_method = \"dnspod\" delay = 600 token = \"id,token\" 配置完拉倒最下面”Save Config“，然后”Back to Home“，查看结果，不需要重启，回自行加载，比 qmcgaw/ddns-updater 好用很多 如果需要手动更新，也不需要重启，直接点击”Manual Update“ ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:6:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-安装80x86ddns-updater"},{"categories":["unraid","dns","ddns"],"content":"2. 注意，cloudflare需要添加zone read权限 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:6:2","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-注意cloudflare需要添加zone-read权限"},{"categories":["unraid","dns","ddns"],"content":"五、阿里云 dns 解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#五阿里云-dns-解析"},{"categories":["unraid","dns","ddns"],"content":"1. 阿里云申请 AccessKey 用于api调用 点击 👉🏻阿里云 dns 登录地址👈🏻 即可跳转登录 登录控制台之后，鼠标移动到右上角的人头像，不需要点击人头像，然后选择AccessKey 管理 创建 AccessKey 有两种方式，第一种是admin 权限的 Accesskey，如果泄露，那么会被用于此账号下面所有的 api 控制权限，非常不安全，推荐使用第二种子用户 Accesskey 模式 第一种 admin 权限的 Accesskey 第二种子用户 Accesskey 模式 5.1 只需要选择OpenAPi 调用访问就好，控制台访问指的是这个账号可以用网页访问阿里云，没必要，用不到。 5.2 创建完成后，需要给用户进行授权AliyunDNSFullAccess的云解析dns权限 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-阿里云申请-accesskey-用于api调用"},{"categories":["unraid","dns","ddns"],"content":"2. 在 云解析DNS 添加 freenom 注册的免费域名 添加域名解析 把 freenom 的NS域名服务器改为阿里云的 手动添加解析记录做测试 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-在-云解析dns-添加-freenom-注册的免费域名"},{"categories":["unraid","dns","ddns"],"content":"3. 使用 ddns-go 动态解析域名： 把步骤1申请到的CK填入ddns-go 的DNS服务商； 然后添加需要解析的域名到IPV4，选择右上角的保存就好了； 然后在最左边查看解析日志就好了，对应的域名显示解析成功就表示正常了。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3--使用-ddns-go-动态解析域名"},{"categories":["unraid","dns","ddns"],"content":"七、腾讯云 dnspod 解析 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#七腾讯云-dnspod-解析"},{"categories":["unraid","dns","ddns"],"content":"1. 在腾讯云 dnspod 添加 freenom 注册的域名 你可以点击 👉🏻腾讯云 登录入口👈🏻 即可跳转登录，也可以点击 👉🏻dnspod 登录入口👈🏻 即可跳转登录，两个都一样可以用； 添加域名 查看dnspod的DNS服务器地址 修改freenom的NS地址为腾讯云的dnspod，最迟24小时内生效。 点击刷新后，解析状态显示“正常解析”就代表正常了 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-在腾讯云-dnspod-添加-freenom-注册的域名"},{"categories":["unraid","dns","ddns"],"content":"2. 申请api秘钥 📢腾讯云 API 密钥 不支持 dnspod 解析，请使用DNSPod Token ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-申请api秘钥"},{"categories":["unraid","dns","ddns"],"content":"3. 使用 ddns-go 动态解析域名 不管解析成功还是失败，这里都会显示日志信息。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-使用-ddns-go-动态解析域名"},{"categories":["unraid","dns","ddns"],"content":"八、cloudflare 动态 ddns 解析 📢：自 2020 年 4 月起，CloudFlare 不在支持 Freenom 的免费域名（.tk、.ml、.ga、.cf、.gq）调用 api token 的权限，只支持付费域名，所以现在想要用api自动更新ip的，可以弃用了，不过如果是dashboard 的话，还可以支持手动更新和免费证书。 Tips：我测试了.com的付费域名和.tk的免费域名，api调用只支持.com，但是dashboard 面板还可以继续使用.tk免费，没有api功能。 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:0:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#八cloudflare-动态-ddns-解析"},{"categories":["unraid","dns","ddns"],"content":"1. cloudflare 添加 freenom 注册的域名 1.1 点击 👉🏻CloudFlare登录地址👈🏻 即可跳转登录 1.2 添加域名 1.3 选择免费的功能就可以了 1.4 默认会自动扫描该域名的已有的解析地址，等就是了 1.5 重点来了，这里会显示你需要修改的freenom的NS地址，比如我之前是修改为阿里云，这次就修改成cloudflare的就好 buck.ns.cloudflare.com treasure.ns.cloudflare.com 1.6 更改 Freenom 的 NS 地址到 cloudflare，具体可查看2.2步骤 1.7 默认配置建议都开启，不过因为个人用，可能不会有HTTPS，这个可以关闭； ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#1-cloudflare-添加-freenom-注册的域名"},{"categories":["unraid","dns","ddns"],"content":"2. CloudFlare申请CK用于api调用 点击 👉🏻CloudFlare api token 获取地址👈🏻 即可跳转登录 鼠标点击右上角获取，进入“我的个人资料”，然后选择“API 令牌”，在创建“令牌”即可 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#2-cloudflare申请ck用于api调用"},{"categories":["unraid","dns","ddns"],"content":"默认选择上面的dns模板就好了，主要是区域资源这里有三个选项，这里做一下解释 所有区域：意味着是该账号下面的域名都可以，即便你不是域名所有者，因为cloudflare是有邀请用户进行管理域名的权限控制功能； 账户的所有区域：表示该账号的域名所有者，被别人邀请管理的域名不归管控； 特定区域：就是指定域名进行管理了； ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:1","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#默认选择上面的dns模板就好了主要是区域资源这里有三个选项这里做一下解释"},{"categories":["unraid","dns","ddns"],"content":"注意：有些程序会使用 zone id 作为配置使用 ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:2:2","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#注意有些程序会使用-zone-id-作为配置使用"},{"categories":["unraid","dns","ddns"],"content":"3. ddns-go 解析 cloudflare 📢免费域名确实无法api解析，报错如下图，com的域名解析正常。 参考： https://zhuanlan.zhihu.com/p/115535965 https://post.smzdm.com/p/ad29zgep/ ","date":"2021-12-29","objectID":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["dns","freenom","ddns"],"title":"freenom免费域名自动续期和ddns","uri":"/%E7%94%B3%E8%AF%B7freenom%E5%85%8D%E8%B4%B9%E5%9F%9F%E5%90%8D%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F%E5%B9%B6%E8%87%AA%E5%8A%A8ddns%E8%A7%A3%E6%9E%90/#3-ddns-go-解析-cloudflare"},{"categories":["openwrt"],"content":"1. 使用场景 openwrt 做单臂旁路由，主路由 DHCP 把 gateway 和 dns 都指向了旁路由的 ip。 ","date":"2021-12-27","objectID":"/%E5%8D%95%E8%87%82%E7%9B%98%E8%B7%AF%E7%94%B1%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/:1:0","series":null,"tags":["openwrt"],"title":"openwrt单臂盘路由端口转发","uri":"/%E5%8D%95%E8%87%82%E7%9B%98%E8%B7%AF%E7%94%B1%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/#1-使用场景"},{"categories":["openwrt"],"content":"2. 方法 2.1 首先要在主路由把旁路由的端口映射出去，我这边直接在主路由做了DMZ转发，把旁路由的所有端口都转发出去，然后由旁路由控制外部的端口，当然你也可以在主路由选定端口范围进行转发，具体看自己需求。 2.2 旁路由 op 要开启 nat 转发。 2.3 添加端口转发配置 2.4 因为是单臂旁路由，只有一个网口，所以一般 op 都会设置为 lan 口进行处理 ip 数据。故此👇🏻配置如下 源区域选择 wan(lan)； 内部区域也选择 lan； 外部端口自定义，最好超过 10000，80 和 443 端口就千万别用了，经验之谈，当然听不听就是你自己的事情了； 内部 ip 地址和端口就是你要对外访问的内部服务； 启用NAT回环； 2.5 然后，你就可以尽情的用外部端口进行访问了，记得要加密，保护自己的隐私安全哟(＾Ｕ＾)ノ~ＹＯ！！！ ","date":"2021-12-27","objectID":"/%E5%8D%95%E8%87%82%E7%9B%98%E8%B7%AF%E7%94%B1%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/:2:0","series":null,"tags":["openwrt"],"title":"openwrt单臂盘路由端口转发","uri":"/%E5%8D%95%E8%87%82%E7%9B%98%E8%B7%AF%E7%94%B1%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/#2-方法"},{"categories":["Unraid"],"content":"一、环境： 以下环境只在于体验群辉系统带来的体验感，在保持口袋经济稳定的情况下，我们还是应该购买正规的群晖NAS服务器，体验和学习可以用黑群晖系统安装虚拟机来作为体验，有能力还是要买台白裙做冷备。 unraid：6.9.2 群辉系统：DS918+_7.0.1-42218 cpu：i9-10900t es 测试不显版 QTB0 主板：B460M Steel Legend 钢铁传奇 二、安装群辉虚拟系统 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:0","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#一环境"},{"categories":["Unraid"],"content":"2.1 创建 VMS 虚拟机 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:1","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#21-创建-vms-虚拟机"},{"categories":["Unraid"],"content":"2.2 配置 DSM 群辉虚拟机的选项 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:2","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#22-配置-dsm-群辉虚拟机的选项"},{"categories":["Unraid"],"content":"2.3 因为网卡驱动集成了virtio，所以现在不需要改成 e1000 都可以正常使用了 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:3","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#23-因为网卡驱动集成了virtio所以现在不需要改成-e1000-都可以正常使用了"},{"categories":["Unraid"],"content":"2.4 硬盘直通 其实就是把在“SHARES”里面，我们没有把硬盘给 UNRAID 组阵列的名称复制出来，加上“/dev/disk/by-id/ata-”前缀，整个路径分配给群辉虚拟机就好了，是不是很简单捏，不过前提是你要安装“Unassigned Devices”这个插件，才会显示未被Unraid使用和格式化的硬盘、usb、虚拟硬盘==； ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:4","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#24-硬盘直通"},{"categories":["Unraid"],"content":"2.5 然后就是一步一步的创建了，开机启动，很多步骤都卡在了 55%，原因会有很多，这里略过。 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:5","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#25-然后就是一步一步的创建了开机启动很多步骤都卡在了-55原因会有很多这里略过"},{"categories":["Unraid"],"content":"2.6 待到安装完成，基本上按照正常的群辉开启动配置一步一步下去就好了，不过需要注意下几个略过的地方 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:6","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#26-待到安装完成基本上httpspinpaismzdmcom285004按照正常的群辉开启动配置一步一步下去就好了不过需要注意下几个略过的地方"},{"categories":["Unraid"],"content":"2.7 安装 Synology Photos 这个时候我们上传图片并开启“人物相册”，也就是人脸识别空间，会发现，一直开在等待上传中，这里就表示，人脸识别失败了，需要用一些非常规手段去实现“人脸AI”功能。 ](https://post.smzdm.com/p/a5dl2808/pic_22/) ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:7","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#27-安装-synology-photos"},{"categories":["Unraid"],"content":"2.8 安装 Video Station 这里硬解测试是失败的，无法进行硬解转码，需要半洗白，同时把核显驱动补上。 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:8","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#28-安装-video-station"},{"categories":["Unraid"],"content":"2.9 群辉开启ssh登录，并设置root账号密码 #这里输入的是你安装群辉系统的第一个创建的用户的密码，我创建的是unclezhao，所以输入他的密码回车就行了 sudo su - synouser –setpw root qwe@1234 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:9","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#29-群辉开启ssh登录并设置root账号密码"},{"categories":["Unraid"],"content":"2.10 修改sshd 配置，然后重启sshd服务，无需重启群辉虚拟机 ](https://post.smzdm.com/p/a5dl2808/pic_30/) ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:0:10","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#210-修改sshd-配置然后重启sshd服务无需重启群辉虚拟机"},{"categories":["Unraid"],"content":"三、Unraid 开启核显虚拟化给群辉 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:0","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#三unraid-开启核显虚拟化给群辉"},{"categories":["Unraid"],"content":"3.0 主板开启 gpu 共享内存为 1024M，其他测试发现都有问题，无法开启核显虚拟化直通； ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:1","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#30-主板开启-gpu-共享内存为-1024m其他测试发现都有问题无法开启核显虚拟化直通"},{"categories":["Unraid"],"content":"3.1 安装 Intel GVT-g 插件，然后重启 Unraid； ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:2","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#31-安装-intel-gvt-g-插件然后重启-unraid"},{"categories":["Unraid"],"content":"3.2 将虚拟 GPU 核显导入群辉虚拟系统使用； ](https://post.smzdm.com/p/a5dl2808/pic_35/) ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:3","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#32-将虚拟-gpu-核显导入群辉虚拟系统使用"},{"categories":["Unraid"],"content":"3.3 因为 gpu 的位置问题，需要修改他的总线位置改成红框内的样子“bus=‘0x00’ slot=‘0x02’”，否则会导致核显识别有问题； ](https://post.smzdm.com/p/a5dl2808/pic_37/) ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:4","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#33-因为-gpu-的位置问题需要修改他的总线位置改成红框内的样子bus0x00-slot0x02否则会导致核显识别有问题"},{"categories":["Unraid"],"content":"3.4 然后删除位置重叠的这段代码（红框内），也可以单独删除“bus=“0x00 slot= 0x02”那4行，以下二选一删除即可 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:5","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#34-然后删除位置重叠的这段代码红框内也可以单独删除bus0x00-slot-0x02那4行以下二选一删除即可"},{"categories":["Unraid"],"content":"3.5 用 winscp 导入核显驱动，重启群辉虚拟机 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:6","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#35-用-winscp-导入核显驱动重启群辉虚拟机"},{"categories":["Unraid"],"content":"3.6 ssh 进入查看一下总线位置和核显是否启动 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:7","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#36-ssh-进入查看一下总线位置和核显是否启动"},{"categories":["Unraid"],"content":"3.7 然后再打开Viedo Station ，测试是否能够转码即可 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:1:8","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#37-然后再打开viedo-station-测试是否能够转码即可"},{"categories":["Unraid"],"content":"四、群晖 DS918+7 硬刚 CPU 开启 Photos 人脸识别 群辉选择 DS918+7.0.1 硬解人脸识别，使用 gpu 直通或者 Intel VTG-g 核显虚拟化直通后，还是无法人脸识别的，还是老老实实走 CPU 人脸识别吧，起码还是能用，硬解（其实在这里是个伪命题，因为 unraid 可以通过 docker 安装 video 服务来完成硬解， DSM 虚拟机可以不用到），不过不能不折腾。 经过研究，Synology Photos应该使用了OpenCv的DNN神经网络来识别人脸。这个OpenCv库可根据群晖的型号调用不同的神经网络模型，并调用显卡的GPU来加速计算。如果硬件和库代码不匹配，那就无法人脸识别了。所以人脸识别主要是显卡的GPU调用的问题，跟洗白没关系。技术上可以打个补丁解决。最低要求是 intel 六代或者以上的 CPU。黑群晖 DS918-7.0.1 的 Synology Photos 套件人脸识别，与你的系统是否已经洗白并无直接关系。 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:2:0","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#四群晖-ds9187-硬刚-cpu-开启-photos-人脸识别"},{"categories":["Unraid"],"content":"4.1 先确认一下 Synology Photos 的版本必须是 1.1.0-0224 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:2:1","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#41-先确认一下-synology-photos-的版本必须是-110-0224"},{"categories":["Unraid"],"content":"4.2 先停用 Synology Photos ](https://post.smzdm.com/p/a5dl2808/pic_45/) ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:2:2","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#42-先停用-synology-photos"},{"categories":["Unraid"],"content":"4.3 ssh 登录群辉虚拟机，然后执行以下命令 mv /var/packages/SynologyPhotos/target/usr/lib/libsynophoto-plugin-model.so.1.0 /var/packages/SynologyPhotos/target/usr/lib/libsynophoto-plugin-model.so.1.0.bak wget https://cdn.jsdelivr.net/gh/jinlife/Synology_Photos_Face_Patch@main/libsynophoto-plugin-model.so -O /var/packages/SynologyPhotos/target/usr/lib/libsynophoto-plugin-model.so.1.0 chmod 755 /var/packages/SynologyPhotos/target/usr/lib/libsynophoto-plugin-model.so.1.0 chown SynologyPhotos:SynologyPhotos /var/packages/SynologyPhotos/target/usr/lib/libsynophoto-plugin-model.so.1.0 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:2:3","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#43-ssh-登录群辉虚拟机然后执行以下命令"},{"categories":["Unraid"],"content":"4.4 重新启动 Synology Photos，并打开人脸识别，就正常了。 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:2:4","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#44-重新启动-synology-photos并打开人脸识别就正常了"},{"categories":["Unraid"],"content":"五、总结 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:0","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#五总结"},{"categories":["Unraid"],"content":"5.1 群辉 DS918+_7.0.1 目前人脸识别不正常的话，那只能通过CPU进行人脸AI识别功能，如果想要GPU的话，还是老实用6.2.3的版本吧，另外DS3615-7.0 因为用的是cpu进行人脸识别，所以如果没有硬解视频的需求，直接用DS3615就好了，也就省的折腾（时间成本也是白花花的大银子，不说了都是泪） ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:1","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#51-群辉-ds918_701-目前人脸识别不正常的话那只能通过cpu进行人脸ai识别功能如果想要gpu的话还是老实用623的版本吧另外ds3615-70-因为用的是cpu进行人脸识别所以如果没有硬解视频的需求直接用ds3615就好了也就省的折腾时间成本也是白花花的大银子不说了都是泪"},{"categories":["Unraid"],"content":"5.2 DS918+_7.0.1 CPU 驱动，是jinlife大佬提出来的，具体可以看一下链接 https://github.com/jinlife/Synology_Photos_Face_Patch https://blog.jinlife.com/index.php/archives/49/ https://xpenology.com/forum/topic/45795-redpill-the-new-loader-for-624-discussion/page/123/?tab=comments#comment-226764 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:2","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#52-ds918_701-cpu-驱动是jinlife大佬提出来的具体可以看一下链接"},{"categories":["Unraid"],"content":"5.3 DS918+7.0以上成功的案例具体可以查看👇🏻两个网站可以的统计信息和网友的评论。 https://www.openos.org/threads/redpill7-0cpu.3647/ https://wp.gxnas.com/11458.html ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:3","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#53-ds91870以上成功的案例具体可以查看两个网站可以的统计信息和网友的评论"},{"categories":["Unraid"],"content":"5.3.1 核显直通所需要的驱动包和 cpu 是否支持硬解的说明，可以参考人生观大佬的文章； https://wp.gxnas.com/7952.html ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:4","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#531-核显直通所需要的驱动包和-cpu-是否支持硬解的说明可以参考人生观大佬的文章"},{"categories":["Unraid"],"content":"5.4 以上步骤都尝试之后，如果还不能人脸识别，可能有以下几个尝试，不一定有用，也可能是我瞎尝试，乱讲，且看且忘记 上传 photos 的图片太少，可以把同一张图片在复制一次，上传测试看看，我试过好几次，这样就能识别出照片了，都是临时测试网上下载的； 上传的图片名称有特殊符号，比如括号，我试过图片名称为 image(1)、images(2)的图片都无法识别，后面改了名称重新上传，就有了； 群辉虚拟机分配 4 vcpu，内存超 4 g； ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:5","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#54-以上步骤都尝试之后如果还不能人脸识别可能有以下几个尝试不一定有用也可能是我瞎尝试乱讲且看且忘记"},{"categories":["Unraid"],"content":"5.5 Unraid安装群辉虚拟系统名称不能用特殊符号，否则会导致 Intel GVT-g 插件导入虚拟化核显失败，不会显示那一段核显直通的代码 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:6","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#55-unraid安装群辉虚拟系统名称不能用特殊符号否则会导致-intel-gvt-g-插件导入虚拟化核显失败不会显示那一段核显直通的代码"},{"categories":["Unraid"],"content":"5.6 如果你之前手动在 Unraid 开启过核显驱动，并且在启动文件里面写好了，需要删掉或注释掉 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:7","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#56-如果你之前手动在-unraid-开启过核显驱动并且在启动文件里面写好了需要删掉或注释掉"},{"categories":["Unraid"],"content":"5.7 Intel-GVT-g 插件支持的 CPU 型号 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:8","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#57-intel-gvt-g-插件支持的-cpu-型号"},{"categories":["Unraid"],"content":"5.8 为什么GPU核显要在 0000.00.02.0 的位置么，因为虚拟机的核显ID位置和物理机的核显ID位置不一致，其实最简单的做法就是用 lscpi 看看白裙的核显位置就是了，另外一个就是Intel GVT-g 插件的位置也有显示。 lscpi显示pci设备 Intel GVT-g 显示 Address 位置 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:9","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#58-为什么gpu核显要在-000000020-的位置么因为虚拟机的核显id位置和物理机的核显id位置不一致httpspinpaismzdmcom102375其实最简单的做法就是用-lscpi-看看白裙的核显位置就是了另外一个就是intel-gvt-g-插件的位置也有显示"},{"categories":["Unraid"],"content":"5.9 Intel-GVT-g 使用过程中因为多次导入gpu到虚拟机，然后因为使用过程中没有正常停机从插件删除核显配置，就把DSM虚拟机删了，后面在重新到插件里面导入gpu，就会报错gpu不够用了，因为被分配到之前的机器上没有释放掉，解决办法也简单，先删除掉插件之后再重启Unraid，重新安装配置就好了 ](https://post.smzdm.com/p/a5dl2808/pic_52/)Unraid系统日志报错 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:10","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#59-intel-gvt-g-使用过程中因为多次导入gpu到虚拟机然后因为使用过程中没有正常停机从插件删除核显配置就把dsm虚拟机删了后面在重新到插件里面导入gpu就会报错gpu不够用了因为被分配到之前的机器上没有释放掉解决办法也简单先删除掉插件之后再重启unraid重新安装配置就好了"},{"categories":["Unraid"],"content":"5.10 正常的步骤如下，先停止DSM群辉虚拟机，然后从插件删除 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:11","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#510-正常的步骤如下先停止dsm群辉虚拟机然后从插件删除"},{"categories":["Unraid"],"content":"5.11 为何要把 cpu 人脸识别驱动导入到某个位置，因为另外两个都是软连接到 libsynophoto-plugin-model.so.1.0，就像是win的快捷方式一样，都需要修改最终的boss才能生效。 ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:12","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#511-为何要把-cpu-人脸识别驱动导入到某个位置因为另外两个都是软连接到-libsynophoto-plugin-modelso10就像是win的快捷方式一样都需要修改最终的boss才能生效"},{"categories":["Unraid"],"content":"5.12 命令行重建索引方式 synoindex -R /var/services/homes/你的用户名/Photos ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:13","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#512-命令行重建索引方式"},{"categories":["Unraid"],"content":"5.13 如果有些驱动没集成，你也可以自己编译，参考如下 https://github.com/RedPill-TTG/redpill-load https://github.com/RedPill-TTG/redpill-lkm 作者声明本文无利益相关，欢迎值友理性交流，和谐讨论～ ","date":"2021-12-26","objectID":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/:3:14","series":null,"tags":["Unraid","nas"],"title":"Unraid安装群晖DS918+7测试硬解和人脸识别","uri":"/unraid%E5%AE%89%E8%A3%85%E7%BE%A4%E6%99%96ds918-7%E6%B5%8B%E8%AF%95%E7%A1%AC%E8%A7%A3%E5%92%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/#513-如果有些驱动没集成你也可以自己编译参考如下"},{"categories":["nginx"],"content":"【Nginx】修改 nginx 用户 id 和 gid","date":"2021-05-16","objectID":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/","series":null,"tags":["nginx"],"title":"【Nginx】修改 nginx 用户 id 和 gid","uri":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/"},{"categories":["nginx"],"content":"前因 近期创建的 web 服务器上安装了新的 nginx 扩容 web 节点，然后发现挂载了 AWS 的 EFS 在 /upload/目录下，ll 发现文件的用户和用户组的权限都不是 nginx，后来得知发现一开始那台 EFS 挂载机的 nginx uid 和 gid 是 993 和 997，与新的这台的 nginx id 不一致，导致权限错乱。 ","date":"2021-05-16","objectID":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/:0:0","series":null,"tags":["nginx"],"title":"【Nginx】修改 nginx 用户 id 和 gid","uri":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/#前因"},{"categories":["nginx"],"content":"解决办法 先停掉 nginx 服务 修改 nginx gid 和 uid，不能与已经存在的冲突，如果非要用已经存在的，要先修改已经存在的uid 和 gid，通过cat /etc/passwd寻找 改了之后要修改之前为 nginx 属主属组的文件和目录，用 chown -R nginx 或者 chown -R nginx.nginx 递归修改 查看 当前 nginx 用户 id [root@proxy conf.d]# id nginx uid=996(nginx) gid=993(nginx) groups=993(nginx) 查看文件和目录属性 [root@proxy tmp]# ll html/ total 0 drwxr-xr-x 2 nginx nginx 6 May 17 06:24 index -rw-r--r-- 1 nginx nginx 0 May 17 06:24 index.html 修改 nginx 的 gid [root@proxy conf.d]# groupmod -g 1013 nginx [root@proxy conf.d]# id nginx uid=996(nginx) gid=1013(nginx) groups=1013(nginx) 再次查看文件和目录属性，这个时候 nginx 用户组就变成 993了 [root@proxy tmp]# ll html/ total 0 drwxr-xr-x 2 nginx 993 6 May 17 06:24 index -rw-r--r-- 1 nginx 993 0 May 17 06:24 index.html 修改 nginx 的 uid 就报错了，该用户正在使用，无法修改 [root@proxy conf.d]# usermod -u 1013 -g 1013 nginx usermod: user nginx is currently used by process 1730 停掉 nginx，在进行修改 [root@proxy conf.d]# systemctl stop nginx [root@proxy conf.d]# usermod -u 1013 -g 1013 nginx [root@proxy conf.d]# id nginx uid=1013(nginx) gid=1013(nginx) groups=1013(nginx) 第三次查看文件和目录权限，默认原来的 uid 和 gid [root@proxy tmp]# ll html/ total 0 drwxr-xr-x 2 996 993 6 May 17 06:24 index -rw-r--r-- 1 996 993 0 May 17 06:24 index.html 修改文件目录属性为 nginx [root@proxy tmp]# chown -R nginx.nginx html/ [root@proxy tmp]# ll html/ total 0 drwxr-xr-x 2 nginx nginx 6 May 17 06:24 index -rw-r--r-- 1 nginx nginx 0 May 17 06:24 index.html 全局确认一下还有哪些文件或者目录的属主和属组没有更改 find / -uid 996 -ls find / -gid 993 -ls useradd 创建示例：创建 test 用户 [root@proxy conf.d]# groupadd -g 1012 test \u0026\u0026 useradd -u 1012 -g 1012 -s /sbin/nologin -M test [root@proxy conf.d]# cat /etc/passwd|grep test test❌1012:1012::/home/test:/sbin/nologin -M ：不创建家目录 -s /sbin/nologin ：该用户不能登录 userdel 删除用户 [root@proxy tmp]# userdel -r test userdel: test home directory (/home/test) not found -r ：删除用户家目录 ","date":"2021-05-16","objectID":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/:0:0","series":null,"tags":["nginx"],"title":"【Nginx】修改 nginx 用户 id 和 gid","uri":"/nginx-%E4%BF%AE%E6%94%B9nginx%E7%94%A8%E6%88%B7id%E5%92%8Cgid/#解决办法"},{"categories":["git"],"content":"git 基于 master 创建删除 develop 分支","date":"2021-04-18","objectID":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/","series":null,"tags":["git"],"title":"git 基于 master 创建删除 develop 分支","uri":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/"},{"categories":["git"],"content":"应用场景： 开发过程中经常用到从master分支copy一个本地分支作为开发分支 ","date":"2021-04-18","objectID":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/:0:0","series":null,"tags":["git"],"title":"git 基于 master 创建删除 develop 分支","uri":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/#应用场景"},{"categories":["git"],"content":"步骤： 自己先 clone 代码下来，这里不教 切换到被copy的分支（master），并且从远端拉取最新版本 git checkout master git pull 从当前分支拉copy开发分支 git checkout -b develop 把新建的分支push到远端 git push origin develop 关联 git branch --set-upstream-to=origin/develop 再次拉取验证 git pull ","date":"2021-04-18","objectID":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/:0:0","series":null,"tags":["git"],"title":"git 基于 master 创建删除 develop 分支","uri":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/#步骤"},{"categories":["git"],"content":"以下如有需要在使用 删除 github 或者 gitlab 上面的远端分支 git push origin --delete develop 删除本地创建的分支，记得要先切换到其他分支在进行删除 git checkout master git branch -d develop ","date":"2021-04-18","objectID":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/:0:0","series":null,"tags":["git"],"title":"git 基于 master 创建删除 develop 分支","uri":"/%E5%9F%BA%E4%BA%8Emaster%E5%88%9B%E5%BB%BA%E5%BC%80%E5%8F%91%E5%88%86%E6%94%AF/#以下如有需要在使用"},{"categories":["java"],"content":"standford parser 和 jdk 版本对应关系","date":"2021-04-16","objectID":"/standford%E5%92%8Cjdk%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/","series":null,"tags":["java"],"title":"standford parser 和 jdk 版本对应关系","uri":"/standford%E5%92%8Cjdk%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/"},{"categories":["java"],"content":"#问题如下： Caused by: java.lang.UnsupportedClassVersionError: org/springframework/web/SpringServletContainerInitializer : Unsupported major.minor version 52.0 (unable to load class org.springframework.web.SpringServletContainerInitializer) 首先解释一下报错原因： stanford parser和jdk版本对应关系 J2SE 8 = 52, J2SE 7 = 51, J2SE 6.0 = 50, J2SE 5.0 = 49, JDK 1.4 = 48, JDK 1.3 = 47, JDK 1.2 = 46, JDK 1.1 = 45 Unsupported major.minor version 52.0: 看到Unsupported你是不是会想到jdk高版本能兼容低版本，但是低版本不能兼容高版本，不错，猜对了，其实就是这个意思。这个错误意思是你项目用JDK1.8运行过，现在又在本地的eclipse等开发工具或者本地环境变量为低版本的jdk1.7或者jdk1.6下运行，eclipse会说：“抱歉，我本地jdk版本太低，不支持这个高级版本jdk1.8编译过的项目运行”。 同理，如果你在高版本的 jdk 比如 11 版本编译了 war 包，然后丢到8 版本的 tomcat 跑，那么也一样会报错。 ","date":"2021-04-16","objectID":"/standford%E5%92%8Cjdk%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/:0:0","series":null,"tags":["java"],"title":"standford parser 和 jdk 版本对应关系","uri":"/standford%E5%92%8Cjdk%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB/#"},{"categories":["jenkins"],"content":"Pipeline 片段语法生成器","date":"2021-04-15","objectID":"/pipeline%E8%AF%AD%E6%B3%95%E7%94%9F%E6%88%90%E5%99%A8/","series":null,"tags":["jenkins"],"title":"Pipeline 片段语法生成器","uri":"/pipeline%E8%AF%AD%E6%B3%95%E7%94%9F%E6%88%90%E5%99%A8/"},{"categories":["jenkins"],"content":"#方法一 内置的“片段生成器”工具有助于为各个步骤创建代码段，发现插件提供的新步骤，或者为特定的步骤尝试不同的参数。 片段生成器由 Jenkins 实例中可用的步骤动态添加。可用的步骤的数量依赖于安装的插件，这些插件显式地公开了流水线中使用的步骤。 要使用代码生成器生成一个步骤的片段： 从已配置好的流水线导航到 流水线语法 链接（见上），或访问 ${YOUR_JENKINS_URL}/pipeline-syntax。 #方法二： 创建一个 pipeline 的 job，然后拉到最下面，点击Pipeline Syntax ","date":"2021-04-15","objectID":"/pipeline%E8%AF%AD%E6%B3%95%E7%94%9F%E6%88%90%E5%99%A8/:0:0","series":null,"tags":["jenkins"],"title":"Pipeline 片段语法生成器","uri":"/pipeline%E8%AF%AD%E6%B3%95%E7%94%9F%E6%88%90%E5%99%A8/#"},{"categories":["网络"],"content":"DNS刷新办法","date":"2021-04-13","objectID":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/","series":null,"tags":["DNS"],"title":"DNS刷新办法","uri":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/"},{"categories":["网络"],"content":"Linux 刷新 dns 缓存 刷新DNS－Systemd Resolved systemd-resolved --flush-caches 刷新DNS－NSCD systemctl restart nscd.service ","date":"2021-04-13","objectID":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/:0:0","series":null,"tags":["DNS"],"title":"DNS刷新办法","uri":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/#linux-刷新-dns-缓存"},{"categories":["网络"],"content":"windows 刷新 dns 缓存 ifconfig/flushdns ","date":"2021-04-13","objectID":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/:0:0","series":null,"tags":["DNS"],"title":"DNS刷新办法","uri":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/#windows-刷新-dns-缓存"},{"categories":["网络"],"content":"Mac 刷新 dns 缓存 sudo dscacheutil -flushcache;sudo killall -HUP mDNSResponder ","date":"2021-04-13","objectID":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/:0:0","series":null,"tags":["DNS"],"title":"DNS刷新办法","uri":"/dns%E5%88%B7%E6%96%B0%E5%8A%9E%E6%B3%95/#mac-刷新-dns-缓存"},{"categories":["k8s"],"content":"【k8s】部署 jenkins 并部署 tomcat 服务示例","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/"},{"categories":["k8s"],"content":"1. 环境 k8s 集群：v1.20.4 版本 k8s-master1 192.168.110.235 k8s-node1 192.168.110.236 k8s-node2 192.168.110.237 gitlab 192.168.110.238 nfs，harbor 192.168.110.239 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#1-环境"},{"categories":["k8s"],"content":"2. 发布流程 流程： 拉取代码 git checkout 编译代码 mvn clean 打包镜像 并上传镜像仓库 使用yaml 模板文件部署用镜像仓库中的镜像，kubectl 命令部署pod 开发测试 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#2-发布流程"},{"categories":["k8s"],"content":"3. harbor 部署 参考：Harbor安装 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#3-harbor-部署"},{"categories":["k8s"],"content":"4. gitlab 部署 参考：Gitlab安装 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#4-gitlab-部署"},{"categories":["k8s"],"content":"5. nfs server 部署 参考：K8s环境 nfs 动态存储卷部署 #在原有的 nfs server 上面添加 jenkins 的 nfs mkdir -p /data/nfs/jenkins echo \"/data/nfs/jenkins *(rw,sync,no_root_squash,no_subtree_check)\" \u003e\u003e /etc/exports systemctl restart nfs \u0026\u0026 systemctl restart rpcbind ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#5-nfs-server-部署"},{"categories":["k8s"],"content":"6. 在 Kubernetes 中部署 jenkins ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#6-在-kubernetes-中部署-jenkins"},{"categories":["k8s"],"content":"6.1 创建 jenkins 动态 pvc kubectl create namespace nfs helm repo add helm-stable https://charts.helm.sh/stable helm repo update cat \u003e jenkins-client-nfs.yaml \u003c\u003c EOF # NFS 设置 nfs: server: 192.168.110.239 path: /data/nfs/jenkins storageClass: # 此配置用于绑定 PVC 和 PV name: jenkins-nfs-client # 资源回收策略 #主要用于绑定的PVC删除后，资源释放后如何处理该PVC在存储设备上写入的数据。 #Retain：保留，删除PVC后，PV保留数据； #Recycle：回收空间，删除PVC后，简单的清除文件；（NFS和HostPath存储支持） #Delete：删除，删除PVC后，与PV相连接的后端存储会删除数据；（AWS EBS、Azure Disk、Cinder volumes、GCE PD支持） reclaimPolicy: Delete # 使用镜像 image: repository: kubesphere/nfs-client-provisioner # 副本数量 replicaCount: 1 EOF #helm 部署 nfs-client-provisioner helm install jenkins-nfs-storage -n nfs --values jenkins-client-nfs.yaml helm-stable/nfs-client-provisioner ###查看运行状态： [root@node01 helm]# kubectl get pod,sc -n nfs|grep jenkins pod/jenkins-nfs-storage-nfs-client-provisioner-6d8974459b-wwh88 1/1 Running 0 50s storageclass.storage.k8s.io/jenkins-nfs-client cluster.local/jenkins-nfs-storage-nfs-client-provisioner Delete Immediate true 50s ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:1:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#61-创建-jenkins-动态-pvc"},{"categories":["k8s"],"content":"6.2 yaml 部署 jenkins mkdir /data/yml/jenkins -p cd /data/yml/jenkins kubectl create namespace ops cat \u003e jenkins.yml \u003c\u003c EOF apiVersion: apps/v1 kind: Deployment metadata: name: jenkins namespace: ops labels: name: jenkins spec: replicas: 1 selector: matchLabels: name: jenkins template: metadata: name: jenkins labels: name: jenkins spec: serviceAccountName: jenkins containers: - name: jenkins image: jenkins/jenkins ports: - containerPort: 8080 - containerPort: 50000 resources: limits: cpu: 2 memory: 4Gi requests: cpu: 1 memory: 1Gi env: - name: LIMITS_MEMORY valueFrom: resourceFieldRef: resource: limits.memory divisor: 1Mi - name: JAVA_OPTS value: -Xmx\\$(LIMITS_MEMORY)m -XshowSettings:vm -Dhudson.slaves.NodeProvisioner.initialDelay=0 -Dhudson.slaves.NodeProvisioner.MARGIN=50 -Dhudson.slaves.NodeProvisioner.MARGIN0=0.85 volumeMounts: - name: jenkins-home mountPath: /var/jenkins_home securityContext: fsGroup: 1000 volumes: - name: jenkins-home persistentVolumeClaim: claimName: jenkins --- apiVersion: v1 kind: PersistentVolumeClaim metadata: name: jenkins namespace: ops spec: storageClassName: \"jenkins-nfs-client\" accessModes: - ReadWriteMany resources: requests: storage: 10Gi --- apiVersion: v1 kind: Service metadata: name: jenkins namespace: ops spec: selector: name: jenkins type: NodePort ports: - name: http port: 80 targetPort: 8080 protocol: TCP nodePort: 30008 - name: agent port: 50000 protocol: TCP --- --- apiVersion: v1 kind: ServiceAccount metadata: name: jenkins namespace: ops --- kind: Role apiVersion: rbac.authorization.k8s.io/v1 metadata: name: jenkins namespace: ops rules: - apiGroups: [\"\"] resources: [\"pods\",\"events\"] verbs: [\"create\",\"delete\",\"get\",\"list\",\"patch\",\"update\",\"watch\"] - apiGroups: [\"\"] resources: [\"pods/exec\"] verbs: [\"create\",\"delete\",\"get\",\"list\",\"patch\",\"update\",\"watch\"] - apiGroups: [\"\"] resources: [\"pods/log\"] verbs: [\"get\",\"list\",\"watch\"] - apiGroups: [\"\"] resources: [\"secrets\",\"events\"] verbs: [\"get\"] --- apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata: name: jenkins namespace: ops roleRef: apiGroup: rbac.authorization.k8s.io kind: Role name: jenkins subjects: - kind: ServiceAccount name: jenkins EOF kubectl apply -f jenkins.yml ###查看安装结果 [root@node01 ~]# kubectl get pod,pvc,svc -n ops -o wide NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES pod/jenkins-f656474b8-bjv5s 1/1 Running 0 20s 10.244.36.92 k8s-node1 \u003cnone\u003e \u003cnone\u003e NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE VOLUMEMODE persistentvolumeclaim/jenkins Bound pvc-037d24b4-16cf-4900-ac06-76699dbc7c24 10Gi RWX jenkins-nfs-client 20s Filesystem NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE SELECTOR service/jenkins NodePort 10.0.0.229 \u003cnone\u003e 80:30008/TCP,50000:30619/TCP 20s name=jenkins ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:2:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#62-yaml-部署-jenkins"},{"categories":["k8s"],"content":"6.3 控制台访问 访问方式：k8s master/node ip+ NodePort 访问地址：192.168.110.235:30008 查看密码：kubectl logs -n ops jenkins-f656474b8-bjv5s |grep -A 3 password ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:3:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#63-控制台访问"},{"categories":["k8s"],"content":"6.4 jenkins 安装插件 默认从国外网络下载插件，会比较慢，建议修改成国内源： 只需要到nfs上，修改PVC挂载的内容即可 cd /data/nfs/jenkins/ops-jenkins-pvc-037d24b4-16cf-4900-ac06-76699dbc7c24/updates cp default.json default.json-bak #修改插件的下载地址为国内的地址 sed -i 's/https:\\/\\/updates.jenkins.io\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g' default.json #修改jenkins启动时检测的URL网址，改为国内baidu的地址 sed -i 's/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g' default.json ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:4:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#64-jenkins-安装插件"},{"categories":["k8s"],"content":"6.5 删除 pod 重建 kubectl delete pod -n ops jenkins-f656474b8-bjv5s 修改完后，jenkins 会重建，打开浏览器访问: http://NodeIP:30008 输入账户密码从新登陆 jenkins 控制台 依次点击 管理Jenkins（Manage Jenkins）-\u003e系统配置(System Configuration)–\u003e管理插件(Manage Pluglns)–\u003e 分别搜索 Git/Git Parameter/Pipeline/kubernetes/Config File Provider，选中点击安装。 安装插件可能会失败，多试几次就好了，安装完记得重启Pod 插件名称 用途 Git 用于拉取代码 Git Parameter 用于Git参数化构建 Pipeline 用于流水线 kubernetes 用于连接Kubernetes动态创建Slave代理 Config File Provider 用于存储kubectl用于连接k8s集群的kubeconfig配置文件 Gitlab 当提交代码或打开/更新合并请求时，此插件允许GitLab触发Jenkins中的构建。它还可以将构建状态发送回GitLab。 Gitlab Authentication plugin GitLab身份验证插件提供了一种使用GitLab进行身份验证和授权以保护Jenkins的方法。 credential 账号密码管理插件 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:5:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#65-删除-pod-重建"},{"categories":["k8s"],"content":"6.6 jenkins 在 k8s 中动态创建代理 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#66-jenkins-在-k8s-中动态创建代理"},{"categories":["k8s"],"content":"6.6.1 在 jenkins 中添加 kubernetes ☁️ 管理Jenkins-\u003eManage Nodes and Clouds-\u003econfigureClouds-\u003eAdd 输入Kubernetes 地址： https://kubernetes.default ，点击连接测试，测试通过的话，会显示k8s的版本信息 输入Jenkins 地址： http://jenkins.ops ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:1","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#661-在-jenkins-中添加-kubernetes-"},{"categories":["k8s"],"content":"6.6.2 构建 jenkins-slave 镜像 基于官方镜像提供的 jnlp-slave 使用 docker pull jenkins/jnlp-slave docker tag jenkins/jnlp-slave:latest 192.168.110.239/library/jnlp-slave:latest docker login 192.168.110.239 docker push 192.168.110.239/library/jnlp-slave:latest 基于官方 alpine 镜像提供的Dockerfile 包使用 cd /data git clone https://github.com/jenkinsci/docker-inbound-agent.git cd docker-inbound-agent cp 8/alpine/Dockerfile . 修改 Dockerfile 为以下，主要添加 maven 和 kubectl（和 k8s 集群版本对应） maven 修改为阿里云源：https://github.com/fxkjnj/kubernetes/blob/main/jenkins-for_kubernetes/jenkins-slave/settings.xml kubectl 下载：curl -LO https://dl.k8s.io/release/v1.20.4/bin/linux/amd64/kubectl helm 下载：wget https://get.helm.sh/helm-v3.5.3-linux-amd64.tar.gz \u0026\u0026 tar zxvf helm-v3.5.3-linux-amd64.tar.gz ARG version=4.7-1-alpine FROM jenkins/agent:$version ARG version LABEL Description=\"This is a base image, which allows connecting Jenkins agents via JNLP protocols\" Vendor=\"Jenkins project\" Version=\"$version\" ARG user=jenkins USER root RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories \u0026\u0026\\ apk add maven git curl \u0026\u0026\\ rm -rf /var/cache/apk/* COPY jenkins-agent /usr/local/bin/jenkins-agent COPY settings.xml /etc/maven/settings.xml COPY kubectl /usr/bin/ COPY helm /usr/bin/ RUN chmod +x /usr/bin/kubectl \u0026\u0026\\ chmod +x /usr/bin/helm \u0026\u0026\\ chmod +x /usr/local/bin/jenkins-agent \u0026\u0026\\ ln -s /usr/local/bin/jenkins-agent /usr/local/bin/jenkins-slave USER ${user} ENTRYPOINT [\"/usr/local/bin/jenkins-agent\"] #然后 docker build . -t 192.168.110.239/library/jenkins-slave:4.7.1-alpine docker push 192.168.110.239/library/jenkins-slave:4.7.1-alpine 在jenkins 中创建一个流水线项目，测试jenkins-slave 是否功能 在pipeline 中 编写脚本，pipeline 脚本分为 声明式 和 脚本式 我这里写 声明式 脚本 需要注意的是，spec 中定义containers的名字一定要写jnlp pipeline { agent { kubernetes { yaml ''' apiVersion: v1 kind: Pod metadata: name: jenkins-slave spec: containers: - name: jnlp image: 192.168.110.239/library/jenkins-slave:4.7.1-alpine ''' } } stages { stage('测试') { steps { sh 'hostname' sh 'mvn -version' } } } } 点击Build New 按钮，开始构建 构建结束后，点击项目编号，可以查看jenkins 构建的日志 日志中可以看到 输出了主机名 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:2","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#662-构建-jenkins-slave-镜像"},{"categories":["k8s"],"content":"6.6.3 给 Jenkins-Slave pod 添加存储卷，以及挂载docker 命令到Pod 中 因为每次maven 打包会产生依赖的库文件，为了加快每次编译打包的速度，我们可以创建一个pvc 用来存储maven 每次打包产生的依赖文件。以及 我们需要将 k8s 集群 node 主机上的docker 命令挂载到Pod 中，用于镜像的打包 ，推送 直接创建pvc, 这里使用的动态补给的PV（直接使用上面以及创建好一个jenkins-nfs-client storageClass ） cat \u003e jenkins-slave-pvc.yml \u003c\u003c EOF apiVersion: v1 kind: PersistentVolumeClaim metadata: name: mavencache spec: storageClassName: \"jenkins-nfs-client\" accessModes: - ReadWriteMany resources: requests: storage: 10Gi EOF kubectl apply -f jenkins-slave-pvc.yml -n ops kubectl get pvc -n ops Jenkins-Slave pod yaml内容 apiVersion: v1 kind: Pod metadata: name: jenkins-slave spec: containers: - name: jnlp image: docker push 192.168.110.239/library/jenkins-slave:4.7.1-alpine imagePullPolicy: Always volumeMounts: - name: docker-cmd mountPath: /usr/bin/docker - name: docker-sock mountPath: /var/run/docker.sock - name: maven-cache mountPath: /root/.m2 volumes: - name: docker-cmd hostPath: path: /usr/bin/docker - name: docker-sock hostPath: path: /var/run/docker.sock - name: maven-cache persistentVolumeClaim: claimName: mavencache ##6.7 jenkins 在 kubernetes 中部署 tomcat 示例 上面的harbor镜像仓库，gitlab 代码仓库，jenkins 发布平台都已经部署完成，现在我们需要使用Jenkins在Kubernetes中持续部署一个无状态的tomcat 应用 具体流程如下： 拉取代码 git checkout，我这里直接将 github 的代码 import 到 gitlab 里面了，具体可以参考：Gitlab安装 编译代码 mvn clean 打包镜像 并上传镜像仓库 使用yaml 模板文件部署用镜像仓库中的镜像，kubectl 命令部署pod 开发测试 ###6.7.1 生成拉取git 代码的Pipeline 脚本 登陆jenkins 控制器，使用凭据的方式保存 git 账户信息 和 harbor 账户信息 用于jenkins 从gitlab 中拉取代码 Manage Jenkins -\u003e Manage Credentials -\u003e 全局凭据 (unrestricted) -\u003e Add Credentials 选择Kind 类型 为 username with passwd 输入账户名，密码 添加一个描述信息 也可以使用 access token 的方式保存 gitlab 访问权限 Manage Jenkins -\u003e Configure System -\u003e Gitlab 然后点击一下“Test Connection” 测试为“Success” 状态，则成功了。 gitlab创建 access token，授予 api 权限 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:3","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#663-给-jenkins-slave-pod-添加存储卷以及挂载docker-命令到pod-中"},{"categories":["k8s"],"content":"创建 jenkins job 使用pipeline 生成 git 拉取代码的语法 jenkins 官方提供一个pipeline 语法的生成器 任意创建一个流水线项目 在pipeline 选项那里点击 ， pipeline Syntax 点击片段生成器，在sample step 下拉选项框 中 找到 checkout: check out from version control 输入Repository URL(代码仓库地址): http://192.168.110.238/root/tomcat-java-demo.git 点击Credentials 选择 刚刚创建的git 的用户凭证 最后点击 Generate Pipeline Script 生产pipeline 语法 也就是 下面这段话,有了这个我们就可以在jenkins 上去拉取仓库里的代码了 checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: 'gitlab-238', url: 'http://192.168.110.238/root/tomcat-java-demo.git']]]) ###编译代码 mvn clean 在上面构建Jenkins-Slave镜像的时候，我们已经在镜像里安装了maven 编译代码的软件 只需要代码的路径下执行一条命令即可 mvn clean package -Dmaven.skip.test=true ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:4","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#创建-jenkins-job"},{"categories":["k8s"],"content":"测试案例 tomcat-java-demo gitlim 的 Dockerfile FROM tomcat:8-jdk8 LABEL maintainer www.ctnrs.com RUN rm -rf /usr/local/tomcat/webapps/* ADD target/*.war /usr/local/tomcat/webapps/ROOT.war ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:5","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#测试案例-tomcat-java-demo-gitlim-的-dockerfile"},{"categories":["k8s"],"content":"授权创建 kubeconfig 文件，并保存在 jenkins 中 准备好创建K8S 集群的那一套 ca证书 [root@proxy k8s]# cd /data/ssl/ [root@proxy ssl]# ls ca-config.json ca.csr ca-csr.json ca-key.pem ca.pem 生成请求证书文件 cat \u003eadmin-csr.json \u003c\u003cEOF { \"CN\": \"admin\", \"hosts\": [], \"key\": { \"algo\": \"rsa\", \"size\": 2048 }, \"names\": [ { \"C\": \"CN\", \"L\": \"BeiJing\", \"ST\": \"BeiJing\", \"O\": \"system:masters\", \"OU\": \"System\" } ] } EOF 安装cfssl 生成证书工具 curl -L https://pkg.cfssl.org/R1.2/cfssl_linux-amd64 -o /usr/local/bin/cfssl curl -L https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64 -o /usr/local/bin/cfssljson curl -L https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64 -o /usr/local/bin/cfssl-certinfo chmod +x /usr/local/bin/cfssl* 生成证书 [root@proxy ssl]# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes admin-csr.json | cfssljson -bare admin 2021/04/15 09:07:41 [INFO] generate received request 2021/04/15 09:07:41 [INFO] received CSR 2021/04/15 09:07:41 [INFO] generating key: rsa-2048 2021/04/15 09:07:42 [INFO] encoded CSR 2021/04/15 09:07:42 [INFO] signed certificate with serial number 707063479988721234464365406719482455967000883299 2021/04/15 09:07:42 [WARNING] This certificate lacks a \"hosts\" field. This makes it unsuitable for websites. For more information see the Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org); specifically, section 10.2.3 (\"Information Requirements\"). 查看生成的证书 [root@proxy ssl]# ls admin* admin.csr admin-csr.json admin-key.pem admin.pem 生成kubeconfig授权文件： kubectl config set-cluster kubernetes --certificate-authority=ca.pem --embed-certs=true --server=https://192.168.110.235:6443 #设置用户项中cluster-admin用户证书认证字段 kubectl config set-credentials cluster-admin --client-key=admin-key.pem --client-certificate=admin.pem --embed-certs=true #设置默认上下文 kubectl config set-context kubernetes --cluster=kubernetes --user=cluster-admin #设置当前环境的default kubectl config use-context kubernetes 查看生成的config文件 [root@node01 ssl]# cat /root/.kube/config apiVersion: v1 clusters: - cluster: certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR2akNDQXFhZ0F3SUJBZ0lVQ2xzU2RlK1lnRTNDdkRrd1ZhUkZ5c3dZL0Zrd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pURUxNQWtHQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFXcHBibWN4RURBT0JnTlZCQWNUQjBKbAphV3BwYm1jeEREQUtCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByCmRXSmxjbTVsZEdWek1CNFhEVEl4TURRd05EQXlNRE13TUZvWERUSTJNRFF3TXpBeU1ETXdNRm93WlRFTE1Ba0cKQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFXcHBibWN4RURBT0JnTlZCQWNUQjBKbGFXcHBibWN4RERBSwpCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByZFdKbGNtNWxkR1Z6Ck1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBMVYzSDVCaUorQkJjRXlwT3lxZjYKbDVvMTJLNFZOM3JvcnNXL1M1cjhnNWFic2RyZFdCczhremlybnp0VVVlZ0RLMXY3T3B2U0xyVWMzQWRVS2xOZApWRkgrTnpNS1Q0QmZ6UHAxR0w0YWZjVFdKMHQyRUpKNU9rT3BYMkNDdURkd1hQYWJUY0FlVWw5NURsWmdzdUNkCmx3bXFkQzM0dlZqUzRZVHJQekxBOVJYN2NPSkJWRlI1Y2VYYloyS0s2L0ZHSDY1TkJGRWU5NVF6bDhHYVBncTMKa05pNDBUYzdPYVBKa1VsQXhmbG9hTkI3eHdVRnMzTk4yS0cxeTdjWC9MdTZWN0Y5YnZCNkNkZVhvblJxTTUvdgp4cGo1MjlEMUthc3JmcHpuNFNEMWR6dE5tVkgvMWN6ZHI2bDVqQURFSFZhQWFVb0xIWVRqRU4vUisyL0VJZlBLCjN3SURBUUFCbzJZd1pEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFqQWQKQmdOVkhRNEVGZ1FVTytFWjI0SmNIMnhkTHR5bS9BWFQ5aTg2Sm53d0h3WURWUjBqQkJnd0ZvQVVPK0VaMjRKYwpIMnhkTHR5bS9BWFQ5aTg2Sm53d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFCVTRkOXBkbTNhL1NUeGNBMXJ1CllQazhjNVVmL3VzeUlKWlZmMlRrYnpHa3VQUU96SGdMbXpuajBmampmYjQ2YUZHalBIZGRFbERieWZyRnZ1aGIKSDFwaWVXaUNCVkFUM1FzeDNUMGg4RlR1dXlDbGpsT3hUNVo5VzJWRS96dHRpbGpIb1hqeEkxejJFZHVPSE80TwpSei9EVVZHSENYWndoVDZhR1psRmhhUUtUNjJKQWRqTTVKME9mSVRWNkQyR2J3QlUzQ0RwMEdORlQwaTZqS0hMCkVLb3ladis1Vjd3ckNoRG1oUTg0WkwwRURtNmROTHNXaDZXbDBYaUJGUEd1UFN2YW96cUlYRGlRR0VWM0xrWE4Kb0prVHFkNXhOdnQzRUh6RlB1RytWMVFmdzRMd3J6ZzZZMG4rZ0tXR2xJWkxLN0Q4VmtuY1NNTnFJOUJ4eFU2TApmWG89Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K server: https://192.168.110.235:6443 name: kubernetes contexts: - context: clust","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:6","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#授权创建-kubeconfig-文件并保存在-jenkins-中"},{"categories":["k8s"],"content":"把生成的kubeconfig配置文件存放在jenkins 中 Manage Jenkins -\u003e Managed files -\u003e Add a new Config -\u003e Custom file（自定义文件） 输入 Name： k8s-kubeconfig 把生成的kubeconfig 文件内容 复制到 Content 文本框中 将自签名的 harbor 证书的 key/crt/cert 也同样导入到 Managed files ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:7","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#把生成的kubeconfig配置文件存放在jenkins-中"},{"categories":["k8s"],"content":"把Managed files 中的配置文件 转换成pipeline 语法 直接打开 http://192.168.110.235:30008/pipeline-syntax/就可以了，不需要创建 job 点击片段生成器，Sample Step 下拉选项框中 选择 configFileProvider: Provide Configuration files 在File 下拉选项框中，选中 刚刚创建的 自定义文件 k8s-kubeconfig 在Target 中 输入 admin.kubeconfig (target 表示把 自定义的文件 挂载到 jenkin-slave 镜像的什么路径下，这边定义了文件名称，就相当于把 admin.kubeconfig 文件 放在 jenkin-slave 镜像 的默认工作路径下/home/jenkins/agent/workspace/XX 下面 ) 最后点击 Generate Pipeline Script 生产pipeline 语法 configFileProvider([configFile(fileId: 'ac20bd78-327d-41b1-952f-ad15bc07e4ba', targetLocation: 'admin.kubeconfig')]) { // some block } ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:8","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#把managed-files-中的配置文件-转换成pipeline-语法"},{"categories":["k8s"],"content":"编写标准的deploy.yaml 模板 本项目是 使用Jenkins在Kubernetes中持续部署一个无状态的tomcat pod 应用；涉及到 deployment 控制器 以及采用NodePort 的方式去 访问pod deployment.yaml 和 service.yaml 我把他合并在一个deploy.yaml 文件中 另外deploy.yaml 文件 必须和 项目的代码 在同一个路径下（否则kubectl 无法指定yaml 文件就 无法创建pod） cat \u003e deploy.yaml \u003c\u003c EOF apiVersion: apps/v1 kind: Deployment metadata: name: tomcat-java-demo spec: replicas: REPLICAS selector: matchLabels: project: www app: tomcat-java-demo template: metadata: labels: project: www app: tomcat-java-demo spec: imagePullSecrets: - name: SECRET_NAME containers: - image: IMAGE_NAME name: tomcat-java-demo resources: requests: cpu: 0.5 memory: 500Mi limits: cpu: 1 memory: 1Gi livenessProbe: httpGet: path: / port: 8080 initialDelaySeconds: 50 periodSeconds: 10 readinessProbe: httpGet: path: / port: 8080 initialDelaySeconds: 50 periodSeconds: 10 --- apiVersion: v1 kind: Service metadata: name: tomcat-java-demo spec: selector: project: www app: tomcat-java-demo type: NodePort ports: - protocol: TCP port: 80 targetPort: 8080 EOF ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:9","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#编写标准的deployyaml-模板"},{"categories":["k8s"],"content":"在K8S 集群中创建sercret 用于连接Harbor仓库（用于K8S创建POD时 拉取镜像） 备注： 应用启动过程中可能需要一些敏感信息，比如访问数据库的用户名密码或者秘钥。将这些信息直接保存在容器镜像中显然不妥，Kubernetes 提供的解决方案是 Secret。 Secret 会以密文的方式存储数据，避免了直接在配置文件中保存敏感信息。Secret 会以 Volume 的形式被 mount 到 Pod，容器可通过文件的方式使用 Secret 中的敏感数据；此外，容器也可以环境变量的方式使用这些数据。 找一台登陆过的Harbor 的 node 的节点，查看 cat ~/.docker/config.json 问价里的内容 [root@node01 ssl]# cat ~/.docker/config.json { \"auths\": { \"192.168.110.239\": { \"auth\": \"YWRtaW46SGFyYm9yMTIzNDU=\" } }, \"HttpHeaders\": { \"User-Agent\": \"Docker-Client/19.03.9 (linux)\" } } 使用 base64 对 ~/.docker/config.json 文件 进行编码 [root@node01 ssl]# cat ~/.docker/config.json | base64 |tr -d \"\\n\" ewoJImF1dGhzIjogewoJCSIxOTIuMTY4LjExMC4yMzkiOiB7CgkJCSJhdXRoIjogIllXUnRhVzQ2U0dGeVltOXlNVEl6TkRVPSIKCQl9Cgl9LAoJIkh0dHBIZWFkZXJzIjogewoJCSJVc2VyLUFnZW50IjogIkRvY2tlci1DbGllbnQvMTkuMDMuOSAobGludXgpIgoJfQp9 创建secret yaml文件 Tips：注意base64 的结果要写成一行 cat \u003e registry-pull-secret.yaml \u003c\u003c EOF apiVersion: v1 kind: Secret metadata: name: secret-dockercfg type: kubernetes.io/dockerconfigjson data: .dockerconfigjson: | ewoJImF1dGhzIjogewoJCSIxOTIuMTY4LjExMC4yMzkiOiB7CgkJCSJhdXRoIjogIllXUnRhVzQ2U0dGeVltOXlNVEl6TkRVPSIKCQl9Cgl9LAoJIkh0dHBIZWFkZXJzIjogewoJCSJVc2VyLUFnZW50IjogIkRvY2tlci1DbGllbnQvMTkuMDMuOSAobGludXgpIgoJfQp9 EOF 在 指定的 ns 命名空间下 执行 kubectl apply 创建 Secret： for i in {prod,dev};do kubectl create namespace $i;done for i in {prod,dev};do kubectl apply -f registry-pull-secret.yaml -n $i;done 查看创建的 secret [root@node01 ssl]# for i in {prod,dev};do kubectl get secret -n $i;done NAME TYPE DATA AGE default-token-nhtmq kubernetes.io/service-account-token 3 51m secret-dockercfg kubernetes.io/dockerconfigjson 1 51m NAME TYPE DATA AGE default-token-p44zj kubernetes.io/service-account-token 3 51m secret-dockercfg kubernetes.io/dockerconfigjson 1 51m ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:10","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#在k8s-集群中创建sercret-用于连接harbor仓库用于k8s创建pod时-拉取镜像"},{"categories":["k8s"],"content":"定义环境变量，使用参数化构建，修改deploy.yaml文件 需要提前定义好的环境变量： //定义harbor的地址 def registry = \"192.168.110.239\" // 项目，BUILD_NUMBER jenkins 内置变量，jenkins 构建编号 def project = \"java\" def app_name = \"tomcat-java-demo\" def image_name = \"${registry}/${project}/${app_name}:${BUILD_NUMBER}\" def git_address = \"http://192.168.110.238/root/tomcat-java-demo.git\" // 认证 //k8s 连接harbor 证书 def secret_name = \"registry-pull-secret\" //jenkins中定义docker连接harbor的用户密码凭证，全局凭据里面的 ID def docker_registry_auth = \"5079d562-6f41-455a-9f7d-5a7bd9a17a44\" //jenkins中定义git连接gitlab的用户密码凭证，全局凭据里面的 ID def git_auth = \"0ddfe45b-a247-492c-a71b-2ceed7704663\" //jenkins中Config File Provider插件 定义的kubeconfig 文件内容 def k8s_auth = \"ac20bd78-327d-41b1-952f-ad15bc07e4ba\" 参数化构建过程中，需要交互的内容： 发布分支(prod,dev) 副本数（1,3,5,7） 命名空间（prod,dev） 一个标准的deploy.yaml模板文件，需要把修改的内容： #修改deploy.yaml 中镜像名称 sed -i 's#IMAGE_NAME#${image_name}#' deploy.yaml #修改deploy.yaml 中k8s连接harbor连接的secret sed -i 's#SECRET_NAME#${secret_name}#' deploy.yaml #修改deploy.yaml 中副本的数量 sed -i 's#REPLICAS#${ReplicaCount}#' deploy.yaml #指定pod 创建在哪个命名空间下 kubectl apply -f deploy.yaml -n ${Namespace} --kubeconfig=admin.kubeconfig pipeline中引用示例： //参数化构建 parameters { gitParameter branch: '', branchFilter: '.*', defaultValue: 'master', description: '选择发布的分支', name: 'Branch', quickFilterEnabled: false, selectedValue: 'NONE', sortMode: 'NONE', tagFilter: '*', type: 'PT_BRANCH' choice (choices: ['1', '3', '5', '7'], description: '副本数', name: 'ReplicaCount') choice (choices: ['prod','dev'], description: '命名空间', name: 'Namespace') } //部署pod需要修改的内容 sh \"\"\" sed -i 's#IMAGE_NAME#${image_name}#' deploy.yaml sed -i 's#SECRET_NAME#${secret_name}#' deploy.yaml sed -i 's#REPLICAS#${ReplicaCount}#' deploy.yaml kubectl apply -f deploy.yaml -n ${Namespace} --kubeconfig=admin.kubeconfig \"\"\" ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:6:11","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#定义环境变量使用参数化构建修改deployyaml文件"},{"categories":["k8s"],"content":"完整的pipeline 流水线 脚本 // 公共 def registry = \"192.168.110.239\" // 项目，BUILD_NUMBER jenkins 内置变量，jenkins 构建编号 def project = \"java\" def app_name = \"tomcat-java-demo\" def image_name = \"${registry}/${project}/${app_name}:${BUILD_NUMBER}\" def git_address = \"http://192.168.110.238/root/tomcat-java-demo.git\" // 认证 //k8s 连接harbor 证书 def secret_name = \"registry-pull-secret\" //jenkins中定义docker连接harbor的用户密码凭证，全局凭据里面的 ID def docker_registry_auth = \"5079d562-6f41-455a-9f7d-5a7bd9a17a44\" //jenkins中定义git连接gitlab的用户密码凭证，全局凭据里面的 ID def git_auth = \"0ddfe45b-a247-492c-a71b-2ceed7704663\" //jenkins中Config File Provider插件 定义的kubeconfig 文件内容 def k8s_auth = \"ac20bd78-327d-41b1-952f-ad15bc07e4ba\" pipeline { agent { kubernetes { yaml ''' apiVersion: v1 kind: Pod metadata: name: jenkins-slave spec: // 我的 jenkins-slave 不是用 root 用户运行的，查过 root 的 uid 在 docker 容器内部是 0，所以在执行 k8s yml 的时候选择指定 uid=0 的 root 用户执行命令行工具，否则会报权限错误 securityContext: runAsUser: 0 runAsGroup: 0 containers: - name: jnlp image: ${registry}/library/jenkins-slave:4.7.1-alpine imagePullPolicy: Always volumeMounts: - name: docker-cmd mountPath: /usr/bin/docker - name: docker-sock mountPath: /var/run/docker.sock - name: maven-cache mountPath: /root/.m2 securityContext: allowPrivilegeEscalation: false volumes: - name: docker-cmd hostPath: path: /usr/bin/docker - name: docker-sock hostPath: path: /var/run/docker.sock - name: maven-cache persistentVolumeClaim: claimName: mavencache ''' } } parameters { gitParameter branch: '', branchFilter: '.*', defaultValue: 'master', description: '选择发布的分支', name: 'Branch', quickFilterEnabled: false, selectedValue: 'NONE', sortMode: 'NONE', tagFilter: '*', type: 'PT_BRANCH' choice (choices: ['1', '3', '5', '7'], description: '副本数', name: 'ReplicaCount') choice (choices: ['prod','dev'], description: '命名空间', name: 'Namespace') } stages { stage('拉取代码'){ steps { checkout([$class: 'GitSCM', branches: [[name: \"${params.Branch}\"]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: \"${git_auth}\", url: \"${git_address}\"]] ]) } } stage('代码编译') { steps { sh 'mvn clean package -Dmaven.skip.test=true' sh 'ls -l target/' sh 'pwd' } } stage('构建镜像并推送仓库') { steps { withCredentials([usernamePassword(credentialsId: \"${docker_registry_auth}\", passwordVariable: 'password', usernameVariable: 'username')]) { sh \"\"\" docker build -t ${image_name} . docker login -u ${username} -p '${password}' ${registry} docker push ${image_name} \"\"\" } } } stage('部署到K8S平台'){ steps { configFileProvider([configFile(fileId: \"${k8s_auth}\", targetLocation: \"admin.kubeconfig\")]){ sh \"\"\" sed -i 's#IMAGE_NAME#${image_name}#' deploy.yaml sed -i 's#SECRET_NAME#${secret_name}#' deploy.yaml sed -i 's#REPLICAS#${ReplicaCount}#' deploy.yaml kubectl apply -f deploy.yaml -n ${Namespace} --kubeconfig=admin.kubeconfig sleep 120 kubectl get pods,svc -n ${Namespace} --kubeconfig=admin.kubeconfig \"\"\" } } } } } [root@node01 docker-inbound-agent]# kubectl get pod,svc -n prod NAME READY STATUS RESTARTS AGE pod/tomcat-java-demo-5dfd566b49-cbdlm 1/1 Running 0 4m35s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/tomcat-java-demo NodePort 10.0.0.222 \u003cnone\u003e 80:32088/TCP 21h 部署成功，查看 tomcat 应用 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:7:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#完整的pipeline-流水线-脚本"},{"categories":["k8s"],"content":"参考 摘抄至，略有删改。https://github.com/fxkjnj/kubernetes/tree/main/jenkins-for_kubernetes/jenkins_deploy_kubernetes https://blog.51cto.com/u_14143894/2437186 ","date":"2021-04-12","objectID":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/:0:0","series":null,"tags":["k8s"],"title":"【k8s】部署 jenkins 并部署 tomcat 服务示例","uri":"/k8s%E7%8E%AF%E5%A2%83-jenkins%E9%83%A8%E7%BD%B2/#参考"},{"categories":["网络"],"content":"云 cdn 汇总介绍","date":"2021-04-12","objectID":"/%E4%BA%91cdn%E6%B1%87%E6%80%BB%E4%BB%8B%E7%BB%8D/","series":null,"tags":["CDN"],"title":"云 cdn 汇总介绍","uri":"/%E4%BA%91cdn%E6%B1%87%E6%80%BB%E4%BB%8B%E7%BB%8D/"},{"categories":["网络"],"content":"#1. Load Balancer 一般有以下实现方案 一个 Anycast IP（比如 Google LB），GCP 的 cdn 是不直接提供对外连接地址，而是由 lb 的 ip 提供。 一个普通 IP（比如 Ucloud LB） 一个 CNAME 分区解析（比如 AWS ELB），AWS 的 cdn 是直接 提供了对外的 CNAME 地址。 #2. dns 解析知识点 一个二级域名只能同时存在一个 A 记录，不能出现 A 和 A，A 和 CNAME 记录同时存在（假设能存在，也只会走 A 记录），不过你是哪个地区解析，这是最高优先级。 #3. 问题 ##问题一：GCP cdn 没有提供 CNAME fqdn，无法 CNAME？ 我们在 Router 53 上面做 cdn 相关的域名 CNAME 的时候，因为之前用的 AWS，所以 CNAM 方式要保留，另外只有 CNAME 才能多个同时存在存在按不同地理位置进行解析。 示例： www CNAME aws.cloudfront.cname.fqdn1 香港 www CNAME aws.cloudfront.cname.fqdn2 美国 www CNAME eggcpcdn.test1.com 英国 解决办法： aws 那边在 route53 上建一条 A 记录（比如eggcpcdn.test1.com），指向 Cloud LB IP，然后把这个 hk 域名当做cname添加都route53中 ##问题二：GCP 的 lb 无法自定义 TCP LB 的端口？ 场景：LB 后面是 nginx，nginx 负载 80、443 和其他 tcp 端口，采用了 umanaged instance group（非托管实例）。 1.如果要同一组 umnaged instance group，服务多个LB，要 LB http(s) 模式的 balancing mode 兼容（这里要用 Rate mode）才可以。然后在 TCP model 那里选择 Single region only，HTTP(s)则可由继续用 Multiple regions 2.要么用多个不同的 vm 创建不同的 ig，也就是多个 nginx 在不同的 instace group，lb 的时候也就影响了，如果是一个 ig 后面多个 nginx vm，那么就只能通过一个 ig 负载多个端口的方式去进行 1 方法的处理。 3.在 1 那里先创建好 HTTPS 的 lb 并且选择了 UTILIZATION mode 而不是 rate mode，那么你创建 TCP LB的时候，选择 Multiple regions 的话，TCP 只能用固定端口，而不能自定义 。 ","date":"2021-04-12","objectID":"/%E4%BA%91cdn%E6%B1%87%E6%80%BB%E4%BB%8B%E7%BB%8D/:0:0","series":null,"tags":["CDN"],"title":"云 cdn 汇总介绍","uri":"/%E4%BA%91cdn%E6%B1%87%E6%80%BB%E4%BB%8B%E7%BB%8D/#"},{"categories":["k8s"],"content":"【k8s】Helm部署skywalking","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/"},{"categories":["k8s"],"content":"1. 前言 本实验文档基于单机 es7 作为 skywalking 的后端存储，使用 nfs 动态卷 storageclass，es 没有使用账号密码。 ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:0:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#1-前言"},{"categories":["k8s"],"content":"2. 环境 k8s 集群：v1.20.4 版本 k8s-master1 192.168.110.235 k8s-node1 192.168.110.236 k8s-node2 192.168.110.237 nfs 192.168.110.239 elasticsearch：7.12.0 skywalking： oap-server: 无状态服务后端，主要负责处理核心逻辑，可以简单理解为一个标准 java web 项目。 skywalking-ui: UI 前端，通过 graphql 连接 oap-server 提供用户查询等 UI 展示。 agent: 各种语言实现的 agent 负责抓取应用运行数据并上报给 oap-server，核心的指标上报来源。 DB: 各种数据库，负责存储 Skywalking 的指标数据，生产环境推荐 ES、TiDB、MySQL。 #3. nfs 安装 参考：K8s环境 nfs 动态存储卷部署 ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:0:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#2-环境"},{"categories":["k8s"],"content":"4. elasticsearch 安装 ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:0:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#4-elasticsearch-安装"},{"categories":["k8s"],"content":"4.1 安装 es 7.12.0 cat \u003e elasticsearch-single.yaml \u003c\u003c EOF apiVersion: apps/v1 kind: Deployment metadata: name: elasticsearch-single namespace: efk labels: k8s-app: elasticsearch-single spec: replicas: 1 selector: matchLabels: k8s-app: elasticsearch-single template: metadata: labels: k8s-app: elasticsearch-single spec: containers: - image: elasticsearch:7.12.0 name: elasticsearch-single resources: limits: cpu: 2 memory: 3Gi requests: cpu: 0.5 memory: 500Mi env: - name: \"discovery.type\" value: \"single-node\" - name: ES_JAVA_OPTS value: \"-Xms512m -Xmx2g\" ports: - containerPort: 9200 name: db protocol: TCP volumeMounts: - name: elasticsearch-data mountPath: /usr/share/elasticsearch/data volumes: - name: elasticsearch-data persistentVolumeClaim: claimName: es-pvc --- apiVersion: v1 kind: PersistentVolumeClaim metadata: name: es-pvc namespace: efk spec: #指定动态PV 名称 storageClassName: \"elastic-nfs-client\" accessModes: - ReadWriteMany resources: requests: storage: 10Gi --- apiVersion: v1 kind: Service metadata: name: elasticsearch-single namespace: efk spec: ports: - port: 9200 protocol: TCP targetPort: 9200 selector: k8s-app: elasticsearch-single EOF kubectl apply -f elasticsearch-single.yaml ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:1:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#41-安装-es-7120"},{"categories":["k8s"],"content":"5. 安装 skywalking ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:0:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#5-安装-skywalking"},{"categories":["k8s"],"content":"5.1 安装 helm curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash ##5.2 初始化 skywalking 的 charts 配置 # clone helm 仓库 git clone https://github.com/apache/skywalking-kubernetes cd skywalking-kubernetes/chart # 即使使用外部 ES 也要添加这个 repo，否则会导致依赖错误 helm repo add elastic https://helm.elastic.co helm dep up skywalking # 创建 skywalking 的 namespace kubectl create namespace skywalking ##5.3 配置 skywalking 的 vaules 配置参数： 初始化完成后需要自行调整配置文件，配置 oap-server 使用外部 ES，当然你也可以使用 values 自带的 es 的配置示例，这里不做过多介绍 cat \u003e skywalking/values-my-es-01.yaml \u003c\u003cEOF oap: image: tag: 8.4.0-es7 storageType: elasticsearch7 ui: image: tag: 8.4.0 service: type: NodePort externalPort: 80 internalPort: 8080 nodePort: 30008 elasticsearch: enabled: false config: host: elasticsearch-single.efk port: http: 9200 #user: \"\" # [optional] #password: \"xxx\" # [optional] EOF ##5.4 helm 安装 skywalking 8.4.0 helm install skywalking skywalking -n skywalking -f ./skywalking/values-my-es-01.yaml ###5.4.1 卸载方式： helm uninstall skywalking -n skywalking ###5.4.2 持续查看 pod 安装进度 kubectl get pod -n skywalking -w ###5.4.3 对外暴露 skywalking 端口，临时，但是本篇我用了 NodePort 的方法开放了端口，生产中也可以使用 ingress 的方式开放 export POD_NAME=$(kubectl get pods --namespace skywalking -l \"app=skywalking,release=skywalking,component=ui\" -o jsonpath=\"{.items[0].metadata.name}\") kubectl port-forward $POD_NAME 8080:8080 --namespace skywalking ###5.4.4 查看 skywalking 的访问：其实就是 k8s master/node ip + nodeport export NODE_PORT=$(kubectl get --namespace skywalking -o jsonpath=\"{.spec.ports[0].nodePort}\" services skywalking-ui) export NODE_IP=$(kubectl get nodes --namespace skywalking -o jsonpath=\"{.items[0].status.addresses[0].address}\") echo http://$NODE_IP:$NODE_PORT ##5.5 运行状态检查 [root@node01 chart]# kubectl get pod,svc -n skywalking NAME READY STATUS RESTARTS AGE pod/skywalking-es-init-22g88 0/1 Completed 0 115s pod/skywalking-oap-687f98bd9b-p5d69 1/1 Running 0 114s pod/skywalking-oap-687f98bd9b-wxffb 1/1 Running 0 114s pod/skywalking-ui-6fd5544496-cmmf9 1/1 Running 0 115s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/skywalking-oap ClusterIP 10.0.0.88 \u003cnone\u003e 12800/TCP,11800/TCP 115s service/skywalking-ui NodePort 10.0.0.87 \u003cnone\u003e 80:30553/TCP 115s ##5.6 结果： es 多了一堆 index skywalking 访问状态 ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:1:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#51-安装-helm"},{"categories":["k8s"],"content":"6. 部署一个 java 微服务示例，并接入 skywalking 参考：K8s java 微服务部署示例 #7. 参考： https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==\u0026mid=2247495145\u0026idx=1\u0026sn=87c5ff37f836d53c98304a88870d2e6d\u0026chksm=eac6ccc0ddb145d6192df1ec738b885f979a868f96dbd6116eb05953989e64a67713d78f039e\u0026mpshare=1\u0026scene=1\u0026srcid=04098L9gzve10EptJBFeLVHq\u0026sharer_sharetime=1617928300892\u0026sharer_shareid=09464b4a0389b967659ba78076a1ef58#rd ","date":"2021-04-11","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/:0:0","series":null,"tags":["k8s","skywalking"],"title":"【k8s】Helm 部署 skywalking","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E9%83%A8%E7%BD%B2skywalking/#6-部署一个-java-微服务示例并接入-skywalking"},{"categories":["k8s"],"content":"【k8s】允许 master 节点运行 pod","date":"2021-04-10","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/","series":null,"tags":["k8s"],"title":"【k8s】允许 master 节点运行 pod","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/"},{"categories":["k8s"],"content":"1. 查看 所有 node 节点的调度 [root@node01 efk]# kubectl describe node|grep -E \"Name:|Taints:\" Name: k8s-master1 Taints: node-role.kubernetes.io/master:NoSchedule Name: k8s-node1 Taints: \u003cnone\u003e Name: k8s-node2 Taints: \u003cnone\u003e ","date":"2021-04-10","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/:0:1","series":null,"tags":["k8s"],"title":"【k8s】允许 master 节点运行 pod","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/#1-查看-所有-node-节点的调度"},{"categories":["k8s"],"content":"2. 去除 k8s-master1 节点不允许配置的 label kubectl taint node k8s-master1 node-role.kubernetes.io/master- ","date":"2021-04-10","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/:0:2","series":null,"tags":["k8s"],"title":"【k8s】允许 master 节点运行 pod","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/#2-去除-k8s-master1-节点不允许配置的-label"},{"categories":["k8s"],"content":"3. 所有节点不允许调度的 label 去除 kubectl taint nodes --all node-role.kubernetes.io/master- ###4. 重新设置 master 节点不允许调度 pod kubectl taint node k8s-master1 node-role.kubernetes.io/master=:NoSchedule 污点可选参数 NoSchedule: 一定不能被调度 PreferNoSchedule: 尽量不要调度 NoExecute: 不仅不会调度, 还会驱逐Node上已有的Pod ","date":"2021-04-10","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/:0:3","series":null,"tags":["k8s"],"title":"【k8s】允许 master 节点运行 pod","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8Cpod/#3-所有节点不允许调度的-label-去除"},{"categories":["k8s"],"content":"【k8s】pv 处在 Terminating 状态","date":"2021-04-09","objectID":"/k8s%E7%8E%AF%E5%A2%83-pv%E4%B8%80%E7%9B%B4%E5%A4%84%E5%9C%A8terminating%E7%8A%B6%E6%80%81/","series":null,"tags":["k8s"],"title":"【k8s】pv 处在 Terminating 状态","uri":"/k8s%E7%8E%AF%E5%A2%83-pv%E4%B8%80%E7%9B%B4%E5%A4%84%E5%9C%A8terminating%E7%8A%B6%E6%80%81/"},{"categories":["k8s"],"content":"kubectl delete pv 之后，pv 一直处在 Terminating 状态 问题现状 [root@node01 efk]# kubectl get pv -n efk|grep elastic pvc-10cfbb1c-19fd-4b93-bddc-416c5ad1c977 50Gi RWO Retain Terminating efk/elasticsearch-data-elasticsearch-data-1 elastic-nfs-client 14h pvc-7164e842-5e6c-4a94-89fe-0e649713a6b7 50Gi RWO Retain Terminating efk/elasticsearch-data-elasticsearch-data-0 elastic-nfs-client 14h pvc-8ea92bf8-945c-46ed-8073-a5f2971f52fe 5Gi RWO Retain Terminating efk/elasticsearch-master-elasticsearch-master-1 elastic-nfs-client 14h pvc-c9527589-9282-40b3-b0a6-a168412528df 5Gi RWO Retain Terminating efk/elasticsearch-master-elasticsearch-master-0 elastic-nfs-client 14h 解决办法： 办法一：直接到etcd中删除 将所有的etcd中的key值取到一个keys.yam里面，便于查询 ETCDCTL_API=3 /opt/etcd/bin/etcdctl --cacert=/opt/etcd/ssl/ca.pem --cert=/opt/etcd/ssl/server.pem --key=/opt/etcd/ssl/server-key.pem --endpoints=https://192.168.110.235:2379,https://192.168.110.236:2379,https://192.168.110.237:2379 get \"\" --from-key \u003e keys.yaml vim keys.yaml 找到pvc-10cfbb1c-19fd-4b93-bddc-416c5ad1c977，目标 pv 找到以 /registry/ 开头 pvc-10cfbb1c-19fd-4b93-bddc-416c5ad1c977结尾的一串记录 cat keys.yaml |grep pvc-10cfbb1c-19fd-4b93-bddc-416c5ad1c977|grep -a registry 删除记录 ETCDCTL_API=3 /opt/etcd/bin/etcdctl --cacert=/opt/etcd/ssl/ca.pem --cert=/opt/etcd/ssl/server.pem --key=/opt/etcd/ssl/server-key.pem --endpoints=https://192.168.110.235:2379,https://192.168.110.236:2379,https://192.168.110.237:2379 del /registry/persistentvolumes/pvc-10cfbb1c-19fd-4b93-bddc-416c5ad1c977 办法二：使用 kubectl patch kubectl patch pv pvc-7164e842-5e6c-4a94-89fe-0e649713a6b7 -p '{\"metadata\":{\"finalizers\":null}}' kubectl patch pv pvc-8ea92bf8-945c-46ed-8073-a5f2971f52fe -p '{\"metadata\":{\"finalizers\":null}}' kubectl patch pv pvc-c9527589-9282-40b3-b0a6-a168412528df -p '{\"metadata\":{\"finalizers\":null}}' ","date":"2021-04-09","objectID":"/k8s%E7%8E%AF%E5%A2%83-pv%E4%B8%80%E7%9B%B4%E5%A4%84%E5%9C%A8terminating%E7%8A%B6%E6%80%81/:0:0","series":null,"tags":["k8s"],"title":"【k8s】pv 处在 Terminating 状态","uri":"/k8s%E7%8E%AF%E5%A2%83-pv%E4%B8%80%E7%9B%B4%E5%A4%84%E5%9C%A8terminating%E7%8A%B6%E6%80%81/#kubectl-delete-pv-之后pv-一直处在-terminating-状态"},{"categories":["k8s"],"content":"【k8s】Helm 安装 mysql 多版本","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/"},{"categories":["k8s"],"content":"#1. helm 下载 mysql charts 模板 ##1.1 查看有哪些 helm 版本 helm search repo mysql [root@node01 helm]# helm search repo mysql WARNING: Kubernetes configuration file is group-readable. This is insecure. Location: /root/.kube/config WARNING: Kubernetes configuration file is world-readable. This is insecure. Location: /root/.kube/config NAME CHART VERSION APP VERSION DESCRIPTION aliyun/mysql 0.3.5 Fast, reliable, scalable, and easy to use open-... stable/mysql 1.6.9 5.7.30 DEPRECATED - Fast, reliable, scalable, and easy... stable/mysqldump 2.6.2 2.4.1 DEPRECATED! - A Helm chart to help backup MySQL... stable/prometheus-mysql-exporter 0.7.1 v0.11.0 DEPRECATED A Helm chart for prometheus mysql ex... aliyun/percona 0.3.0 free, fully compatible, enhanced, open source d... aliyun/percona-xtradb-cluster 0.0.2 5.7.19 free, fully compatible, enhanced, open source d... stable/percona 1.2.3 5.7.26 DEPRECATED - free, fully compatible, enhanced, ... stable/percona-xtradb-cluster 1.0.8 5.7.19 DEPRECATED - free, fully compatible, enhanced, ... stable/phpmyadmin 4.3.5 5.0.1 DEPRECATED phpMyAdmin is an mysql administratio... aliyun/gcloud-sqlproxy 0.2.3 Google Cloud SQL Proxy aliyun/mariadb 2.1.6 10.1.31 Fast, reliable, scalable, and easy to use open-... stable/gcloud-sqlproxy 0.6.1 1.11 DEPRECATED Google Cloud SQL Proxy stable/mariadb 7.3.14 10.3.22 DEPRECATED Fast, reliable, scalable, and easy t... ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:0:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#"},{"categories":["k8s"],"content":"1.2 helm 下载： helm pull repo/server，旧版本用helm fetch repo/server # 下载后解压为 mysql-5.6 的目录 helm pull stable/mysql --untar mv mysql mysql-5.6 # 下载后不解压 helm pull stable/mysql #会下载mysql-1.6.9.tgz # 下载 chart version 为1.6.0 的 stable/mysql helm pull stable/mysql --version 1.6.0 #会下载mysql-1.6.0.tgz #2. 更改版本 **Tips：**由 1.1 可知，我们下载的 stable/mysql 是 mysql5.7 的版本，以下方式可以不记住 charts 版本号就可以修改 mysql 版本 ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:1:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#12-helm-下载"},{"categories":["k8s"],"content":"2.1 修改 Chart.yaml 修改 mysql 版本号appVersion 由原来的 5.7.30 改为 5.6.50和 chart 版本号version vi mysql-5.6/Chart.yaml apiVersion: v1 appVersion: 5.6.50 #更改为 mysql 你要的版本号 deprecated: true description: DEPRECATED - Fast, reliable, scalable, and easy to use open-source relational database system. home: https://www.mysql.com/ icon: https://www.mysql.com/common/logos/logo-mysql-170x115.png keywords: - mysql - database - sql name: mysql sources: - https://github.com/kubernetes/charts - https://github.com/docker-library/mysql version: 5.6.50 #这里是 mysql 的 chart 版本号，随意修改不重复即可 ##2.2 修改mysql 的配置参数 vi mysql-5.6/values.yaml，以下是我净化后的配置 image: \"mysql\" imageTag: \"5.6.50\" #这里要修改为 mysql 你需要的版本，与上面修改的版本保持一致 strategy: type: Recreate busybox: image: \"busybox\" tag: \"1.32\" testFramework: enabled: true image: \"bats/bats\" tag: \"1.2.1\" imagePullPolicy: IfNotPresent securityContext: {} mysqlRootPassword: mysql123456 #主动设置 root 密码，要大于 10 个字符串 mysqlUser: test # 设置一个初始账号哦 mysqlPassword: test123456 #👆🏻那个账号的密码，要大于 10 个字符串 imagePullPolicy: IfNotPresent args: [] extraVolumes: | extraVolumeMounts: | extraInitContainers: | nodeSelector: {} affinity: {} tolerations: [] livenessProbe: initialDelaySeconds: 30 periodSeconds: 10 timeoutSeconds: 5 successThreshold: 1 failureThreshold: 3 readinessProbe: initialDelaySeconds: 5 periodSeconds: 10 timeoutSeconds: 1 successThreshold: 1 failureThreshold: 3 persistence: enabled: true storageClass: \"managed-nfs-storage\" #我这里设置为 nfs 的动态 sc，会自动创建存储，可参考 nfs 那章节 accessMode: ReadWriteOnce size: 8Gi annotations: {} securityContext: enabled: false runAsUser: 999 fsGroup: 999 resources: requests: memory: 256Mi cpu: 100m configurationFilesPath: /etc/mysql/conf.d/ configurationFiles: {} initializationFiles: {} mysqlx: port: enabled: false metrics: enabled: false image: prom/mysqld-exporter imageTag: v0.10.0 imagePullPolicy: IfNotPresent resources: {} annotations: {} livenessProbe: initialDelaySeconds: 15 timeoutSeconds: 5 readinessProbe: initialDelaySeconds: 5 timeoutSeconds: 1 flags: [] serviceMonitor: enabled: false additionalLabels: {} service: annotations: {} type: NodePort # 我这里的 service 设置为 nodeport 模式，可以用 master或者 node ip+下面的 nodePort 32005 进行访问 nodePort: 32005 #宿主机访问的端口 port: 3306 serviceAccount: create: false ssl: enabled: false secret: mysql-ssl-certs certificates: deploymentAnnotations: {} podAnnotations: {} podLabels: {} initContainer: resources: requests: memory: 10Mi cpu: 10m ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:2:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#21-修改-chartyaml"},{"categories":["k8s"],"content":"3. 安装 helm package mysql-5.6 helm install mydb mysql-5.6.50.tgz 行动结果： [root@node01 helm]# helm list WARNING: Kubernetes configuration file is group-readable. This is insecure. Location: /root/.kube/config WARNING: Kubernetes configuration file is world-readable. This is insecure. Location: /root/.kube/config NAME NAMESPACE REVISION UPDATED STATUS CHART APP VERSION mysql56 default 1 2021-04-06 21:26:26.6483062 +0800 CST deployed mysql-5.6.50 5.6.50 [root@node01 helm]# kubectl get pod NAME READY STATUS RESTARTS AGE mysql56-6c856cff5b-xxrz6 1/1 Running 0 94s nfs-client-provisioner-cf84d684-brlfk 1/1 Running 11 2d7h ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:0:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#3-安装"},{"categories":["k8s"],"content":"4. 查看默认参数和变量 [root@node01 helm]# helm status mysql56 WARNING: Kubernetes configuration file is group-readable. This is insecure. Location: /root/.kube/config WARNING: Kubernetes configuration file is world-readable. This is insecure. Location: /root/.kube/config NAME: mysql56 LAST DEPLOYED: Tue Apr 6 21:26:26 2021 NAMESPACE: default STATUS: deployed REVISION: 1 NOTES: MySQL can be accessed via port 3306 on the following DNS name from within your cluster: mysql56.default.svc.cluster.local To get your root password run: MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default mysql56 -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo) To connect to your database: 1. Run an Ubuntu pod that you can use as a client: kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il 2. Install the mysql client: $ apt-get update \u0026\u0026 apt-get install mysql-client -y 3. Connect using the mysql cli, then provide your password: $ mysql -h mysql56 -p To connect to your database directly from outside the K8s cluster: MYSQL_HOST=$(kubectl get nodes --namespace default -o jsonpath='{.items[0].status.addresses[0].address}') MYSQL_PORT=$(kubectl get svc --namespace default mysql56 -o jsonpath='{.spec.ports[0].nodePort}') mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD} ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:0:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#4-查看默认参数和变量"},{"categories":["k8s"],"content":"5. 登录mysql 如果你要在命令登录，而不是用上面例子的 docker 容器远程登录，记得在宿主机安装mysql-client哦 #查看密码 MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default mysql56 -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo) #查看 mysql host MYSQL_HOST=$(kubectl get nodes --namespace default -o jsonpath='{.items[0].status.addresses[0].address}') #查看 mysql 端口 MYSQL_PORT=$(kubectl get svc --namespace default mysql56 -o jsonpath='{.spec.ports[0].nodePort}') #命令行登录 mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD} 行动结果： [root@node01 helm]# #查看密码 [root@node01 helm]# MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default mysql56 -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo) #查看 mysql host MYSQL_HOST=$(kubectl get nodes --namespace default -o jsonpath='{.items[0].status.addresses[0].address}') #查看 mysql 端口 MYSQL_PORT=$(kubectl get svc --namespace default mysql56 -o jsonpath='{.spec.ports[0].nodePort}') #命令行登录 mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD}[root@node01 helm]# #查看 mysql host [root@node01 helm]# MYSQL_HOST=$(kubectl get nodes --namespace default -o jsonpath='{.items[0].status.addresses[0].address}') [root@node01 helm]# #查看 mysql 端口 [root@node01 helm]# MYSQL_PORT=$(kubectl get svc --namespace default mysql56 -o jsonpath='{.spec.ports[0].nodePort}') [root@node01 helm]# #命令行登录 [root@node01 helm]# mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD} Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MySQL connection id is 32 Server version: 5.6.50 MySQL Community Server (GPL) Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. MySQL [(none)]\u003e 使用 test 账号登录测试： [root@node01 hemysql -utest -h192.168.110.236 -P32005 -ptest123456Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MySQL connection id is 125 Server version: 5.6.50 MySQL Community Server (GPL) Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. MySQL [(none)]\u003e ","date":"2021-04-06","objectID":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/:0:0","series":null,"tags":["helm","k8s"],"title":"【k8s】Helm 安装 mysql 多版本","uri":"/k8s%E7%8E%AF%E5%A2%83-helm%E5%AE%89%E8%A3%85mysql%E5%A4%9A%E7%89%88%E6%9C%AC/#5-登录mysql"},{"categories":["k8s"],"content":"【k8s】java 微服务部署示例","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/"},{"categories":["k8s"],"content":"1. 环境 k8s：1.20 k8s-master1 192.168.110.235 8s-node1 192.168.110.236 k8s-node2 192.168.110.237 harbor,nfs 192.168.110.239 java：1.8 ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:0:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#1-环境"},{"categories":["k8s"],"content":"2. java 微服务部署 ##2.1 安装 java jdk1.8 yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel maven ##2.2 下载代码示例： ###版本介绍： dev3 分支会 mysql 连接错误，暂时无法解决请抛弃 dev4 分支是加了 pinpoint APM 服务 dev4-skywalking 分支如所见 git clone git@github.com:ZhaoUncle/simple-microservice.git #切换dev4-skywalking 分支 cd simple-microservice git checkout remotes/origin/dev4-skywalking ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:0:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#2-java-微服务部署"},{"categories":["k8s"],"content":"部署须知 导入db目录下数据库文件到自己的MySQL服务器 默认的 db 文件，没有 use DATABASES；所以会导致报错，参考 2.4 做法。 k8s/docker_build.sh 这个是部署脚本，可以参考2.6来使用，用来推送 build 好的 images，然后启动 deployment。 修改配置环境（xxx-service/src/main/resources/application.yml，active值决定启用环境配置文件） 默认使用 fat 文件调用 mysql 和 eureka 链接，无需更改。 修改连接数据库配置（xxx-service/src/main/resources/application-fat.yml） 参考 2.5 做法 修改前端页面连接网关地址（portal-service/src/main/resources/static/js/productList.js和orderList.js） 默认无需修改，不过当你访问 portal，配置的是 ingress 暴露的域名，具体可以看 k8s/目录下的 yaml 文件。 服务启动顺序：eureka -\u003e mysql -\u003e product,stock,order -\u003e gateway -\u003e portal 访问办法： kubectl get pod,svc,ing -n ms可以看出是由 nginx-ingress-controller暴露的域名访问， 绑定 hosts进行访问，192.168.110.235是我的 master IP，你也可以绑定为 node IP：192.168.110.235 eureka.ctnrs.com gateway.ctnrs.com portal.ctnrs.com ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:1:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#部署须知"},{"categories":["k8s"],"content":"构建 java 命令介绍 mvn clean package -D maven.test.skip=true mvn clean package：清除目录中生成的结果，做一个清除，重新打新的包。 -D maven.test.skip: 跳过单元测试，写的测试用例，如果写的有问题，是编译不过去的 ##2.3 helm 安装 mysql 介绍 mkdir -p /root/helm/mysql cd /root/helm/mysql # vi config.yaml persistence: #如果你只是简单测试，可以把 persistence 这里的所有配置都去掉，只保留 service 的配置即可。 enabled: true storageClass: \"managed-nfs-storage\" accessMode: ReadWriteOnce size: 8Gi service: type: NodePort #暴露 nodeport，可以用宿主机 ip+port 访问 nodePort: 32000 #helm 创建 db helm install db -f config.yaml stable/mysql #查看发布状态，这里会显示获取密码、host、port 的命令，下面那条获取 root 密码的命令就是在这里面看到的 helm status db #查看mysql 的 root 密码： kubectl get secret --namespace default db-mysql -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo 一步登录 mysql：这里的命令和下面的一步登录 mysql 步骤不能与你通用，具体要由上面那条helm status得出，因为 pod name 不一定一样，如果你创建的不是这个名字的话。 MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default db-mysql -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo) MYSQL_HOST=$(kubectl get nodes --namespace default -o jsonpath='{.items[0].status.addresses[0].address}') MYSQL_PORT=$(kubectl get svc --namespace default db-mysql -o jsonpath='{.spec.ports[0].nodePort}') mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD} 创建结果： [root@node01 mysql]# kubectl get secret --namespace default db-mysql -o jsonpath=\"{.data.mysql-root-password}\" | base64 --decode; echo W5hcn4PvTI [root@node01 mysql]# kubectl get pod,svc |grep db-mysql pod/db-mysql-7f897f4d95-bc7js 1/1 Running 0 80s service/db-mysql NodePort 10.0.0.121 \u003cnone\u003e 3306:32000/TCP 80s [root@node01 mysql]# helm list|grep db db default 1 2021-04-06 22:04:19.545636699 +0800 CST deployed mysql-1.6.9 5.7.30 删除你所创建的 db 数据库 helm delete db #kubectl get pod 就会就看不见了 ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:1:1","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#构建-java-命令介绍"},{"categories":["k8s"],"content":"2.4 mysql 登录然后创建 db 和 tables 数据 MySQL[(none)]\u003eCREATEDATABASE/*!32312 IF NOT EXISTS*/`tb_order`/*!40100 DEFAULT CHARACTER SET utf8mb4 */;MySQL[(none)]\u003eusetb_order;MySQL[(none)]\u003esource/data/simple-microservice/db/order.sqlMySQL[(none)]\u003eCREATEDATABASE/*!32312 IF NOT EXISTS*/`tb_product`/*!40100 DEFAULT CHARACTER SET utf8mb4 */;MySQL[(none)]\u003eusetb_product;MySQL[(none)]\u003esource/data/simple-microservice/db/product.sqlMySQL[(none)]\u003eCREATEDATABASE/*!32312 IF NOT EXISTS*/`tb_stock`/*!40100 DEFAULT CHARACTER SET utf8mb4 */;MySQL[(none)]\u003eusetb_stock;MySQL[(none)]\u003esource/data/simple-microservice/db/stock.sql 虽然 sql 文件介绍说使用的mysql5.6 的版本，但是经过测试 5.7 这里是正常使用，所以你想用 helm 安装 mysql5.6，可以参考另一篇文章K8s环境 Helm 安装 mysql 多版本 ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:2:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#24-mysql-登录然后创建-db-和-tables-数据"},{"categories":["k8s"],"content":"2.5 修改配置文件密码和 mysql ip 端口，创建 namesapce 语法介绍：sed -i 's#abc#def#g' filename，将 filename 文件里面所有的 abc 替换成 def。 cd /data/simple-microservice ### 修改 docker_build.sh 里面的 register 为我们创建的 harbor 仓库地址 sed -i 's#docker_registry=192.168.31.90#docker_registry=192.168.110.239#g' k8s/docker_build.sh ### 创建 namespace ms kubectl create namespace ms ### 修改 jdbc 的 mysql 连接 for i in `find ./ -name \"application-fat.yml\"`;do sed -i 's#mysql:3306#192.168.110.235:32000#g' $i;done ###修改 root 密码，2.3有告诉我们 root 密码是多少哦，当然，你也可以进 mysql 或者修改 helm 的 config.yaml 定义自己的初始密码，这里就不多做介绍了 for i in `find ./ -name \"application-fat.yml\"`;do sed -i 's#password: 123456#password: W5hcn4PvTI#g' $i;done ### 我们还要修改 skywalking 的 ip+端口，skywalking 用的是 nodeport 的部署方式，skywalking 尽管在 java 启动命令中被调用，但是就算不存在，java 服务也不会退出。 for i in `find ./ -name \"Dockerfile\"`;do sed -i 's#192.168.31.90:11800#192.168.110.235:11800#g' $i;done ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:3:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#25-修改配置文件密码和-mysql-ip-端口创建-namesapce"},{"categories":["k8s"],"content":"2.6 docker_build.sh 介绍 vi /data/simple-microservice/k8s/docker_build.sh #!/bin/bash ###这里是 harbor 地址 docker_registry=192.168.110.239 ###创建 harbor 登录secret，以后就不需要每次都手动登录了 kubectl create secret docker-registry registry-pull-secret --docker-server=$docker_registry --docker-username=admin --docker-p assword=Harbor12345 --docker-email=admin@ctnrs.com -n ms ### 下面是构建 mvn jar 包然后上传到 harbor，在部署 k8s yaml service_list=\"eureka-service gateway-service order-service product-service stock-service portal-service\" service_list=${1:-${service_list}} work_dir=$(dirname $PWD) current_dir=$PWD cd $work_dir mvn clean package -Dmaven.test.skip=true for service in $service_list; do cd $work_dir/$service if ls |grep biz \u0026\u003e/dev/null; then cd ${service}-biz fi service=${service%-*} image_name=$docker_registry/microservice/${service}:$(date +%F-%H-%M-%S) docker build -t ${image_name} . docker push ${image_name} sed -i -r \"s#(image: )(.*)#\\1$image_name#\" ${current_dir}/${service}.yaml kubectl apply -f ${current_dir}/${service}.yaml done ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:4:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#26--docker_buildsh-介绍"},{"categories":["k8s"],"content":"2.7 部署 ms java 服务 部署： cd /data/simple-microservice/k8s sh docker_build.sh 删除： cd /data/simple-microservice/k8s kubectl delete -f *.yaml 部署结果： [root@node01 k8s]# kubectl get pod,svc,ing -n ms NAME READY STATUS RESTARTS AGE pod/eureka-0 0/1 Running 0 3s pod/eureka-1 1/1 Running 0 3m2s pod/eureka-2 1/1 Running 0 6m53s pod/gateway-7b47c8d997-znkfx 1/1 Running 0 7m49s pod/order-59f6d5d786-htxtg 1/1 Running 0 7m36s pod/portal-6c79b876c9-h8vsd 1/1 Running 0 6m27s pod/product-8c88fbf8-hm7k6 1/1 Running 0 6m51s pod/stock-8944b6585-ccp8w 1/1 Running 0 6m51s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/eureka ClusterIP None \u003cnone\u003e 8888/TCP 6h17m service/gateway ClusterIP 10.0.0.113 \u003cnone\u003e 9999/TCP 6h17m service/portal ClusterIP 10.0.0.104 \u003cnone\u003e 8080/TCP 6h15m NAME CLASS HOSTS ADDRESS PORTS AGE ingress.networking.k8s.io/eureka \u003cnone\u003e eureka.ctnrs.com 80 6h17m ingress.networking.k8s.io/gateway \u003cnone\u003e gateway.ctnrs.com 80 6h17m ingress.networking.k8s.io/portal \u003cnone\u003e portal.ctnrs.com 80 6h15m 由 ing 那里得知，需要绑定的 hosts 如下； 192.168.110.235 eureka.ctnrs.com gateway.ctnrs.com portal.ctnrs.com ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:5:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#27-部署-ms-java-服务"},{"categories":["k8s"],"content":"3. 接入 skywalking ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:0:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#3-接入-skywalking"},{"categories":["k8s"],"content":"3.1 Skywalking server 版部署，请参考 K8s环境 Helm部署skywalking ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:1:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#31-skywalking-server-版部署请参考"},{"categories":["k8s"],"content":"3.2 下载 skywalking 8.4.0版本 我们主要使用 agen 端，一定要与 server 端版本对应 cd /data wget https://mirror-hk.koddos.net/apache/skywalking/8.4.0/apache-skywalking-apm-es7-8.4.0.tar.gz tar xf apache-skywalking-apm-es7-8.4.0.tar.gz ### 这条是删除命令，你们可别乱来。。。。 for i in `find /data/simple-microservice/ -name skywalking`;do rm -rf $i \u0026\u0026 cp -rp /data/apache-skywalking-apm-bin-es7/agent/ $i;done ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:2:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#32-下载-skywalking-840版本"},{"categories":["k8s"],"content":"3.3 修改 Dockerfile 中 java 的启动命令 之前我们改成了 ip+nodeport 的形式，现在改回去直接 k8s 内部 serviceName+namespace 的访问形式。 for i in `find ./ -name \"Dockerfile\"`;do sed -i 's#192.168.31.90:11800#skywalking-oap.skywalking:11800#g' $i;done skywalking 的 svc 状态如下，只要 oap 的接口 [root@node01 k8s]# kubectl get svc -n skywalking NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE skywalking-oap ClusterIP 10.0.0.3 \u003cnone\u003e 12800/TCP,11800/TCP 5h22m skywalking-ui NodePort 10.0.0.232 \u003cnone\u003e 80:30008/TCP 5h22m ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:3:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#33-修改-dockerfile-中-java-的启动命令"},{"categories":["k8s"],"content":"3.4 查看 skywalking 的 java 微服务 ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:4:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#34-查看-skywalking-的-java-微服务"},{"categories":["k8s"],"content":"4. 参考 https://github.com/lizhenliang/simple-microservice ","date":"2021-04-05","objectID":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/:0:0","series":null,"tags":["k8s","微服务部署"],"title":"【k8s】java 微服务部署示例","uri":"/k8s%E7%8E%AF%E5%A2%83-java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%A4%BA%E4%BE%8B/#4-参考"},{"categories":["gitlab"],"content":"Gitlab 安装","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/"},{"categories":["gitlab"],"content":"使用 docker-compose 安装 我这里简单直接用 http+ip 访问，不做过多配置，如有需要请另行修改 mkdir /data/gitlab vi docker-compose.yml web: image: 'gitlab/gitlab-ce:latest' restart: always hostname: 'gitlab.example.com' container_name: gitlab environment: GITLAB_OMNIBUS_CONFIG: | external_url 'http://192.168.110.238' gitlab_rails['gitlab_shell_ssh_port'] = 622 ports: - '80:80' - '443:443' - '622:22' volumes: - '/data/gitlab/src/config:/etc/gitlab' - '/data/gitlab/src/logs:/var/log/gitlab' - '/data/gitlab/src/data:/var/opt/gitlab' 启动 docker-compose up -d 如果要修改配置，然后重新docker-compose restart就可以了 vi src/config/gitlab.rb ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#使用-docker-compose-安装"},{"categories":["gitlab"],"content":"首次访问 gitlab 使用域名gitlab.test.com或者该主机 IP 首次登录时会要求设置 root 用户的密码，完成后就可以用 root 和新设密码登录；然后按需创建 Group, User, Projects等，还有相关配置。 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:1:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#首次访问-gitlab"},{"categories":["gitlab"],"content":"gitlab 数据备份 因为是基于 docker-compose 把配置和数据都挂载本地路径了，所以其实只要把本地路径用 rsync 进行同步就可以达到备份的效果。 比如以下的备份方式：用crontab 去定时同步，不过这个脚本用了 delete，会删除源目录不存在，但是目的目录存在的文件 方法一：rsync 同步，好处是如果故障了，可以直接 docker-compose 直接起一个 gitalb # 创建备份脚本 cat \u003e /root/gitlab-backup.sh \u003c\u003c EOF #!/bin/bash # 请事先配置 gitlab 服务器到备份服务器的免密码 ssh 登录 rsync -av --delete /srv/gitlab/config '-e ssh -l root' 192.168.1.xx:/backup_gitlab/config rsync -av --delete /srv/gitlab/data '-e ssh -l root' 192.168.1.xx:/backup_gitlab/data EOF # 创建并应用 crontab cat \u003e /etc/cron.d/gitlab-backup \u003c\u003c EOF ## 每3个小时同步备份一次，具体根据需要修改 11 */3 * * * root bash /root/gitlab-backup.sh \u003e /root/gitlab/sync.log 2\u003e\u00261 EOF 方法二：gitlab 的备份命令直接创建备份文件，可以直接新起一个 gitlab 然后进行导入，版本必须和原来一致 docker exec -t \u003ccontainer name\u003e gitlab-backup create 如果 gitlab 服务器真的出现不可恢复的故障，丢失数据，那么至少保留有3小时前的备份，利用备份的文件，同样再用 docker 挂载 volume的方式运行，这样就可以恢复原 gitlab 服务运行。 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:2:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#gitlab-数据备份"},{"categories":["gitlab"],"content":"升级 gitlab 因为前面使用了 docker-compose 方式安装，因此 gitlab 升级很方便。 升级前停止/删除容器：docker-compose stop 如上节执行备份数据 修改 docker-compose.yml 的 images，然后docker-compose up -d ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:3:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#升级-gitlab"},{"categories":["gitlab"],"content":"将 github 代码导入 gitlab ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#将-github-代码导入-gitlab"},{"categories":["gitlab"],"content":"设置 GitHub Toekn 参考：https://docs.github.com/cn/github/authenticating-to-github/creating-a-personal-access-token Token 权限只要设置 “repo” 即可。 token： |-seetings |-- Developer settings |------Personal access tokens 下生成 注意：token 只会显示一次，记得保存如果你不建议重新配置一次的话 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:1:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#设置-github-toekn"},{"categories":["gitlab"],"content":"gitlab 导入 github 步骤如下 gitlab 主页选择 “New project”–\u003e “Import project”–\u003e“Github”–\u003e“输入 github token”–\u003e“选择你要导入的项目，然后直接 import 点击即可” #参考： https://docs.gitlab.com/omnibus/docker/#install-gitlab-using-docker-compose 备份还原请参考：https://docs.gitlab.com/ee/raketasks/backup_restore.html ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/:2:0","series":null,"tags":["gitlab","docker"],"title":"Gitlab安装","uri":"/k8s%E7%8E%AF%E5%A2%83-gitlab%E5%AE%89%E8%A3%85/#gitlab-导入-github-步骤如下"},{"categories":["k8s"],"content":"Harbor安装","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/"},{"categories":["k8s"],"content":"1. 环境 系统：centos7 docker：19.03.9 docker-compose：1.28.6 Harbor: 2.2.1 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#1-环境"},{"categories":["k8s"],"content":"2. 安装 docker yum remove docker docker-common docker-selinux docker-engine yum install -y yum-utils device-mapper-persistent-data lvm2 wget -O /etc/yum.repos.d/docker-ce.repo https://download.docker.com/linux/centos/docker-ce.repo sed -i 's+download.docker.com+mirrors.tuna.tsinghua.edu.cn/docker-ce+' /etc/yum.repos.d/docker-ce.repo yum makecache fast yum install docker-ce ##2.1 配置 docker 镜像加速和日志分割 cat \u003c\u003c EOF \u003e /etc/docker/daemon.json { \"registry-mirrors\": [\"http://f1361db2.m.daocloud.io\"], \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"storage-driver\": \"overlay2\" } EOF ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#2-安装-docker"},{"categories":["k8s"],"content":"3. 安装 docker-compose curl -L \"https://github.com/docker/compose/releases/download/1.28.6/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose docker-compose --version ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#3-安装-docker-compose"},{"categories":["k8s"],"content":"4. 安装 harbor **Tips：**为什么要用 https 而不用 http访问 harbor 镜像仓库呢，因为如果用 http 的话，必须在访问的客户端更改 docker 的 daemon.json 文件添加--insecure-registry，如果你客户端机器多的话，改起来麻烦还得重启 docker，但是用 https 访问，就无须更改 daemon.json 配置文件了，这是好处，如果你重启不受影响，那就随你 http 或者 https 了。 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:0:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#4-安装-harbor"},{"categories":["k8s"],"content":"4.1 生成 https 证书 我为了测试方便，直接使用 IP 方式作为访问，如果要改成域名，直接一键替换就好，还要 在步骤 2.3 要把 v3.ext 的IP=192.168.110.239`改成 以下方式： [alt_names] DNS.1=yourdomain.com DNS.2=yourdomain DNS.3=hostname 实际步骤： mkdir /root/harbor/cert/harbor -p cd /root/harbor/cert ###1. 生成证书颁发机构证书 #1.1 生成CA证书私钥 openssl genrsa -out ca.key 4096 #1.2 生成CA证书 openssl req -x509 -new -nodes -sha512 -days 365000 \\ -subj \"/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=192.168.110.239\" \\ -key ca.key \\ -out ca.crt ###2. 生成服务器证书 #2.1 生成私钥 openssl genrsa -out 192.168.110.239.key 4096 #2.2 生成证书签名请求（CSR） openssl req -sha512 -new \\ -subj \"/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=192.168.110.239\" \\ -key 192.168.110.239.key \\ -out 192.168.110.239.csr #2.3 生成一个x509 v3扩展文件 cat \u003e v3.ext \u003c\u003c-EOF authorityKeyIdentifier=keyid,issuer basicConstraints=CA:FALSE keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment extendedKeyUsage = serverAuth subjectAltName = @alt_names [alt_names] IP=192.168.110.239 EOF #2.4 使用该v3.ext文件为您的Harbor主机生成证书 openssl x509 -req -sha512 -days 365000 \\ -extfile v3.ext \\ -CA ca.crt -CAkey ca.key -CAcreateserial \\ -in 192.168.110.239.csr \\ -out 192.168.110.239.crt ###3. 提供证书给Harbor和Docker #3.1 将服务器证书和密钥复制到Harbor主机上的certficates文件夹中 cp 192.168.110.239.crt /data/harbor/certs/harbor cp 192.168.110.239.key /data/harbor/certs/harbor #3.2 转换yourdomain.com.crt为yourdomain.com.cert，供Docker使用 openssl x509 -inform PEM -in 192.168.110.239.crt -out 192.168.110.239.cert #3.3 将服务器证书，密钥和CA文件复制到Harbor主机上的Docker证书文件夹中，如果将默认nginx端口443映射到其他端口，请创建文件夹/etc/docker/certs.d/yourdomain.com:port或/etc/docker/certs.d/harbor_IP:port。 mkdir -p /etc/docker/certs.d/192.168.110.239/ cp 192.168.110.239.cert /etc/docker/certs.d/192.168.110.239/ cp 192.168.110.239.key /etc/docker/certs.d/192.168.110.239/ cp ca.crt /etc/docker/certs.d/192.168.110.239/ #重新启动Docker Engine systemctl restart docker 证书位置说明； [root@node05 data]# tree /data/harbor/certs/ /data/harbor/certs/ ├── 192.168.110.239.cert ├── 192.168.110.239.crt ├── 192.168.110.239.csr ├── 192.168.110.239.key ├── ca.crt ├── ca.key ├── ca.srl ├── harbor │ ├── 192.168.110.239.crt │ └── 192.168.110.239.key └── v3.ext [root@node05 data]# tree /etc/docker/certs.d/ /etc/docker/certs.d/ └── 192.168.110.239 ├── 192.168.110.239.cert ├── 192.168.110.239.key └── ca.crt 部署说明： 如果还没有部署 harbor，在生成证书之后，修改 harbo.yml 的配置hostname 和 https 的属性就好，然后./install 如果已经部署好 harbor，那么也是要修改 harbor.yml 的配置hostname 和 https 的属性， #2.1 运行prepare脚本以启用HTTPS ./prepare #2.2 如果Harbor正在运行，请停止并删除现有实例,图像数据保留在文件系统中，因此不会丢失任何数据 docker-compose down -v #2.3 重新启动 harbor docker-compose up -d 验证： 浏览器打开 https://192.168.110.239，账号密码 admin/Harbor12345 修改 docker 的 daemon.json 把 \"insecure-registries\": [\"https://192.168.110.239\"], 添加进去，然后 docker login https://192.168.110.239 ，如果你用的不是默认的 443 端口，记得要用 https://92.168.110.239:888 就是+端口号哦，不然会默认走 80 或者 443 的，导致验证出了问题。 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:1:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#41-生成-https-证书"},{"categories":["k8s"],"content":"4.2 安装 harbor 分为在线安装和下线安装两种，其实就是你的安装包完不完整的问题而已啦，我这里用下线安装方式 cd /data/ wget https://github.com/goharbor/harbor/releases/download/v2.2.1/harbor-offline-installer-v2.2.1.tgz tar xf harbor-offline-installer-v2.2.1.tgz cd /data/harbor cp harbor.yml.tmpl harbor.yml 修改 harbor 配置文件 [root@node05 harbor]# cat harbor.yml|grep -Ev '#|^$' hostname: 192.168.110.239 #如果 https 证书用的域名，这里要改为域名方式 http: port: 80 #如果你想简单点不走 https，直接把 https 关掉，就可以省去上面配置 https 证书的问题了。 https: port: 443 certificate: /data/harbor/certs/harbor/192.168.110.239.crt private_key: /data/harbor/certs/harbor/192.168.110.239.key harbor_admin_password: Harbor12345 #登录账号 admin 的默认密码 database: password: root123 #数据库密码 max_idle_conns: 50 max_open_conns: 1000 data_volume: /data #这里是默认的 docker-compose 的挂载数据的路径，保存在本地 trivy: ignore_unfixed: false skip_update: false insecure: false jobservice: max_job_workers: 10 notification: webhook_job_max_retry: 10 chart: absolute_url: disabled log: level: info local: rotate_count: 50 rotate_size: 200M location: /var/log/harbor _version: 2.2.0 proxy: http_proxy: https_proxy: no_proxy: components: - core - jobservice - trivy ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:2:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#42-安装"},{"categories":["k8s"],"content":"4.3 harbor 开启 helm 的 charts 仓库配置 ./install.sh --with-chartmuseum ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:3:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#43-harbor-开启-helm-的-charts-仓库配置"},{"categories":["k8s"],"content":"4.4 使用Harbor作为Chart仓库 启用后，默认创建的项目就带有helm charts功能了。 1、安装push插件 https://github.com/chartmuseum/helm-push helm plugin install https://github.com/chartmuseum/helm-push 2、添加repo helm repo add --username admin --password Harbor12345 myrepo http://192.168.110.239/chartrepo/library 如果用的自签名的证书，则会报错 # 增加仓库，因为使用的自签名证书，所以命令上需要加上，若不加上则会报错：Error: Looks like \"https://www.harbor.mobi/chartrepo/myrepo\" is not a valid chart repository or cannot be reached: Get https://www.harbor.mobi/chartrepo/myrepo/index.yaml: x509: certificate signed by unknown authority 指定证书添加 repo helm repo add --ca-file /data/helm/ssl/192.168.110.239.crt --cert-file /data/helm/ssl/192.168.110.239.cert --key-file /data/helm/ssl/192.168.110.239.key myrepo https://192.168.110.239/chartrepo/library 查看 [root@node01 ssl]# helm repo ls NAME URL stable http://mirror.azure.cn/kubernetes/charts aliyun https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts incubator https://charts.helm.sh/incubator helm-stable https://charts.helm.sh/stable azure http://mirror.azure.cn/kubernetes/charts/ elastic https://helm.elastic.co library https://192.168.110.239/chartrepo/library 3、推送与安装Chart helm push ms-0.1.0.tgz --username=admin --password=Harbor12345 --ca-file /data/helm/ssl/192.168.110.239.crt --cert-file /data/helm/ssl/192.168.110.239.cert --key-file /data/helm/ssl/192.168.110.239.key https://192.168.110.239/chartrepo/library helm install ms myrepo/ms ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/:4:0","series":null,"tags":["harbor","k8s"],"title":"Harbor安装","uri":"/k8s%E7%8E%AF%E5%A2%83-harbor%E5%AE%89%E8%A3%85/#44-使用harbor作为chart仓库"},{"categories":[],"content":"环境 k8s 1.20 kube-prometheus release-0.7 在过去的几年中，云计算已经成为及分布式计算最火热的技术之一，其中 Docker、Kubernetes、Prometheus 等开源软件的发展极大地推动了云计算的发展。本文首先从 Prometheus 是如何监控 Kubernetes 入手，介绍 Prometheus Operator 组件。接着详细介绍基于 Kubernetes 的两种 Prometheus 部署方式，最后介绍服务配置、监控对象以及数据展示和告警。通过本文，大家可以在 Kubernetes 集群的基础上学习和搭建完善的 Prometheus 监控系统。 #对比 开源监控方式有kube-prometheus和prometheus-operator 两者的参考文档地址：https://prometheus-operator.dev/docs/prologue/introduction/ 监控对比： Prometheus Operator Prometheus Operator 使用 Kubernetes 定制资源来简化 Prometheus、Alertmanager和相关监控组件的部署和配置。 kube-prometheus kube-prometheus 提供了基于 Prometheus 和 Prometheus Operator 的完整集群监控堆栈的配置示例。这包括部署多个 Prometheus和 Alertmanager 实例、metrics exporters(如用于收集节点 metrics 的 node_exporters)、将 Prometheus 链接到各种度量端点的目标配置，以及用于通知集群中潜在问题的示例警报规则。 helm chart The prometheus-community/kube-prometheus-stack 提供了与 kube-prometheus 类似的功能集。该图表由Prometheus社区维护。有关更多信息，请参见图表的自述文件 chart’s readme #kube-prometheus安装 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/:0:0","series":null,"tags":[],"title":"K8s环境 监控之kube Prometheus","uri":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/#环境"},{"categories":[],"content":"先决条件 默认情况下，假定kubelet使用令牌身份验证和授权，否则Prometheus需要一个客户端证书，它可以完全访问kubelet，而不仅仅是度量。令牌身份验证和授权允许更细粒度和更容易的访问控制。 kubelet配置必须包含以下标志： --authentication-token-webhook=true： 通过此标志，可以使用ServiceAccount令牌对kubelet进行身份验证。也可以通过将kubelet配置值authentication.webhook.enabled设置为true来启用它。 --authorization-mode=Webhook：这个标志允许kubelet使用API执行一个RBAC请求，以确定是否允许请求实体(在本例中是Prometheus)访问资源，特别是这个项目的/metrics端点。这也可以通过设置kubelet配置值授权来启用。Webhook模式。 该堆栈通过部署Prometheus适配器提供资源指标。该适配器是扩展API服务器，需要启用Kubernetes的此功能，否则适配器无效，但仍在部署中。 安装 commit 版本：f5f72e1b5011830da821a7f6afff667c27b6fc37 git clone https://github.com/prometheus-operator/kube-prometheus.git cd kube-prometheus kubectl create -f manifests/setup until kubectl get servicemonitors --all-namespaces ; do date; sleep 1; echo \"\"; done kubectl create -f manifests/ 临时暴露 web 页面： Prometheus kubectl --namespace monitoring port-forward svc/prometheus-k8s 9090 Then access via http://localhost:9090 Grafana $ kubectl --namespace monitoring port-forward svc/grafana 3000 Then access via http://localhost:3000 and use the default grafana user:password of admin:admin. Alert Manager $ kubectl --namespace monitoring port-forward svc/alertmanager-main 9093 Then access via http://localhost:9093 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/:1:0","series":null,"tags":[],"title":"K8s环境 监控之kube Prometheus","uri":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/#先决条件"},{"categories":[],"content":" 改为 NodePort 类型，然后访问 改动方法一：直接在service.yaml 添加type: NodePort cd kube-prometheus/manifests sed -i '/selector:/i\\\\ type:\\ NodePort' grafana-service.yaml sed -i '/selector:/i\\\\ type:\\ NodePort' alertmanager-service.yaml sed -i '/selector:/i\\\\ type:\\ NodePort' prometheus-service.yaml kubectl apply -f alertmanager-service.yaml kubectl apply -f grafana-service.yaml kubectl apply -f prometheus-service.yaml 方法二：命令行在线修改 kubectl edit svc grafana -n monitoring kubectl edit svc prometheus-k8s -n monitoring kubectl edit svc alertmanager-main -n monitoring 结果： [root@node01 manifests]# kubectl get svc -n monitoring NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE alertmanager-main NodePort 10.0.0.137 \u003cnone\u003e 9093:31641/TCP 136m alertmanager-operated ClusterIP None \u003cnone\u003e 9093/TCP,9094/TCP,9094/UDP 136m blackbox-exporter ClusterIP 10.0.0.149 \u003cnone\u003e 9115/TCP,19115/TCP 136m grafana NodePort 10.0.0.216 \u003cnone\u003e 3000:30450/TCP 136m kube-state-metrics ClusterIP None \u003cnone\u003e 8443/TCP,9443/TCP 136m node-exporter ClusterIP None \u003cnone\u003e 9100/TCP 136m prometheus-adapter ClusterIP 10.0.0.115 \u003cnone\u003e 443/TCP 136m prometheus-k8s NodePort 10.0.0.180 \u003cnone\u003e 9090:31907/TCP 136m prometheus-operated ClusterIP None \u003cnone\u003e 9090/TCP 136m prometheus-operator ClusterIP None \u003cnone\u003e 8443/TCP 139m nginx ingress 暴露端口访问 参考：https://github.com/prometheus-operator/kube-prometheus/blob/main/docs/exposing-prometheus-alertmanager-grafana-ingress.md 安装htpasswd yum -y install httpd-tools 清除 kubectl delete --ignore-not-found=true -f manifests/ -f manifests/setup #prometheus-operator安装 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/:2:0","series":null,"tags":[],"title":"K8s环境 监控之kube Prometheus","uri":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/#heading"},{"categories":[],"content":"参考 https://www.infoq.cn/article/uj12knworcwg0kke8zfv https://github.com/prometheus-operator/kube-prometheus https://huangzhongde.cn/post/Kubernetes/Using_kube-prometheus_deploy_monitor_system/ https://juejin.cn/post/6865504989695967245 https://huisebug.github.io/2019/08/27/Prometheus-Operator/ ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/:0:0","series":null,"tags":[],"title":"K8s环境 监控之kube Prometheus","uri":"/k8s%E7%8E%AF%E5%A2%83-%E7%9B%91%E6%8E%A7%E4%B9%8Bkube-prometheus/#参考"},{"categories":["k8s"],"content":"【k8s】命令行自动补全","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%91%BD%E4%BB%A4%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8/","series":null,"tags":["k8s"],"title":"【k8s】命令行自动补全","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%91%BD%E4%BB%A4%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8/"},{"categories":["k8s"],"content":"#kubectl， helm 命令自动补全 ##kubectl 命令自动补全： yum install -y bash-completion locate bash_completion echo \"source /usr/share/bash-completion/bash_completion\" \u003e\u003e /etc/profile echo \"source \u003c(kubectl completion bash)\" \u003e\u003e /etc/profile 若要马上生效，直接执行 source 的命令而不是添加到文件里面 ##helm 自动补全： echo \"source \u003c(helm completion bash)\" \u003e\u003e /etc/profile ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-%E5%91%BD%E4%BB%A4%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8/:0:0","series":null,"tags":["k8s"],"title":"【k8s】命令行自动补全","uri":"/k8s%E7%8E%AF%E5%A2%83-%E5%91%BD%E4%BB%A4%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8/#"},{"categories":["k8s"],"content":"K8s环境 nfs 动态存储卷部署","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/"},{"categories":["k8s"],"content":"环境 系统：CentOS7 K8s 1.20 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:1:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#环境"},{"categories":["k8s"],"content":"预备知识 如果你不知道NFS是做什么的，那么请参考下面链接（包括但不限于）进行学习： NFS nfs 是基于网络共享存储，所以在大数据量场景下不适用，在环境搭建测试学习 k8s 阶段反而很合适，当然，小业务量场景下也非常合适使用。 NFS 允许系统将其目录和文件共享给网络上的其他系统。通过 NFS，用户和应用程序可以访问远程系统上的文件，就象它们是本地文件一样。 ##使用前要注意 k8s 版本 在v1.20.0中禁用了selfLink，在 v1.21 中将会彻底的移除，In k8s 1.20 they have removed selfLink as per release notes. 报错：selfLink was empty [root@node01 deploy]# kubectl logs -f nfs-client-provisioner-cf84d684-vtns2 ..... E0324 15:05:21.127112 1 controller.go:1004] provision \"default/test-claim\" class \"managed-nfs-storage\": unexpected error getting claim reference: selfLink was empty, can't make reference 参考： https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner/issues/25 https://github.com/kubernetes/kubernetes/pull/94397 https://wqblogs.com/2021/01/27/k8s%E5%AF%B9%E6%8E%A5nfs%E5%AD%98%E5%82%A8/ 解决办法： 如果是 kubeadm 基于 yaml 安装 kube-apiserver方式安装： Current workaround is to edit /etc/kubernetes/manifests/kube-apiserver.yaml Under here: spec: containers: - command: - kube-apiserver Add this line: - --feature-gates=RemoveSelfLink=false The do this: kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml 如果是 二进制安装的话，add --feature-gates=RemoveSelfLink=false to /opt/kubernetes/cfg/kube-apiserver.conf，然后 restart 一下， (I had to do it twice to get it to work) ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:2:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#预备知识"},{"categories":["k8s"],"content":"创建 NFS 服务器 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:3:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#创建-nfs-服务器"},{"categories":["k8s"],"content":"安装nfs-utils 在集群每一个节点安装nfs-utils，master 和 node 节点等。 yum install -y nfs-utils ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:3:1","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#安装nfs-utils"},{"categories":["k8s"],"content":"配置nfs-server 创建共享目录 mkdir -p /ifs/kubernetes/ 编辑/etc/exports文件添加需要共享目录，每个目录的设置独占一行，编写格式如下： NFS共享目录路径客户机IP段(参数1,参数2,...,参数n) 例如： /ifs/kubernetes 192.168.110.0/24(rw,no_root_squash) 参数说明: ro只读访问 rw读写访问 sync所有数据在请求时写入共享 asyncnfs在写入数据前可以响应请求 securenfs通过1024以下的安全TCP/IP端口发送 insecurenfs通过1024以上的端口发送 wdelay如果多个用户要写入nfs目录，则归组写入（默认） no_wdelay如果多个用户要写入nfs目录，则立即写入，当使用async时，无需此设置hide在nfs共享目录中不共享其子目录 no_hide共享nfs目录的子目录 subtree_check如果共享/usr/bin之类的子目录时，强制nfs检查父目录的权限（默认） no_subtree_check不检查父目录权限 all_squash共享文件的UID和GID映射匿名用户anonymous，适合公用目录 no_all_squash保留共享文件的UID和GID（默认） root_squashroot用户的所有请求映射成如anonymous用户一样的权限（默认） no_root_squashroot用户具有根目录的完全管理访问权限 anonuid=xxx指定nfs服务器/etc/passwd文件中匿名用户的UID anongid=xxx指定nfs服务器/etc/passwd文件中匿名用户的GID 注1：尽量指定IP段最小化授权可以访问NFS 挂载的资源的客户端 注2：经测试参数insecure必须要加，否则客户端挂载出错mount.nfs: access denied by server while mounting ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:3:2","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#配置nfs-server"},{"categories":["k8s"],"content":"启动NFS服务 配置完成后，您可以在终端提示符后运行以下命令来启动 NFS 服务器： systemctl start nfs \u0026\u0026 systemctl start rpcbind systemctl enable nfs \u0026\u0026 systemctl enable rpcbind ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:3:3","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#启动nfs服务"},{"categories":["k8s"],"content":"检查NFS服务提供是否正常 到客户机上执行showmount命令进行检查 [root@node05 ~]# showmount -e Export list for node05: /ifs/kubernetes 192.168.110.0/24 ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:3:4","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#检查nfs服务提供是否正常"},{"categories":["k8s"],"content":"在客户端验证 [root@k8s-node1 ~]# yum -y install nfs-utils [root@k8s-node1 ~]# mount -t nfs 192.168.110.239:/ifs/kubernetes /mnt [root@k8s-node1 ~]# df -h|grep mnt 192.168.110.239:/ifs/kubernetes 37G 4.2G 33G 12% /mnt [root@k8s-node1 ~]# touch /mnt/a.txt ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:4:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#在客户端验证"},{"categories":["k8s"],"content":"yml 方式：安装 nfs-client-provisioner ###在集群每一个节点安装nfs-utils yum install -y nfs-utils ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:5:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#yml-方式安装-nfs-client-provisioner"},{"categories":["k8s"],"content":"在任意一个master节点执行下面，安装nfs-client-provisioner yum -y install git git clone https://github.com/kubernetes-incubator/external-storage cd external-storage/nfs-client/deploy/ commit 版本：201f40d78a9d3fd57d8a441cfc326988d88f35ec ###安装： 需要修改的地方： rbac.yaml ：默认使用 default 的 namespace，如果有需要要自行更改 class.yaml ：场景 storageclass 存储卷 deployment.yaml ：这个文件是创建 nfs client，供其他 pod 调用客户端，这里除了使用 default 的 namespace 之外，还要修改 nfs 的配置 # cat deployment.yaml ......省略 containers: - name: nfs-client-provisioner image: quay.io/external_storage/nfs-client-provisioner:latest #网络不好要换成国内的镜像地址 volumeMounts: - name: nfs-client-root mountPath: /persistentvolumes env: - name: PROVISIONER_NAME value: fuseim.pri/ifs - name: NFS_SERVER value: 192.168.110.239 ### 这里要换成 nfs 主机的 地址 - name: NFS_PATH value: /ifs/kubernetes ### 这里要换成 nfs 的存储路径 volumes: - name: nfs-client-root nfs: server: 192.168.110.239 ### 这里要换成 nfs 主机的 地址 path: /ifs/kubernetes ### 这里要换成 nfs 的存储路径 部署： kubectl apply -f rbac.yaml kubectl apply -f class.yaml kubectl apply -f deployment.yaml 安装结果 [root@node01 deploy]# kubectl get pod NAME READY STATUS RESTARTS AGE nfs-client-provisioner-cf84d684-cxpmd 1/1 Running 0 6m37s [root@node01 deploy]# kubectl get sc NAME PROVISIONER RECLAIMPOLICY VOLUMEBINDINGMODE ALLOWVOLUMEEXPANSION AGE managed-nfs-storage fuseim.pri/ifs Delete Immediate false 6m40s [root@node01 deploy]# kubectl get serviceaccounts NAME SECRETS AGE default 1 3h48m nfs-client-provisioner 1 7m25s [root@node01 deploy]# kubectl logs nfs-client-provisioner-cf84d684-cxpmd I0404 05:53:56.745867 1 leaderelection.go:185] attempting to acquire leader lease default/fuseim.pri-ifs... E0404 05:53:56.759885 1 event.go:259] Could not construct reference to: '\u0026v1.Endpoints{TypeMeta:v1.TypeMeta{Kind:\"\", APIVersion:\"\"}, ObjectMeta:v1.ObjectMeta{Name:\"fuseim.pri-ifs\", GenerateName:\"\", Namespace:\"default\", SelfLink:\"\", UID:\"522dc6e9-bb00-49bb-8d11-71a2f85be921\", ResourceVersion:\"19718\", Generation:0, CreationTimestamp:v1.Time{Time:time.Time{wall:0x0, ext:63753112436, loc:(*time.Location)(0x1956800)}}, DeletionTimestamp:(*v1.Time)(nil), DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string(nil), Annotations:map[string]string{\"control-plane.alpha.kubernetes.io/leader\":\"{\\\"holderIdentity\\\":\\\"nfs-client-provisioner-cf84d684-cxpmd_24f93740-950a-11eb-921c-c69636fbe444\\\",\\\"leaseDurationSeconds\\\":15,\\\"acquireTime\\\":\\\"2021-04-04T05:53:56Z\\\",\\\"renewTime\\\":\\\"2021-04-04T05:53:56Z\\\",\\\"leaderTransitions\\\":0}\"}, OwnerReferences:[]v1.OwnerReference(nil), Initializers:(*v1.Initializers)(nil), Finalizers:[]string(nil), ClusterName:\"\"}, Subsets:[]v1.EndpointSubset(nil)}' due to: 'selfLink was empty, can't make reference'. Will not report event: 'Normal' 'LeaderElection' 'nfs-client-provisioner-cf84d684-cxpmd_24f93740-950a-11eb-921c-c69636fbe444 became leader' I0404 05:53:56.759957 1 leaderelection.go:194] successfully acquired lease default/fuseim.pri-ifs I0404 05:53:56.759997 1 controller.go:631] Starting provisioner controller fuseim.pri/ifs_nfs-client-provisioner-cf84d684-cxpmd_24f93740-950a-11eb-921c-c69636fbe444! I0404 05:53:56.860178 1 controller.go:680] Started provisioner controller fuseim.pri/ifs_nfs-client-provisioner-cf84d684-cxpmd_24f93740-950a-11eb-921c-c69636fbe444! ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:5:1","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#在任意一个master节点执行下面安装nfs-client-provisioner"},{"categories":["k8s"],"content":"验证安装 该 git 提供了两个测试例子：test-pod.yaml 和 test-claim.yaml ,创建 pvc 和 pod 去验证 nfs kubectl apply -f test-pod.yaml kubectl apply -f test-claim.yaml 验证是否正常 [root@node01 deploy]# kubectl get pvc NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE test-claim Bound pvc-35ef9c39-fa80-4b0e-9a3c-fdb755beddf9 1Mi RWX managed-nfs-storage 10s [root@node01 deploy]# kubectl get pod NAME READY STATUS RESTARTS AGE nfs-client-provisioner-cf84d684-brlfk 1/1 Running 0 71s test-pod 0/1 Completed 0 23s 查看日志，正常创建test-claim [root@node01 deploy]# kubectl logs -f nfs-client-provisioner-cf84d684-brlfk ...... I0404 06:15:53.548454 1 event.go:221] Event(v1.ObjectReference{Kind:\"PersistentVolumeClaim\", Namespace:\"default\", Name:\"test-claim\", UID:\"35ef9c39-fa80-4b0e-9a3c-fdb755beddf9\", APIVersion:\"v1\", ResourceVersion:\"22423\", FieldPath:\"\"}): type: 'Normal' reason: 'ProvisioningSucceeded' Successfully provisioned volume pvc-35ef9c39-fa80-4b0e-9a3c-fdb755beddf9 查看 nfs 存储，也成功创建 [root@node05 kubernetes]# ll total 0 drwxrwxrwx 2 root root 21 Apr 4 14:15 default-test-claim-pvc-35ef9c39-fa80-4b0e-9a3c-fdb755beddf9 [root@node05 kubernetes]# pwd /ifs/kubernetes pod状态为Completed则为正常，若长时间为ContainerCreating状态则为不正常，请确认安装操作步骤是否正确。 清除测试用例 kubelete delete -f test-claim.yaml \u0026\u0026 kubelete delete -f test-pod.yaml ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:6:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#验证安装"},{"categories":["k8s"],"content":"helm 方式：安装 nfs-client 注意事项：与上面 yml 注意一样 nfs-client-provisioner部署到刚刚创建的nfs命名空间下 storageClass.name #指定storageClassName名称，用于 PVC 自动绑定专属动态 PV 上 需要指定NFS服务器的IP 地址(192.168.110.239)，以及共享名称路径(/ifs/kubernetes) ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:7:0","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#helm-方式安装-nfs-client"},{"categories":["k8s"],"content":"创建 nfs 动态 pv 命名空间 kubectl create ns nfs ###配置 nfs-client 的启动参数 产看配置：helm show values helm-stable/nfs-client-provisioner cat \u003e /data/helm/nfs-client/nfs-client.yaml \u003c\u003c EOF # NFS 设置 nfs: server: 192.168.110.239 path: /ifs/kubernetes storageClass: # 此配置用于绑定 PVC 和 PV name: nfs-client-manager # 资源回收策略 #主要用于绑定的PVC删除后，资源释放后如何处理该PVC在存储设备上写入的数据。 #Retain：保留，删除PVC后，PV保留数据； #Recycle：回收空间，删除PVC后，简单的清除文件；（NFS和HostPath存储支持） #Delete：删除，删除PVC后，与PV相连接的后端存储会删除数据；（AWS EBS、Azure Disk、Cinder volumes、GCE PD支持） reclaimPolicy: Retain # 使用镜像 image: repository: azure/nfs-client-provisioner # 副本数量 #replicaCount: 1 EOF ###部署 nfs-client-provisioner helm 添加 charts 源 helm repo add helm-stable https://charts.helm.sh/stable helm repo add azure http://mirror.azure.cn/kubernetes/charts/ helm repo add incubator https://charts.helm.sh/incubator helm repo update 指定 chart 版本 helm install nfs-cleint-storage -n nfs --values nfs-client.yaml helm-stable/nfs-client-provisioner --version 1.2.8 不指定默认版本 helm install nfs-cleint-storage1 -n nfs --values nfs-client.yaml helm-stable/nfs-client-provisioner 查看版本 helm search repo nfs-client-provisioner 安装后校验 #查看 nfs namespace 下的 app helm list -n nfs #查看所有 namespace 的 app helm list -A ###不走配置文件，直接命令启动方式为： helm install nfs-storage helm-stable/nfs-client-provisioner \\ --set nfs.server=192.168.110.239 \\ --set nfs.path=/ifs/kubernetes \\ --set storageClass.name=nfs-storage \\ --set storageClass.defaultClass=true ","date":"2021-04-04","objectID":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/:7:1","series":null,"tags":["k8s"],"title":"K8s环境 nfs 动态存储卷部署","uri":"/k8s%E7%8E%AF%E5%A2%83-nfs%E5%8A%A8%E6%80%81%E5%AD%98%E5%82%A8%E5%8D%B7%E9%83%A8%E7%BD%B2/#创建-nfs-动态-pv-命名空间"},{"categories":["nginx"],"content":"Nginx 允许 frame 嵌套","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/"},{"categories":["nginx"],"content":"X-Frame-Options The X-Frame-Options HTTP 响应头是用来给浏览器指示允许一个页面可以被其他域名进行嵌套 iframe 网页，被第三方调用。站点可以通过确保网站没有被嵌入到别人的站点里面，从而避免 clickjacking 攻击。 然而 X-Frame-Options 是个已广泛支持的非官方标准，目前 Chrome 和 Firefox 均不支持。 语法 X-Frame-Options 有三个可能的值： X-Frame-Options: deny X-Frame-Options: sameorigin X-Frame-Options: allow-from https://example.com/ X-Frame-Options: allow-all ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:0:0","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#x-frame-options"},{"categories":["nginx"],"content":"指南 换一句话说，如果设置为 deny，不光在别人的网站 frame 嵌入时会无法加载，在同域名页面中同样会无法加载。另一方面，如果设置为sameorigin，那么页面就可以在同域名页面的 frame 中嵌套。 deny 表示该页面不允许在 frame 中展示，即便是在相同域名的页面中嵌套也不允许。 sameorigin 表示该页面可以在相同域名页面的 frame 中展示。这里指的是同一个域名，比如你的 nginx server 配置的是 www.test.com，那么 abc.test.com 是不会被允许嵌套的。也就是只允许自己嵌套自己。 allow-from *uri* 表示该页面可以在指定来源的 frame 中展示。 ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:0:1","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#指南httpsdevelopermozillaorgzh-cndocswebhttpheadersx-frame-options指南"},{"categories":["nginx"],"content":"例子 Note: 设置 meta 标签是无效的！例如 \u003cmeta http-equiv=\"X-Frame-Options\" content=\"deny\"\u003e 没有任何效果。不要这样用！只有当像下面示例那样设置 HTTP 头 X-Frame-Options 才会生效。 ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:1:0","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#例子httpsdevelopermozillaorgzh-cndocswebhttpheadersx-frame-options例子"},{"categories":["nginx"],"content":"配置 nginx 配置 nginx 发送 X-Frame-Options 响应头，把下面这行添加到 ‘http’, ‘server’ 或者 ‘location’ 的配置中: add_header X-Frame-Options sameorigin always; 配置允许其他域名嵌套： add_header X-Frame-Options \"ALLOW-FROM https://*.test.com\"; ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:1:1","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#配置-nginxhttpsdevelopermozillaorgzh-cndocswebhttpheadersx-frame-options配置_nginx"},{"categories":["nginx"],"content":"结果 在 Firefox 尝试加载 frame 的内容时，如果 X-Frame-Options 响应头设置为禁止访问了，那么 Firefox 会用 about:blank 展现到 frame 中。也许从某种方面来讲的话，展示为错误消息会更好一点。 以下为在 Google Chrome 的报错信息，能够正常访问，不过还是有报错。 ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:2:0","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#结果httpsdevelopermozillaorgzh-cndocswebhttpheadersx-frame-options结果"},{"categories":["nginx"],"content":"参考页面 https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Frame-Options ","date":"2021-04-02","objectID":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/:0:0","series":null,"tags":["nginx"],"title":"Nginx 允许 frame 嵌套","uri":"/nginx%E5%85%81%E8%AE%B8frame%E5%B5%8C%E5%A5%97/#参考页面"},{"categories":["ELK"],"content":"【ELK】重置 elasticsearch 的超管 elastic 账号密码","date":"2021-03-25","objectID":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/","series":null,"tags":["ELK","elasticsearch"],"title":"【ELK】重置 elasticsearch 的超管 elastic 账号密码","uri":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":["ELK"],"content":"按照下述步骤创建本地超级账户，然后使用api接口本地超级账户重置elastic账户的密码 ","date":"2021-03-25","objectID":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:0:0","series":null,"tags":["ELK","elasticsearch"],"title":"【ELK】重置 elasticsearch 的超管 elastic 账号密码","uri":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#"},{"categories":["ELK"],"content":"1. 没有忘记 elastic 的超管密码 直接通过 api 重置 elastic 超级管理员的密码 curl-H\"Content-Type:application/json\"-XPOST-uelastic'http://127.0.0.1:9200/_xpack/security/user/elastic/_password' -d '{ \"password\" : \"newpassword\" }' ","date":"2021-03-25","objectID":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:0:0","series":null,"tags":["ELK","elasticsearch"],"title":"【ELK】重置 elasticsearch 的超管 elastic 账号密码","uri":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#1-没有忘记-elastic-的超管密码"},{"categories":["ELK"],"content":"2. 忘记了 elastic 的超管密码 确保你的配置文件中支持本地账户认证支持，如果你使用的是xpack的默认配置则无需做特殊修改；如果你配置了其他认证方式则需要确保配置本地认证方式在ES_HOME/config/elasticsearch.yml中； 使用命令 ES_HOME/bin/elasticsearch-users 创建一个基于本地问价认证的超级管理员 bin/elasticsearch-users useradd temp_admin -p temp_admin_passwd -r superuser 通过 api 重置 elastic 超级管理员的密码 curl-utemp_admin-ptemp_admin_passwd-XPUT'http://127.0.0.1:9200/_xpack/security/user/elastic/_password' -H 'Content-Type: application/json' -d' {\"password\": \"new_password\"} 校验下密码是否重置成功 curl-uelastic'http://localhost:9200/_xpack/security/_authenticate?pretty' 如果你确定后续不再使用本地认证则可将elasticsearch.yml文件中的本地文件认证方式删除掉； ","date":"2021-03-25","objectID":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:0:0","series":null,"tags":["ELK","elasticsearch"],"title":"【ELK】重置 elasticsearch 的超管 elastic 账号密码","uri":"/%E9%87%8D%E7%BD%AEes%E7%9A%84%E8%B6%85%E7%AE%A1elastic%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#2-忘记了-elastic-的超管密码"},{"categories":["证书"],"content":"获取免费通配符证书","date":"2021-03-04","objectID":"/%E8%8E%B7%E5%8F%96%E9%80%9A%E9%85%8D%E7%AC%A6%E8%AF%81%E4%B9%A6/","series":null,"tags":["certs","证书"],"title":"获取免费通配符证书","uri":"/%E8%8E%B7%E5%8F%96%E9%80%9A%E9%85%8D%E7%AC%A6%E8%AF%81%E4%B9%A6/"},{"categories":["证书"],"content":"#acme.sh https://github.com/certbot/certbot #certbot https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E 安装 yum -y install epel-release yum install certbot -y ","date":"2021-03-04","objectID":"/%E8%8E%B7%E5%8F%96%E9%80%9A%E9%85%8D%E7%AC%A6%E8%AF%81%E4%B9%A6/:0:0","series":null,"tags":["certs","证书"],"title":"获取免费通配符证书","uri":"/%E8%8E%B7%E5%8F%96%E9%80%9A%E9%85%8D%E7%AC%A6%E8%AF%81%E4%B9%A6/#"},{"categories":["ELK"],"content":"【ELK】kibana 安装删除插件","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/"},{"categories":["ELK"],"content":"安装插件 使用以下命令安装插件： bin/kibana-plugin install \u003cpackage name or URL\u003e 当您指定的插件名没有带 URL，插件工具将会尝试去下载 Elastic 官方插件。例如： $ bin/kibana-plugin install x-pack ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:1:0","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#安装插件"},{"categories":["ELK"],"content":"通过指定的 URL 地址安装插件 您可以简单的指定插件名称来下载 Elastic 官方插件。也可以指定插件具体的 URL 来下载安装，例如： $ bin/kibana-plugin install https://artifacts.elastic.co/downloads/packs/x-pack/x-pack-6.0.0.zip 您可以在 URL 中指定多种协议，例如 HTTP 、 HTTPS 或者 文件 协议。 ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:1:1","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#通过指定的-url-地址安装插件"},{"categories":["ELK"],"content":"向指定的目录安装插件 在 install 命令后面通过 -d 或者 --plugin-dir 选项指定插件安装目录，例如： $ bin/kibana-plugin install file:///some/local/path/x-pack.zip -d path/to/directory 如果目录不存在，这条命令会创建这个目录。 ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:1:2","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#向指定的目录安装插件"},{"categories":["ELK"],"content":"通过 Linux 安装包安装插件 Kibana 服务需要有 optimize 目录的写权限。如果您使用 sudo 或者 su 安装插件，您需要确保这些命令使用 kibana 用户执行。这个用户已经默认为您添加了，它用于包的安装。 $ sudo -u kibana bin/kibana-plugin install x-pack 如果插件使用了不同的用户安装且服务又没有运行起来，您就需要修改这些文件的所属用户： $ chown -R kibana:kibana /path/to/kibana/optimize ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:1:3","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#通过-linux-安装包安装插件"},{"categories":["ELK"],"content":"删除插件 通过删除当前版本重装新的插件来升级插件。 通过 remove 命令来删除插件： $ bin/kibana-plugin remove x-pack 您也可以通过手动删除 plugins/ 目录下的插件子目录来手动删除插件。 删除插件之后将会在下一次 Kibana 启动的时候触发一次 “优化（optimize）” 动作，可能会使启动有点延迟。 ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:0:0","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#删除插件"},{"categories":["ELK"],"content":"关闭插件 使用如下命令来关闭插件： ./bin/kibana --\u003cplugin ID\u003e.enabled=false 关闭或打开插件将会在下一次 Kibana 启动的时候触发一次 “优化（optimize）” 动作，可能会使启动有点延迟。 您可以在 package.json 文件中通过 name 属性查看插件的 ID ","date":"2021-01-17","objectID":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/:1:0","series":null,"tags":["ELK","kibana"],"title":"【ELK】kibana 安装删除插件","uri":"/kibana-%E5%AE%89%E8%A3%85%E5%88%A0%E9%99%A4%E6%8F%92%E4%BB%B6/#关闭插件"},{"categories":["ELK"],"content":"【ELK】elastalert 日志告警：邮件、钉钉、企业微信","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/"},{"categories":["ELK"],"content":"一、环境 系统：centos7 elk 版本：7.6.2 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#一环境"},{"categories":["ELK"],"content":"1.1 ElastAlert 工作原理 周期性的查询Elastsearch并且将数据传递给规则类型，规则类型定义了需要查询哪些数据。 当一个规则匹配触发，就会给到一个或者多个的告警，这些告警具体会根据规则的配置来选择告警途径，就是告警行为，比如邮件、钉钉、tg、slack、企业微信等 ElastAlert 手册 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#11-elastalert-工作原理"},{"categories":["ELK"],"content":"二、安装配置 elastalert Tips：Elastalert 0.2.0 之后使用 Python 3.6，不再使用 Python 2 版本 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#二安装配置-elastalert"},{"categories":["ELK"],"content":"2.1 安装 python3.6 #安装EPEL和IUS软件源 yum install epel-release -y yum install https://centos7.iuscommunity.org/ius-release.rpm -y #安装python3.6 yum install python36u python36u-devel python36u-pip -y #ln -s /usr/bin/python3.6 /bin/python3 #ln -s /usr/bin/pip3.6 /bin/pip3 ##2.2 安装 elastalert pip3 install elastalert ###2.2.1 配置 cd /opt/soft/ git clone https://github.com/Yelp/elastalert.git cd elastalert cp config.yaml.example config.yaml mkdir rules ###2.2.2 样例 https://github.com/Yelp/elastalert/tree/master/example_rules ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#21-安装-python36"},{"categories":["ELK"],"content":"2.2.3 config.yaml 配置文件 #规则目录 rules_folder: /opt/soft/elastalert/rules #多久从ES中查询一次 run_every: seconds: 30 #是查询窗口的大小，从每个查询运行的时间向后延伸。对于其中use_count_query或use_terms_query设置为true的规则，此值将被忽略。 buffer_time: minutes: 15 #连接elasticsearch配置 es_host: 127.0.0.1 es_port: 9200 es_username: elastic es_password: xxxxxxxx #elastalert索引名称 writeback_index: elastalert_status writeback_alias: elastalert_alerts #失败重试限制 alert_time_limit: days: 2 **以下配置没使用，只做介绍 ** #### 使用 TLS 连接诶 elastsearch #use_ssl: True #验证 tls 证书 #verify_certs: True #带正文的GET请求是Elasticsearch的默认选项。如果因为某些原因失败了，你可以通过'GET'，'POST'或'source',具体可以查看以下(http://elasticsearch-py.readthedocs.io/en/master/connection.html?highlight=send_get_body_as#transport) #es_send_get_body_as: GET # 开启 ssl 认证证书 #verify_certs: True #ca_certs: /path/to/cacert.pem #client_cert: /path/to/client_cert.pem #client_key: /path/to/client_key.key ###2.2.4 在 elasticsearch 中创建 elastalert 的日志索引 **Tips : **如果索引已存在，则不会重新创建 elastalert-create-index --index elastalert 输出结果： ProcessController: Elastic Version: 7.6.2 Reading Elastic 6 index mappings: Reading index mapping 'es_mappings/6/silence.json' Reading index mapping 'es_mappings/6/elastalert_status.json' Reading index mapping 'es_mappings/6/elastalert.json' Reading index mapping 'es_mappings/6/past_elastalert.json' Reading index mapping 'es_mappings/6/elastalert_error.json' ##2.3 常用命令 # 测试规则文件 elastalert-test-rule rule.yaml # 启动监控报警 python3 -m elastalert.elastalert --verbose --rule /root/elastalert/example_rules/rule.yaml ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#223-configyaml-配置文件"},{"categories":["ELK"],"content":"2.4 服务启动方法 Tips: 启动指定家目录的原因主要是有调用，可以少写路径，比如不需要指定 config.yml，rule 里面的 yml 文件可以少写路径指定== ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#24-服务启动方法"},{"categories":["ELK"],"content":"2.4.1 service 启动管理 # 创建elastalert服务文件 vim /etc/systemd/system/elastalert.service [Unit] Description=elastalert After=elasticsearch.service [Service] Type=simple User=root Group=root Restart=on-failure WorkingDirectory=/opt/soft/elastalert ExecStart=/usr/bin/python3 -m elastalert.elastalert --verbose --config /opt/soft/elastalert/config.yaml [Install] WantedBy=multi-user.target ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#241-service-启动管理"},{"categories":["ELK"],"content":"2.4.2 supervisor 启动管理 安装supervisor yum install -y supervisor systemctl enable supervisord 编写elastalert supervisord守护进程 vim /etc/supervisord.d/elastalert.ini [program:elastalert] directory=/opt/soft/elastalert command=/usr/bin/python3 -m elastalert.elastalert --verbose autostart=true startsecs=5 autorestart=true startretries=10 redirect_stderr=true stdout_logfile_maxbytes=20MB stdout_logfile_backups=5 stdout_logfile=/var/log/elastalert/elastalert.log 启动 systemctl enable supervisord systemctl restart supervisord systemctl start supervisord systemctl stop supervisord supervisorctl status ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:2","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#242-supervisor-启动管理"},{"categories":["ELK"],"content":"三、告警测试 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#三告警测试"},{"categories":["ELK"],"content":"3.1 es 测试索引 ###3.1.1 创建并推送数据到 index curl -X POST \"http://elastic:passwd@127.0.0.1:9200/test-alert/test\" -H 'Content-Type: application/json' -d '{\"@timestamp\": \"'$(date --iso-8601=seconds)'\", \"field\": \"value\"}' 输出： {\"_index\":\"test-alert\",\"_type\":\"test\",\"_id\":\"inH1I3cBMJwNYi416aLN\",\"_version\":1,\"result\":\"created\",\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"_seq_no\":0,\"_primary_term\":1} ###3.1.2 删除 index curl -X DELETE http://elastic:passwd@127.0.0.1:9200/test-alert 输出： {\"acknowledged\":true} ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#31-es-测试索引"},{"categories":["ELK"],"content":"3.1.3 查看有哪些索引 curl 'http://elastic:passwd@127.0.0.1:9200/_cat/indices?v' ###3.1.4查看索引内容： curl -X GET http://elastic:passwd@127.0.0.1:9200/test-alert/_search 输出结果： {\"took\":2,\"timed_out\":false,\"shards\":{\"total\":1,\"successful\":1,\"skipped\":0,\"failed\":0},\"hits\":{\"total\":{\"value\":4,\"relation\":\"eq\"},\"max_score\":1.0,\"hits\":[{\"index\":\"test-alert\",\"type\":\"test\",\"id\":\"inH1I3cBMJwNYi416aLN\",\"score\":1.0,\"source\":{\"@timestamp\": \"2021-01-21T08:01:52+00:00\", \"field\": \"value\"}},{\"index\":\"test-alert\",\"type\":\"test\",\"id\":\"0ocXJHcBMJwNYi41y3rG\",\"score\":1.0,\"source\":{\"@timestamp\": \"2021-01-21T08:37:55+0000\", \"field\": \"value\"}},{\"index\":\"test-alert\",\"type\":\"test\",\"id\":\"aZAiJHcBMJwNYi41QTqW\",\"score\":1.0,\"source\":{\"@timestamp\": \"2021-01-21T08:49:20+0000\", \"field\": \"value\"}},{\"index\":\"test-alert\",\"type\":\"test\",\"id\":\"1ZMmJHcBMJwNYi41h4z8\",\"score\":1.0,\"source\":{\"@timestamp\": \"2021-01-21T08:54:00+0000\", \"field\": \"value\"}}]}} ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#313-查看有哪些索引"},{"categories":["ELK"],"content":"3.2 邮件告警 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#32-邮件告警"},{"categories":["ELK"],"content":"3.2.1 创建测试告警规则 vim /opt/soft/elastalert/rules/emailtt.yml name: test-alert type: any # es 的监控索引 index: test-ale* # 发现 1 次就告警 num_events: 1 #1 分钟检查1次，和上面一起配合就是 1 分钟内触发 1 次规则就告警 timeframe: minutes: 1 #告警规则，查询索引内 field 字段的值 value，可以用正则进行匹配 filter: - query: query_string: query: \"field: *value*\" ## smtp 邮件 server 配置 smtp_host: smtp.zoho.com smtp_port: 465 smtp_ssl: true from_addr: \"test@qq.com\" ### 发送邮件的账号密码 smtp_auth_file: /opt/soft/elastalert/elastalert/smtp_auth_file.yml #告警方式 alert: - \"email\" #设置只需要的告警字段 include: [\"_index\",\"uri\",\"remote_addr\",\"http_x_forwarded_for\",\"status\"] #邮件标题 alert_subject: \"test-alert 正式环境 告警 {}\" #告警邮件接收人 email: - \"test@qq.com\" - \"test1@qq.comk\" ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#321-创建测试告警规则"},{"categories":["ELK"],"content":"3.2.2 发送邮件的账号密码 vi /opt/soft/elastalert/elastalert/smtp_auth_file.yml # 发件箱的qq邮箱地址，也就是用户名 user: test@qq.com # 不是qq邮箱的登录密码，是授权码 password: passwd ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:2","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#322-发送邮件的账号密码"},{"categories":["ELK"],"content":"3.2.3 启动告警规则并发送测试数据 cd /opt/soft/elastalert python3 -m elastalert.elastalert --verbose --rule /opt/soft/elastalert/rules/emailtt.yml ##3.3 钉钉告警 ###3.3.1 下载插件 cd /opt/soft/elastalert git clone https://github.com/xuyaoqiang/elastalert-dingtalk-plugin cp elastalert-dingtalk-plugin/elastalert_modules/dingtalk_alert.py elastalert/ ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:3","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#323-启动告警规则并发送测试数据"},{"categories":["ELK"],"content":"3.3.2 安装依赖 #查看依赖文件elastalert-dingtalk-plugin/requirements.txt，在对比 pip list 之后，我发现只需要安装以下内容即可 pip3 install pyOpenSSL==16.2.0 pip3 install requests==2.18.1 pip3 install setuptools\u003e=11.3 ###3.3.3 创建测试告警规则 vim /opt/soft/elastalert/rules/dingtt.yml name: Example frequency rule type: any index: test-alert num_events: 1 timeframe: minutes: 1 filter: - query: query_string: query: \"field: value\" #告警方式 alert: - \"elastalert.dingtalk_alert.DingTalkAlerter\" #钉钉接口 dingtalk_webhook: \"https://oapi.dingtalk.com/robot/send?access_token=钉钉机器人 api token\" dingtalk_msgtype: \"text\" ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:4","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#332-安装依赖"},{"categories":["ELK"],"content":"3.3.4 启动告警规则并发送测试数据 cd /opt/soft/elastalert python3 -m elastalert.elastalert --verbose --rule /opt/soft/elastalert/rules/dingtt.yml ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:5","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#334-启动告警规则并发送测试数据"},{"categories":["ELK"],"content":"3.3.5 钉钉机器人配置 具体可以查看钉钉机器人开发文档 最简单可以使用加 ip 方式 加关键字，就是发送到钉钉的信息里面有某个关键字 ###3.3.6 测试结果告警内容如下所示 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:6","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#335-钉钉机器人配置"},{"categories":["ELK"],"content":"3.4 微信告警 ###3.4.1 参考 https://github.com/anjia0532/elastalert-wechat-plugin https://anjia0532.github.io/2017/02/16/elastalert-wechat-plugin/ https://github.com/anjia0532/elastalert-docker ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:3:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#34-微信告警"},{"categories":["ELK"],"content":"3.5 告警格式优化 # 注意上下字段对应 alert_text: | kibana_url: \"https://hostname:5601/app/kibana\" alarm_reason: \"1分钟内login.php至少被访问10次\" alarm_name: {} request_uri: {} request_ip: {} response_status: {} alert_text_args: - name - request - clientip - response alert_text_type: alert_text_only ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:4:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#35-告警格式优化"},{"categories":["ELK"],"content":"四、kibana 添加 elastalert 插件 ##4.1 elastalert-kibana-plugin插件 kibana中elastalert插件，可以实现在kibana界面上编辑elastalert的告警规则配置。 kibana 的 elastalert 插件需要使用新的 bitsensor/elastalert api 服务 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#四kibana-添加-elastalert-插件"},{"categories":["ELK"],"content":"4.1.1 演示效果 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#411-演示效果"},{"categories":["ELK"],"content":"4.2 安装 elastalert-kibana-plugin 官网主推：bitsensor/elastalert-kibana-plugin 但是楼上那个很多小版本都没有，以上没有的话推荐使用以下版本： nsano-rururu/elastalert-kibana-plugin 目前版本支持： Kibana 6.8.1～6.8.12、7.5.1～7.8.1 Kibana 7.9.0～7.9.3 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#42-安装-elastalert-kibana-plugin"},{"categories":["ELK"],"content":"4.2.1 安装命令 /usr/share/kibana/bin/kibana-plugin install https://github.com/nsano-rururu/elastalert-kibana-plugin/releases/download/1.2.0/elastalert-kibana-plugin-1.2.0-7.6.2.zip --allow-root ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:1","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#421-安装命令"},{"categories":["ELK"],"content":"4.2.2 配置 默认情况下，插件将连接到 localhost:3030，也就是 kibana 和 elastalert 在同一台服务器上面，那么就不需要添加以下配置。如果您的ElastAlert服务器在其他主机或端口上运行，请在config / kibana.yml文件中添加更改以下选项： elastalert-kibana-plugin.serverHost: 192.168.1.1 elastalert-kibana-plugin.serverPort: 9000 ##4.3 安装 elastalert_docker 查看 nsano 提供的 elastalert api 服务支持列表 我使用的是 praecoapp/elastalert-server 提供的 docker 镜像对应 elastalert 0.2.4 版本 docker-compose sample 示例参考 ###4.3.1 安装命令 cd /opt/soft/ git clone https://github.com/bitsensor/elastalert.git elastalert_docker cd elastalert_docker mkdir rules ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:2","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#422-配置"},{"categories":["ELK"],"content":"4.3.2 更改配置，api server 端用的配置是config.json vi config/config.json 因为我的 kibana 和 elastalert docker 是同一台机，所以我主要修改 es 的配置就可以 { \"appName\": \"elastalert-server\", \"port\": 3030, \"wsport\": 3333, \"elastalertPath\": \"/opt/elastalert\", \"verbose\": false, \"es_debug\": false, \"debug\": false, \"rulesPath\": { \"relative\": true, \"path\": \"/rules\" }, \"templatesPath\": { \"relative\": true, \"path\": \"/rule_templates\" }, \"es_host\": \"192.168.3.30\", \"es_port\": 9200, \"writeback_index\": \"elastalert_status\" } ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:3","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#432-更改配置api-server-端用的配置是configjson"},{"categories":["ELK"],"content":"4.3.3 更改 elastalert 配置 vi ./config/elastalert.yaml es_host: 192.168.3.30 es_port: 9200 rules_folder: rules run_every: seconds: 5 buffer_time: minutes: 1 es_username: elastic es_password: passwd writeback_index: elastalert_status alert_time_limit: days: 2 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:4","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#433-更改-elastalert-配置"},{"categories":["ELK"],"content":"4.3.4 docker-compose.yml 配置文件 vi docker-compose.yml version: '3' services: elastalert: image: praecoapp/elastalert-server:20210104 container_name: elastalert hostname: elastalert restart: always network_mode: \"host\" ports: - \"3030:3030\" - \"3333:3333\" volumes: - ./config/elastalert.yaml:/opt/elastalert/config.yaml - ./config/elastalert-test.yaml:/opt/elastalert/config-test.yaml - ./config/config.json:/opt/elastalert-server/config/config.json - ./rules:/opt/elastalert/rules - ./rule_templates:/opt/elastalert/rule_templates #- ./elastalert:/opt/elastalert/elastalert，#这一句先注释掉，下面有个操作 ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:5","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#434-docker-composeyml-配置文件"},{"categories":["ELK"],"content":"4.3.5 启动 docker-compose up -d ##然后把 docker 镜像里面的 elastalert 复制出来 docker cp elastalert:/opt/elastalert/elastalert . ##再把docker-compose.yml 里面的 volumes 的注释项去掉重新启动 docker-compose up -d ###4.3.6 配套钉钉插件和规则测试 cd /opt/soft/elastalert_docker git clone https://github.com/xuyaoqiang/elastalert-dingtalk-plugin cp elastalert-dingtalk-plugin/elastalert_modules/dingtalk_alert.py elastalert/ ##安装依赖 docker exec -it elastalert pip install pyOpenSSL==16.2.0 docker exec -it elastalert pip install requests==2.18.1 docker exec -it elastalert pip install setuptools\u003e=11.3 #创建规则 touch rules/dingtt.yml #授权，否则页面无法编辑，具体可以看下面的报错示例 chown centos.centos rules/dingtt.yml #重新启动 elastalert 容器 docker restart elastalert ##查看日志 docker logs -f --tail=20 elastalert ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:1:6","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#435-启动"},{"categories":["ELK"],"content":"4.4 出现的报错： 01:50:07.285Z ERROR elastalert-server: Routes: Request for '/rules/:id' failed with error: [Error: EACCES: permission denied, open '/opt/elastalert/rules/dingtt.yaml'] { errno: -13, code: 'EACCES', syscall: 'open', path: '/opt/elastalert/rules/dingtt.yaml' } 解决办法： 直接 chmod 777 -R /opt/soft/elastalert_docker/rules/ 直接 chown centos.centos /opt/soft/elastalert_docker/rules/* ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:2:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#44-出现的报错"},{"categories":["ELK"],"content":"五、告警规则详解 ElastAlert 规则介绍 ##5.1 告警类型 ElastAlert包含几种具有常见监视范例的规则类型： any: 匹配任何与给定过滤器匹配的事件,这个是查到了什么便直接报警，属于自定义选项； frequency: 匹配Y时间内至少有X个事件的地方 spike: 当事件发生率增加或减少时匹配，API 流量陡然上升并马上恢复的时候； flatline: 在Y时间内少于X个事件时进行匹配，内存或者CPU使用率下降的时候； blacklist并whitelist输入: 当某个字段与黑名单/白名单匹配时匹配，昨天的那个疑似爬虫的 IP 地址又出现了； change: 当某个字段在一段时间内具有两个不同的值时进行匹配，应用的状态突然从 UP 转为 DOWN； new_term: 当字段中出现从未见过的术语时进行匹配，某个枚举类型字段，突然出现了未定义的类型； cardinality:当字段的唯一值数量大于或小于阈值时匹配，线上的 API 服务器突然挂了一台，它是根据唯一值的数量来判定的； ##5.2 报警抑制：减少重复报警 # 用来区分报警，跟 realert 配合使用，在这里意味着， # 5 分钟内如果有重复报警，那么当 name 不同时，会当做不同的报警处理，可以是数组 query_key: - name # 5 分钟内相同的报警不会重复发送 realert: minutes: 5 # 指数级扩大 realert 时间，中间如果有报警， # 则按照 5 -\u003e 10 -\u003e 20 -\u003e 40 -\u003e 60 不断增大报警时间到制定的最大时间， # 如果之后报警减少，则会慢慢恢复原始 realert 时间 exponential_realert: hours: 1 ##5.3 报警聚合：相同报警，聚合为一条 # 根据报警的内，将相同的报警安装 name 来聚合 aggregation_key: name # 聚合报警的内容，只展示 name 与 message summary_table_fields: - name - message ##5.4 报警格式化：突出重要信息 在这里，你可以自定义 alert 的内容，它的内部使用 Python 的 format 来实现的。 alert_subject: \"Error {} @{}\" alert_subject_args: - name - \"@timestamp\" alert_text_type: alert_text_only alert_text: | ### Error frequency exceeds \u003e Name: {} \u003e Message: {} \u003e Host: {} ({}) alert_text_args: - name - message - hostname - host #六、告警接收方式 Email Slack 企业微信 钉钉 alerta：https://github.com/alerta/alerta，告警接收平台 JIRA OpsGenie Commands HipChat MS Teams Telegram AWS SNS VictorOps PagerDuty Exotel Twilio Gitter ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#五告警规则详解"},{"categories":["ELK"],"content":"七、告警需求整理 整理下实施ELK最起码要实现的需求： 查询条件（精确匹配）：一级域名、二级域名、客户真实IP、HTTP状态码、HTTP方法、request_time、response_time、代理IP、body_bytes_sent 查询条件（模糊匹配）：url（如查找SQL注入关键字）、refere（流量来源）、agent（如查找搜索引擎） 近期（1周、1个月）内整体请求量走势情况； 如果发现总体走势异常，要很方便找到那个域名走势异常； 过去一个周期内（1天、1周、1月）所有请求构成，按不同域名出饼图； 实时监控爬虫IP过高的频率访问（如单个IP1分钟请求超过100次报警）； 实时监控500状态请求情况（如单个域名1分钟出现30个500就报警）； ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#七告警需求整理"},{"categories":["ELK"],"content":"参考 https://github.com/Yelp/elastalert https://github.com/bitsensor/elastalert https://github.com/bitsensor/elastalert-kibana-plugin https://github.com/xuyaoqiang/elastalert-dingtalk-plugin https://github.com/anjia0532/elastalert-wechat-plugin https://segmentfault.com/a/1190000017553282 https://blog.csdn.net/wenwenxiong/article/details/106048313 https://www.cnblogs.com/liuxinyustu/articles/14228934.html ","date":"2021-01-15","objectID":"/elasticleart-%E5%91%8A%E8%AD%A6/:0:0","series":null,"tags":["ELK","elastalert"],"title":"【ELK】elastalert 日志告警","uri":"/elasticleart-%E5%91%8A%E8%AD%A6/#参考"},{"categories":["prometheus","监控"],"content":"【Prometheus】热加载方法","date":"2021-01-11","objectID":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/","series":null,"tags":["prometheus"],"title":"Prometheus热加载方法","uri":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/"},{"categories":["prometheus","监控"],"content":"在运行时热加载Prometheus的配置信息 Promtheus的时序数据库在存储了大量的数据后，每次重启Prometheus进程的时间会越来越慢，还会导致数据丢失甚至触发报警（报警系统肯定要两套才能符合互相热备避免唯一性）。 而在日常运维工作中会经常调整Prometheus的配置信息，实际上Prometheus提供了在运行时热加载配置信息的功能。 ","date":"2021-01-11","objectID":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/:0:0","series":null,"tags":["prometheus"],"title":"Prometheus热加载方法","uri":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/#在运行时热加载prometheus的配置信息"},{"categories":["prometheus","监控"],"content":"Prometheus配置的热加载 Prometheus配置信息的热加载有两种方式： ###第一种热加载方式： 查看Prometheus的进程id，发送SIGHUP信号: kill -HUP \u003cpid\u003e ###第二种热加载方式： 发送一个POST请求到/-/reload，需要在启动时给定--web.enable-lifecycle选项： curl -X POST http://localhost:9090/-/reload 如果配置热加载成功，Prometheus会打印出下面的log Loading configuration file: Jan 11 02:48:22 proxy01 prometheus[392]: level=info ts=2021-01-11T02:48:22.215Z caller=main.go:799 msg=\"Loading configuration file\" filena...heus.yml ###我们使用的是第一种热加载方式，systemd unit文件如下： 我的 prometheus 是在 centos7 系统下面yum 安装的 rpm 包，默认是没有 ExecReload 的系统启动配置，只有 start，所以加上这一句则可。 [root@ld_proxy01 ~]# cat /etc/systemd/system/prometheus.service [Unit] Description=Prometheus Wants=network-online.target After=network-online.target [Service] User=prometheus Group=prometheus CPUAffinity=3 Type=simple ExecStart=/etc/prometheus/prometheus \\ --config.file /etc/prometheus/prometheus.yml \\ --storage.tsdb.path /var/lib/prometheus/ \\ --storage.tsdb.retention.time=90d \\ --web.console.templates=/etc/prometheus/consoles \\ --web.console.libraries=/etc/prometheus/console_libraries \\ --web.external-url=http://prometheus.op.hwtech.hk:10080 ExecReload=/bin/kill -HUP $MAINPID [Install] WantedBy=multi-user.target 然后重新加载一下配置即可，一定要执行，否则会报错。 systemctl daemon-reload 在更改完/etc/prometheus/prometheus.yml之后，仅需要重新加载配置，而不需重启进程时，只需要运行以下命令即可。 systemctl reload prometheus ","date":"2021-01-11","objectID":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/:1:0","series":null,"tags":["prometheus"],"title":"Prometheus热加载方法","uri":"/prometheus%E7%83%AD%E5%8A%A0%E8%BD%BD%E6%96%B9%E6%B3%95/#prometheus配置的热加载"},{"categories":["nginx"],"content":"【Nginx】 正则在线测试","date":"2021-01-05","objectID":"/nginx-rule%E5%9C%A8%E7%BA%BF%E6%B5%8B%E8%AF%95/","series":null,"tags":["nginx"],"title":"【Nginx】 正则在线测试","uri":"/nginx-rule%E5%9C%A8%E7%BA%BF%E6%B5%8B%E8%AF%95/"},{"categories":["nginx"],"content":"##起因 nginx 测试基本都是本地起一个 nginx 服务，然后修改 conf 配置文件进行测试，那么，有没有更方便快捷的方法呢？ 虽然网上有很多正则表达式的网站，但是因为 nginx 和这些网站的正则表达式引擎略有不同，所以很多在线测试的结果是不准确的。 nginx使用的是 PCRE，官方文档介绍 ##方法 nginx 官方提供了一个基于 php 编写的正则测试器 nginx-regex-tester，可以用 docker-compose 直接启动 测试成功截图；Result: Match found 测试失败截图：Result：Match not found ###注意问题： 如果你在 docker-compose up -d 很慢，主要是因为 Dockerfile 的 nginx 镜像使用的国外源 确认 nginx 是什么系统，在 dockerfile 加入这两句去判断 RUN cat /etc/issue RUN cat /etc/os-release 我刚确认用的是 debian buster 系统，所以直接更换为清华源就好了， RUN echo \"deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free \\n\\ deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free \\n\\ deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free \\n\\ deb https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free\" \u003e /etc/apt/sources.list 如图所示； https://www.nginx.com/blog/regular-expression-tester-nginx/ ","date":"2021-01-05","objectID":"/nginx-rule%E5%9C%A8%E7%BA%BF%E6%B5%8B%E8%AF%95/:0:0","series":null,"tags":["nginx"],"title":"【Nginx】 正则在线测试","uri":"/nginx-rule%E5%9C%A8%E7%BA%BF%E6%B5%8B%E8%AF%95/#"},{"categories":["nginx"],"content":"【Nginx】url 带有 “https://” 双斜杠特殊处理","date":"2021-01-05","objectID":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/","series":null,"tags":["nginx"],"title":"【Nginx】url 带有 “https://” 双斜杠特殊处理","uri":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/"},{"categories":["nginx"],"content":"问题 最近发现经常有客户端出现 url 复制两次访问的情况，导致触发了 waf 无法访问 403。所以就想着怎么处理，解决这个问题。 当用户请求：https://www.test.com/https://www.test.com/或者https://www.test.com/https://www.test.com会出问题 ###原因 开启压缩之后，nginx 的 uri 会默认把双斜杆//自动合并为单斜杆/ ###方法一：merge_slashes 启用或禁用将URI中的两个或多个相邻斜杠压缩为单个斜杠。处于安全考虑，一般不关闭。 merge_slashes off; ","date":"2021-01-05","objectID":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/:0:1","series":null,"tags":["nginx"],"title":"【Nginx】url 带有 “https://” 双斜杠特殊处理","uri":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/#问题"},{"categories":["nginx"],"content":"方法二： if ( $uri ~ \"http:(/)localhost(/|)$\" ) { rewrite ^ $scheme://$host:$server_port/ break; } ###方法三： if ( $uri ~ \"http:/(.*)localhost(/|)$\" ) { rewrite ^ $scheme://$host:$server_port/ break; } ","date":"2021-01-05","objectID":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/:0:2","series":null,"tags":["nginx"],"title":"【Nginx】url 带有 “https://” 双斜杠特殊处理","uri":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/#方法二"},{"categories":["nginx"],"content":"参考 http://nginx.org/en/docs/http/ngx_http_core_module.html#merge_slashes https://stackoverflow.com/questions/38175840/match-and-redirect-http-double-slash-from-uri-path-with-nginx ","date":"2021-01-05","objectID":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/:0:0","series":null,"tags":["nginx"],"title":"【Nginx】url 带有 “https://” 双斜杠特殊处理","uri":"/nginx-uri%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86/#参考"},{"categories":["Thoughts","人物自传"],"content":"应尽便须尽，无复独多虑。","date":"2021-01-05","objectID":"/%E9%99%B6%E6%B8%8A%E6%98%8E/","series":null,"tags":["陶渊明"],"title":"陶渊明","uri":"/%E9%99%B6%E6%B8%8A%E6%98%8E/"},{"categories":["Thoughts","人物自传"],"content":"陶渊明 陶渊明（约365～427年），字元亮，晚年更名潜，字渊明。别号五柳先生，私谥靖节，世称靖节先生。浔阳柴桑人（今江西九江）人。东晋末到刘宋初杰出的诗人、辞赋家、散文家。被誉为“隐逸诗人之宗”、“田园诗派之鼻祖”。是江西首位文学巨匠。曾任江州祭酒、建威参军、镇军参军、彭泽县令等职，最末一次出仕为彭泽县令，八十多天便弃职而去，从此归隐田园。他是中国第一位田园诗人，被称为“古今隐逸诗人之宗”，有《陶渊明集》。 ","date":"2021-01-05","objectID":"/%E9%99%B6%E6%B8%8A%E6%98%8E/:0:0","series":null,"tags":["陶渊明"],"title":"陶渊明","uri":"/%E9%99%B6%E6%B8%8A%E6%98%8E/#陶渊明httpssogushiwenorgauthorv_07d17f8539d7aspx"},{"categories":["Thoughts","人物自传"],"content":"形影神三首 贵贱贤愚，莫不营营以惜生，斯甚惑焉；故极陈形影之苦，言神辨自然以释之。好事君子，共取其心焉。 形赠影 天地长不没，山川无改时。 草木得常理，霜露荣悴之。 谓人最灵智，独复不如兹。 适见在世中，奄去靡归期。 奚觉无一人，亲识岂相思。 但余平生物，举目情凄洏。 我无腾化术，必尔不复疑。 愿君取吾言，得酒莫苟辞。 影答形 存生不可言，卫生每苦拙。 诚愿游昆华，邈然兹道绝。 与子相遇来，未尝异悲悦。 憩荫若暂乖，止日终不别。 此同既难常，黯尔俱时灭。 身没名亦尽，念之五情热。 立善有遗爱，胡为不自竭？ 酒云能消忧，方此讵不劣！ 神释 大钧无私力，万理自森著。 人为三才中，岂不以我故。 与君虽异物，生而相依附。 结托既喜同，安得不相语。 三皇大圣人，今复在何处？ 彭祖爱永年，欲留不得住。 老少同一死，贤愚无复数。 日醉或能忘，将非促龄具？ 立善常所欣，谁当为汝誉？ 甚念伤吾生，正宜委运去。 纵浪大化中，不喜亦不惧。 应尽便须尽，无复独多虑。 ","date":"2021-01-05","objectID":"/%E9%99%B6%E6%B8%8A%E6%98%8E/:1:0","series":null,"tags":["陶渊明"],"title":"陶渊明","uri":"/%E9%99%B6%E6%B8%8A%E6%98%8E/#形影神三首httpssogushiwenorgshiwenv_2106d9eb8efcaspx"},{"categories":["Thoughts","随笔"],"content":"于二零二零年：终章","date":"2020-12-28","objectID":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/","series":null,"tags":["无言"],"title":"于二零二零年：终章","uri":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/"},{"categories":["Thoughts","随笔"],"content":"2020 年年终有感 ###摘抄 人生难得是从容。 难的是放下现有能得到的触手可及，去追寻未知。 我要在你平庸无奇的回忆里，做一个闪闪发光的神经病。 我天性不宜交际。 在多数场合，我不是觉得对方乏味，就是害怕对方觉得我乏味。 可是我既不愿忍受对方的乏味，也不愿费劲 使自己显得有趣， 那都太累了。 我独处时最轻松，因为我不觉得自己乏味。 即使乏味，也自己承受， 不累及他人，无需感到不安。 ——周国平《风中的纸屑》 你要克服懒惰，你要克服游手好闲，你要克服漫长的白日梦，你要克服一蹴而就的妄想，你要克服自以为是浅薄的幽默感。你要独立生长在这世上，不寻找不依靠，因为冷漠寡情的人孤独一生。你要坚强，振作，自立，不能软弱，逃避，害怕。不要沉溺在消极负面得情绪里，要正面阳光得对待生活和爱你的人。 ——网易云热评 我因为爱你，所以常常想跟你道歉。我的爱沉重、污浊，里面带有许多令人不快的东西，比如悲伤、忧愁、自怜、绝望，我的心又这样脆弱不堪，自己总被这些负面情绪打败，好像在一个沼泽里越挣扎越下沉。而我爱你，就是想把你也拖进来，却希望你救我。 人们迟早会发现自己爱的不是现实中的他,而是想象中的他,现实中的他只是他们所创造梦中情人 的一个模板,他们迟早会发现梦中情人与模板的差距,适应了就走下去没适应就分开,你与大多数 人不同的是,你不需要模板\" “但是我喜欢上了一个不存在的人,她只是我虚构出来的,这难道不是一种病态? \" “不,不是,其实你很幸运,不管他是不是真是存在,能爱就很幸运了。 —— 刘慈欣《三体》 我所有的自负皆来自我的自卑，所有的英雄气概都来自于我的软弱。嘴里振振有词是因为心里满是怀疑，深情是因为痛恨自己无 情。这世界没有一件事是虚空而生的，站在光里，背后就会有阴影，这深夜里一片静默，是因为你没有听见声音。 ——坦白书 每个人都不是一座孤岛，一个人必须是这世界最坚固的岛屿，然后才能成为大陆的一部分。 ——海明威 ","date":"2020-12-28","objectID":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/:0:0","series":null,"tags":["无言"],"title":"于二零二零年：终章","uri":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/#"},{"categories":["Thoughts","随笔"],"content":"二零二零年：终章 ###技术： dev： python 完成了一个发布项目的改编，计划：改为 drf go 集成 k8s 了解底层基础，并且参与一套控制系统源码改编 jenkins pipeline 改写 demo 和 stage 环境，使用 library ops： aws、google、azure 云平台建设 ####other： blog：博客园和 hugo ###生活： 感情史：空白 舔狗日记：无 亲情：还是保持一贯的沉默 ###经济： 希望有存款 ","date":"2020-12-28","objectID":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/:1:0","series":null,"tags":["无言"],"title":"于二零二零年：终章","uri":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/#二零二零年终章"},{"categories":["Thoughts","随笔"],"content":"二零二零年：终章 ###技术： dev： python 完成了一个发布项目的改编，计划：改为 drf go 集成 k8s 了解底层基础，并且参与一套控制系统源码改编 jenkins pipeline 改写 demo 和 stage 环境，使用 library ops： aws、google、azure 云平台建设 ####other： blog：博客园和 hugo ###生活： 感情史：空白 舔狗日记：无 亲情：还是保持一贯的沉默 ###经济： 希望有存款 ","date":"2020-12-28","objectID":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/:1:0","series":null,"tags":["无言"],"title":"于二零二零年：终章","uri":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/#dev"},{"categories":["Thoughts","随笔"],"content":"二零二零年：终章 ###技术： dev： python 完成了一个发布项目的改编，计划：改为 drf go 集成 k8s 了解底层基础，并且参与一套控制系统源码改编 jenkins pipeline 改写 demo 和 stage 环境，使用 library ops： aws、google、azure 云平台建设 ####other： blog：博客园和 hugo ###生活： 感情史：空白 舔狗日记：无 亲情：还是保持一贯的沉默 ###经济： 希望有存款 ","date":"2020-12-28","objectID":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/:1:0","series":null,"tags":["无言"],"title":"于二零二零年：终章","uri":"/%E4%BA%8C%E9%9B%B6%E4%BA%8C%E9%9B%B6%E5%B9%B4%E7%BB%88%E7%AB%A0/#ops"},{"categories":["Golang"],"content":"【Golang】练习 tailf 简单模拟","date":"2020-12-06","objectID":"/%E7%BB%83%E4%B9%A0-tailf%E7%AE%80%E5%8D%95%E6%A8%A1%E6%8B%9F/","series":null,"tags":["Golang","go"],"title":"【Golang】练习 tailf 简单模拟","uri":"/%E7%BB%83%E4%B9%A0-tailf%E7%AE%80%E5%8D%95%E6%A8%A1%E6%8B%9F/"},{"categories":["Golang"],"content":" package main import ( \"bufio\" \"flag\" \"fmt\" \"io\" \"log\" \"os\" ) //命令行参数解析 func FlagMsg() string { //定义命令行参数方式1 var ( follow string ) flag.StringVar(\u0026follow, \"f\", \"\", \"filepath\") //解析命令行参数 flag.Parse() return follow } func main() { filepath := FlagMsg() file, err := os.Open(filepath) if err != nil { log.Fatalf(\"Open file fail:%v\", err) } defer file.Close() reader := bufio.NewReader(file) for { line, err := reader.ReadString('\\n') if err != nil { if err == io.EOF { // time.Sleep(1 * time.Second) continue } else { break } } fmt.Println(string(line)) } } 使用命令： go run main.go -f filepath ","date":"2020-12-06","objectID":"/%E7%BB%83%E4%B9%A0-tailf%E7%AE%80%E5%8D%95%E6%A8%A1%E6%8B%9F/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】练习 tailf 简单模拟","uri":"/%E7%BB%83%E4%B9%A0-tailf%E7%AE%80%E5%8D%95%E6%A8%A1%E6%8B%9F/#"},{"categories":["Golang"],"content":"【Golang】基础-切片 for 循环删除元素","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/"},{"categories":["Golang"],"content":"#1. 问题 ","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/#"},{"categories":["Golang"],"content":"1.1 需求 a := []int{1, 2, 3, 4, 5}，slice 删除大于 3 的数字 #2. 解决 ","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/#11-需求"},{"categories":["Golang"],"content":"方法 1 package main import \"fmt\" func main() { a := []int{1, 2, 3, 4, 5} for i := 0; i \u003c len(a); i++ { if a[i] \u003e 3 { a = append(a[:i], a[i+1:]...) i-- } } fmt.Println(a) } ","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/:2:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/#方法-1"},{"categories":["Golang"],"content":"方法 2 package main import \"fmt\" func main() { a := []int{1, 2, 3, 4, 5} j := 0 for _, v := range a { if v \u003c= 3 { a[j] = v j++ } } a = a[:j] fmt.Println(a) } ","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/:3:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/#方法-2"},{"categories":["Golang"],"content":"方法 3 package main import \"fmt\" func main() { a := []int{1, 2, 3, 4, 5} j := 0 q := make([]int, len(a)) for _, v := range a { if v \u003c= 3 { q[j] = v j++ } } q = q[:j] // q is copy with numbers \u003e= 0 fmt.Println(q) } ","date":"2020-12-03","objectID":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/:4:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-切片 for 循环删除元素","uri":"/%E5%9F%BA%E7%A1%80-%E5%88%87%E7%89%87slice%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4/#方法-3"},{"categories":["证书"],"content":"curl 和 java 报证书请求错误","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/"},{"categories":["证书"],"content":"1. 说明： 以下：例子的域名因为工作环境的问题，被我拿自己的博客域名替代了，所以无法进行模拟测试，请珍重，哈哈！ ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:0:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#1-说明"},{"categories":["证书"],"content":"2. 环境： centos：7.5 java jdk：1.8.0_74 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:0:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#2-环境"},{"categories":["证书"],"content":"3. curl 请求报错 [root@test01 tmp]# curl \"https://www.zhaouncle.com/api/v2/app/getBopomofo?source=%e8%b5%b5%e8%b6%99\" curl: (60) Peer's Certificate issuer is not recognized. More details here: http://curl.haxx.se/docs/sslcerts.html curl performs SSL certificate verification by default, using a \"bundle\" of Certificate Authority (CA) public keys (CA certs). If the default bundle file isn't adequate, you can specify an alternate file using the --cacert option. If this HTTPS server uses a certificate signed by a CA represented in the bundle, the certificate verification probably failed due to a problem with the certificate (it might be expired, or the name might not match the domain name in the URL). If you'd like to turn off curl's verification of the certificate, use the -k (or --insecure) option. ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:0:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#3-curl-请求报错"},{"categories":["证书"],"content":"3.1 解决办法一，治本之法 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:1:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#31-解决办法一治本之法"},{"categories":["证书"],"content":"3.1.1 Firefox 火狐浏览器 打开 https://www.zhaouncle.com，然后依次点击以下操作 “🔐安全锁图标”——》“向右箭头”——》“更多信息”——》“查看证书”——》“中间那个证书”，下载为 pem 文件 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:1:1","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#311-firefox-火狐浏览器"},{"categories":["证书"],"content":"3.1.2 进入 centos 系统 将下载的 pem 文件放入/etc/pki/ca-trust/source/anchors 目录，然后执行 update-ca-trust extract 命令 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:1:2","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#312-进入-centos-系统"},{"categories":["证书"],"content":"3.2 解决办法二**，治标** curl -k 或者 curl --insecure，在命令行上直接避免证书校验 curl -k \"https://www.zhaouncle.com/api/v2/app/getBopomofo?source=%e8%b5%b5%e8%b6%99\" curl --insecure \"https://www.zhaouncle.com/api/v2/app/getBopomofo?source=%e8%b5%b5%e8%b6%99\" ##3.3 解决办法三**，治标** ###3.3.1 wget 解决方法： echo \"check_certificate = off\" \u003e\u003e ~/.wgetrc ###3.3.2 curl 解决方法： echo \"insecure\" \u003e\u003e ~/.curlrc ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:2:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#32-解决办法二治标"},{"categories":["证书"],"content":"4. Java 和 curl 都请求证书错误 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:0:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#4-java-和-curl-都请求证书错误"},{"categories":["证书"],"content":"4.1 以下是 curl 报错： [centos@test01 ~]$ curl \"https://www.zhaouncle.com/api/v2/app/getBopomofo?source=%e8%b5%b5%e8%b6%99\" curl: (60) Peer's Certificate issuer is not recognized. More details here: http://curl.haxx.se/docs/sslcerts.html curl performs SSL certificate verification by default, using a \"bundle\" of Certificate Authority (CA) public keys (CA certs). If the default bundle file isn't adequate, you can specify an alternate file using the --cacert option. If this HTTPS server uses a certificate signed by a CA represented in the bundle, the certificate verification probably failed due to a problem with the certificate (it might be expired, or the name might not match the domain name in the URL). If you'd like to turn off curl's verification of the certificate, use the -k (or --insecure) option. [centos@test01 ~]$ ping www.zhaouncle.com PING www.zhaouncle.com (10.0.0.100) 56(84) bytes of data. 64 bytes from test01 (10.0.0.100): icmp_seq=1 ttl=64 time=262 ms 64 bytes from test01 (10.0.0.100): icmp_seq=2 ttl=64 time=262 ms 64 bytes from test01 (10.0.0.100): icmp_seq=3 ttl=64 time=262 ms ^C --- www.zhaouncle.com ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 2002ms rtt min/avg/max/mdev = 262.636/262.636/262.637/0.418 ms ##4.2 以下是 java 请求 www 证书报错 org.springframework.web.client.ResourceAccessException: I/O error on GET request for \"https://www.zhaouncle.com/api/v2/app/getBopomofo\": sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target; nested exception is javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:1:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#41-以下是-curl-报错"},{"categories":["证书"],"content":"4.3 说明 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:2:0","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#43-说明"},{"categories":["证书"],"content":"4.3.1 疑问：大家肯定很好奇我为啥会 ping 域名，然后还是内网 ip？ 解答：因为绑定了 hosts，然后请求的是内网 ip，于是走的是本地的 nginx，nginx 配置了证书，而不是外部的 cdn，如果是走外部请求走 cdn，curl 和 java 都不会报错，因为 cdn 已经绑定了证书，这个证书上传了证书链。哎，没错了，证书链。 ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:2:1","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#431-疑问大家肯定很好奇我为啥会-ping-域名然后还是内网-ip"},{"categories":["证书"],"content":"4.3.2 何谓证书链 加速 https 需要上传 SSL 证书，打开公钥 domain.com.crt ，发现里面有 3 个证书： 证书链。一般是一个用户证书，一个中间证书，和一个根证书。 一般只需要 用户证书+中间证书 就可以了, 根证书不用传, 除非你这个证书链不是三级,而是有两个中间证书. 一般来讲，只有传 用户证书 才能正常工作，可以同时传 用户证书和中间证书 或者 用户证书和中间证书和根证书 注意这些证书必须在同一个文件里面 格式如下： -----BEGIN CERTIFICATE----- MIIFSzCCBDOgAwIBAgIQHV3ex3xRLXOHkz2GjVAKrjANBgkqhkiG9w0BAQsFADCB ......后面省略，第一个是用户证书 -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- MIIGCDCCA/CgAwIBAgIQKy5u6tl1NmwUim7bo3yMBzANBgkqhkiG9w0BAQwFADCB ......后面省略，第二个是中间证书 -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- MIIFdDCCBFygAwIBAgIQJ2buVutJ846r13Ci/ITeIjANBgkqhkiG9w0BAQwFADBv ......后面省略，第三个是根证书 -----END CERTIFICATE----- ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:2:2","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#432-何谓证书链"},{"categories":["证书"],"content":"4.3.3 解决： 解决方法：在哪 nginx 那里把 www 的 crt 证书添加进中间证书，ok，就解决了所以问题，而且还不需要 步骤 3 但对对系统和命令行进行从处理，就可以解决问题。 参考：https://ep.gnt.md/index.php/curl-60-peers-certificate-issuer-is-not-recognized/ ","date":"2020-12-01","objectID":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/:2:3","series":null,"tags":["certs","证书"],"title":"curl 和 java 报证书请求错误","uri":"/curl%E5%92%8Cjava%E6%8A%A5%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF/#433-解决"},{"categories":["Golang"],"content":"【Golang】Godoc 或者第三方 plugins 插件介绍","date":"2020-11-30","objectID":"/godoc%E6%88%96%E8%80%85plugins%E6%8F%92%E4%BB%B6%E4%BB%8B%E7%BB%8D/","series":null,"tags":["Golang","go"],"title":"Golang】Godoc 或者第三方 plugins 插件介绍","uri":"/godoc%E6%88%96%E8%80%85plugins%E6%8F%92%E4%BB%B6%E4%BB%8B%E7%BB%8D/"},{"categories":["Golang"],"content":"#自带插件： https://golang.org/pkg/ #第三方插件： https://godoc.org/ ","date":"2020-11-30","objectID":"/godoc%E6%88%96%E8%80%85plugins%E6%8F%92%E4%BB%B6%E4%BB%8B%E7%BB%8D/:0:0","series":null,"tags":["Golang","go"],"title":"Golang】Godoc 或者第三方 plugins 插件介绍","uri":"/godoc%E6%88%96%E8%80%85plugins%E6%8F%92%E4%BB%B6%E4%BB%8B%E7%BB%8D/#"},{"categories":["Golang"],"content":"【Golang】基础-操作 csv","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/"},{"categories":["Golang"],"content":"1. encoding/csv，自带极简 ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#1-encodingcsvhttpsgolangorgpkgencodingcsv自带极简"},{"categories":["Golang"],"content":"1.1 写数据到csv文件 知识点： Write 方法使用[]string的切片格式追加方式写入数据 ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#11-写数据到csv文件"},{"categories":["Golang"],"content":"1.1.1 追加写入 package main import ( \"encoding/csv\" \"fmt\" \"log\" \"os\" \"github.com/spf13/cast\" ) type User struct { ID int64 Name string Tel string Addr string } func StructToCsv(filename string, UsersDb []User) { newFile, err := os.Create(filename) if err != nil { fmt.Println(err) } defer func() { newFile.Close() }() // 写入UTF-8 newFile.WriteString(\"\\xEF\\xBB\\xBF\") // 写入UTF-8 BOM，防止中文乱码 // 写数据到csv文件 w := csv.NewWriter(newFile) header := []string{\"ID\", \"Name\", \"Tel\", \"Addr\"} //标题 w.Write(header) for _, v := range UsersDb { context := []string{ cast.ToString(v.ID), v.Name, v.Tel, v.Addr, } // data = append(data, context) w.Write(context) } if err := w.Error(); err != nil { log.Fatalln(\"error writing csv:\", err) } w.Flush() } func main() { Users1 := []User{ {1, \"admin\", \"adminTel\", \"adminAddr\"}, {2, \"test\", \"testTel\", \"testAddr\"}, } StructToCsv(\"user.csv\", Users1) } ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:1:1","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#111-追加写入"},{"categories":["Golang"],"content":"1.1.2 一次性写入 知识点：WriteAll 使用[][] [][]string 格式一次性写入数据，覆盖 csv 文件 package main import ( \"encoding/csv\" \"fmt\" \"os\" \"github.com/spf13/cast\" ) type User struct { ID int Name string Tel string Addr string } func StructToCsv(filename string, UsersDb []User) { newFile, err := os.Create(filename) if err != nil { fmt.Println(err) } defer func() { newFile.Close() }() // 写入UTF-8 newFile.WriteString(\"\\xEF\\xBB\\xBF\") // 写入UTF-8 BOM，防止中文乱码 // 写数据到csv文件 w := csv.NewWriter(newFile) header := []string{\"ID\", \"Name\", \"Tel\", \"Addr\"} //标题 data := [][]string{ header, } for _, v := range UsersDb { context := []string{ cast.ToString(v.ID), v.Name, v.Tel, v.Addr, } data = append(data, context) } w.WriteAll(data) // WriteAll方法使用Write方法向w写入多条记录，并在最后调用Flush方法清空缓存。 w.Flush() } func main() { Users1 := []User{ {1, \"admin\", \"adminTel\", \"adminAddr\"}, {2, \"test\", \"testTel\", \"testAddr\"}, } StructToCsv(\"user.csv\", Users1) } ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:1:2","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#112-一次性写入"},{"categories":["Golang"],"content":"1.1.3 执行结果 ID,Name,Tel,Addr 1,admin,adminTel,adminAddr 2,test,testTel,testAddr ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:1:3","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#113-执行结果"},{"categories":["Golang"],"content":"1.2 读取 csv 文件 ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:2:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#12-读取-csv-文件"},{"categories":["Golang"],"content":"1.2.1 Read，逐条读取为[]string格式的数据 package main import ( \"encoding/csv\" \"fmt\" \"io\" \"log\" \"os\" \"github.com/spf13/cast\" ) type User struct { ID int Name string Tel string Addr string } var Users []*User func CsvToDb(filename string) { f, err := os.Open(filename) if err != nil { fmt.Println(\"Error: \", err) } reader := csv.NewReader(f) result1 := make([][]string, 0) result2 := make([][]string, 0) for { record, err := reader.Read() if err == io.EOF { break } if err != nil { log.Fatal(err) } result1 = append(result1, record) } for k, _ := range result1 { if result1[k][1] == \"Name\" \u0026\u0026 result1[k][2] == \"Tel\" \u0026\u0026 result1[k][3] == \"Addr\" { result2 = append(result1[:k], result1[k+1:]...) } } for _, v := range result2 { user := \u0026User{ ID: cast.ToInt(v[0]), Name: v[1], Addr: v[2], Tel: v[3], } Users = append(Users, user) } for _, v := range Users { fmt.Println(v) } } func main() { CsvToDb(\"user.csv\") } ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:2:1","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#121-read逐条读取为string格式的数据"},{"categories":["Golang"],"content":"1.2.2 ReadAll，一次性读取为[][]string格式的数据 package main import ( \"encoding/csv\" \"fmt\" \"os\" \"github.com/spf13/cast\" ) type User struct { ID int Name string Tel string Addr string } var Users []*User func CsvToDb(filename string) { f, err := os.Open(filename) if err != nil { fmt.Println(\"Error: \", err) } reader := csv.NewReader(f) // 可以一次性读完 result, err := reader.ReadAll() if err != nil { fmt.Println(\"Error: \", err) } result1 := make([][]string, 0) for k, _ := range result { if result[k][1] == \"Name\" \u0026\u0026 result[k][2] == \"Tel\" \u0026\u0026 result[k][3] == \"Addr\" { result1 = append(result[:k], result[k+1:]...) } } for _, v := range result1 { user := \u0026User{ ID: cast.ToInt(v[0]), Name: v[1], Addr: v[2], Tel: v[3], } Users = append(Users, user) } for _, v := range Users { fmt.Println(v) } } func main() { CsvToDb(\"user.csv\") } ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:2:2","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#122-readall一次性读取为string格式的数据"},{"categories":["Golang"],"content":"2. github.com/gocarina/gocsv 简单案例： package main import ( \"fmt\" \"os\" \"github.com/gocarina/gocsv\" ) type Client struct { // Our example struct, you can use \"-\" to ignore a field ID string `csv:\"ID\"` Name string `csv:\"Name\"` Tel string `csv:\"Tel\"` Addr string `csv:\"-\"` } // type Client struct { // Our example struct, you can use \"-\" to ignore a field // ID string \"ID\" // Name string \"Name\" // Tel string \"Tel\" // Addr string \"-\" // } func main() { clientsFile, err := os.OpenFile(\"user.csv\", os.O_RDWR|os.O_CREATE, os.ModePerm) if err != nil { panic(err) } defer clientsFile.Close() clients := []*Client{} if err := gocsv.UnmarshalFile(clientsFile, \u0026clients); err != nil { // Load clients from file panic(err) } for _, client := range clients { fmt.Println(\"Hello\", client.Name) } if _, err := clientsFile.Seek(0, 0); err != nil { // Go to the start of the file panic(err) } clients = append(clients, \u0026Client{ID: \"12\", Name: \"John\", Tel: \"21\"}) // Add clients clients = append(clients, \u0026Client{ID: \"13\", Name: \"Fred\"}) clients = append(clients, \u0026Client{ID: \"14\", Name: \"James\", Tel: \"32\"}) clients = append(clients, \u0026Client{ID: \"15\", Name: \"Danny\"}) csvContent, err := gocsv.MarshalString(\u0026clients) // Get all clients as CSV string //err = gocsv.MarshalFile(\u0026clients, clientsFile) // Use this to save the CSV back to the file if err != nil { panic(err) } fmt.Println(csvContent) // Display all clients as CSV string } 执行结果： ~/Documents/projects/scripts/go/eg  cat user.csv ﻿ID,Name,Tel,Addr 1,admin,adminTel,adminAddr 2,test,testTel,testAddr ~/Documents/projects/scripts/go/eg  go run 2.go Hello admin Hello test ID,Name,Tel ,admin,adminTel ,test,testTel 12,John,21 13,Fred, 14,James,32 15,Danny, ","date":"2020-11-25","objectID":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】基础-操作 csv ","uri":"/%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C-csv/#2-githubcomgocarinagocsvhttpsgithubcomgocarinagocsv"},{"categories":["Golang"],"content":"【Golang】类型转换之 cast 包","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"},{"categories":["Golang"],"content":"Go语言中cast包实现了基本数据类型和其字符串表示的相互转换。 ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#"},{"categories":["Golang"],"content":"cast包 cast 包实现了基本数据类型与其字符串表示的转换，在Go中轻松安全地从一种类型转换为另一种类型. 更多函数请查看官方文档。 ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#cast包"},{"categories":["Golang"],"content":"用法 Cast提供了一些To_____方法。这些方法将始终返回所需的类型。如果提供了不会转换为该类型的输入，则将返回该类型的0或nil值。 Cast还提供了与To_____E相同的方法。这些返回与To_____方法相同的结果，外加一个附加错误，告诉您是否成功转换。使用这些方法，您可以分辨出输入何时与零值匹配或转换失败与返回零值之间的区别。 ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#用法"},{"categories":["Golang"],"content":"string与int类型转换 这一组函数是我们平时编程中用的最多的。 ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:2:0","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#string与int类型转换"},{"categories":["Golang"],"content":"ToString() ToString()函数用于将非字符串类型的整数转换为字符串类型，函数签名如下。 示例代码如下： cast.ToString(\"mayonegg\") // \"mayonegg\" cast.ToString(8) // \"8\" cast.ToString(8.31) // \"8.31\" cast.ToString([]byte(\"one time\")) // \"one time\" cast.ToString(nil) // \"\" var foo interface{} = \"one more time\" cast.ToString(foo) // \"one more time\" ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:2:1","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#tostring"},{"categories":["Golang"],"content":"ToInt() ToInt()函数用于将非 int类型数据转换为对应的int表示，具体的函数签名如下。 示例代码如下： cast.ToInt(8) // 8 cast.ToInt(8.31) // 8 cast.ToInt(\"8\") // 8 cast.ToInt(true) // 1 cast.ToInt(false) // 0 var eight interface{} = 8 cast.ToInt(eight) // 8 cast.ToInt(nil) // 0 ","date":"2020-11-13","objectID":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:2:2","series":null,"tags":["Golang","go"],"title":"【Golang】类型转换之 cast 包","uri":"/%E6%A0%87%E5%87%86%E5%BA%93-cast%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#toint"},{"categories":["Golang"],"content":"【Golang】解决 go get下载包慢或者失败的问题","date":"2020-11-11","objectID":"/%E8%A7%A3%E5%86%B3goget%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/","series":null,"tags":["Golang","go"],"title":"解决 go get下载包慢或者失败的问题","uri":"/%E8%A7%A3%E5%86%B3goget%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/"},{"categories":["Golang"],"content":"使用goproxy Go的1.11版本以后 可以设置GOPROXY这个变量，来设置代理。 如果你自己有代理服务器就可以把这个环境变量设置成自己的代理。 首先开启go module支持: go env -w GO111MODULE=\"on\" 不管是 mac、linux、还是 windows，只要安装了 go 1.11 版本以上，就直接安装代理，简单方便 go env -w GOPROXY=https://goproxy.cn,direct ","date":"2020-11-11","objectID":"/%E8%A7%A3%E5%86%B3goget%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/:1:0","series":null,"tags":["Golang","go"],"title":"解决 go get下载包慢或者失败的问题","uri":"/%E8%A7%A3%E5%86%B3goget%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/#使用goproxy"},{"categories":["python"],"content":"【Python】如何结束退出 python 脚本","date":"2020-11-10","objectID":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/","series":null,"tags":["python"],"title":"【Python】如何结束退出 py 脚本","uri":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/"},{"categories":["python"],"content":"需求 当你运行脚本，在判断条件满足时，就退出脚本，结束本次执行。 ","date":"2020-11-10","objectID":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/:0:0","series":null,"tags":["python"],"title":"【Python】如何结束退出 py 脚本","uri":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/#需求"},{"categories":["python"],"content":"方法 使用 sys.exit()，直接退出程序，但是会引发一个 SystemExit 异常； 该方法包含一个 status 参数 sys.exit(0)，0 表示支持退出 sys.exit(1)，1 表示异常退出 这个SystemExit异常，是唯一一个不会被认为是错误的异常，当没有设置异常捕获的话，是不会有报错的，可以进行正常退出，当然也可以捕获这个异常进行一些其他操作。 import sys #sys.exit() #sys.exit(0) #sys.exit(1) try: sys.exit(1) except SystemExit as err: print(err) # 1 使用 os._exit()，直接退出，不会抛出异常； 但我们常用的Win32平台和基于UNIX的平台不会有所影响 使用 os.kill()，用于直接 Kill 掉进程，只在 unix 平台上有效； ","date":"2020-11-10","objectID":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/:0:0","series":null,"tags":["python"],"title":"【Python】如何结束退出 py 脚本","uri":"/%E5%A6%82%E4%BD%95%E7%BB%93%E6%9D%9F%E9%80%80%E5%87%BApython%E8%84%9A%E6%9C%AC/#方法"},{"categories":["linux"],"content":"#1. nmap 确认端口是否可以通信 可以通信： [root@ld_openvas ~]# nmap -p9100 192.168.3.31 Starting Nmap 6.47 ( http://nmap.org ) at 2020-11-09 08:11 UTC Nmap scan report for ip-192-168-3-31.eu-west-2.compute.internal (192.168.3.31) Host is up (0.000067s latency). PORT STATE SERVICE 9100/tcp open jetdirect MAC Address: 0A:F3:15:B8:34:4A (Unknown) Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds 不可通信： [root@ld_openvas ~]# nmap -p9100 192.168.3.31 Starting Nmap 6.47 ( http://nmap.org ) at 2020-11-09 08:12 UTC sendto in send_ip_packet_sd: sendto(5, packet, 44, 0, 192.168.3.31, 16) =\u003e Operation not permitted Offending packet: TCP 192.168.3.10:58035 \u003e 192.168.3.31:9100 S ttl=41 id=38326 iplen=44 seq=2968465412 win=1024 \u003cmss 1460\u003e sendto in send_ip_packet_sd: sendto(5, packet, 44, 0, 192.168.3.31, 16) =\u003e Operation not permitted Offending packet: TCP 192.168.3.10:58036 \u003e 192.168.3.31:9100 S ttl=40 id=56951 iplen=44 seq=2968399877 win=1024 \u003cmss 1460\u003e Nmap scan report for ip-192-168-3-31.eu-west-2.compute.internal (192.168.3.31) Host is up (0.000033s latency). PORT STATE SERVICE 9100/tcp filtered jetdirect MAC Address: 0A:F3:15:B8:34:4A (Unknown) Nmap done: 1 IP address (1 host up) scanned in 0.28 seconds #2. Telnet 确认端口是否可以通信 telnet 192.168.3.31 9100 ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:0:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#"},{"categories":["linux"],"content":"3. nc，netcat 简称 ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:0:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#3-ncnetcat-简称"},{"categories":["linux"],"content":"通 [root@proxy ~]# nc -vz 127.0.0.1 22 Ncat: Version 7.50 ( https://nmap.org/ncat ) Ncat: Connected to 127.0.0.1:22. Ncat: 0 bytes sent, 0 bytes received in 0.01 seconds. ##不通 [root@proxy ~]# nc -vz 127.0.0.1 223 Ncat: Version 7.50 ( https://nmap.org/ncat ) Ncat: Connection refused. ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:1:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#通"},{"categories":["linux"],"content":"4. wget 通的情况： [root@proxy ~]# wget 127.0.0.1:22 --2021-03-22 17:19:02-- http://127.0.0.1:22/ Connecting to 127.0.0.1:22... connected. HTTP request sent, awaiting response... 200 No headers, assuming HTTP/0.9 Length: unspecified Saving to: ‘index.html’ [ \u003c=\u003e ] 40 --.-K/s in 0s 2021-03-22 17:19:02 (7.47 MB/s) - Read error at byte 40 (Connection reset by peer).Retrying. --2021-03-22 17:19:03-- (try: 2) http://127.0.0.1:22/ Connecting to 127.0.0.1:22... connected. HTTP request sent, awaiting response... 200 No headers, assuming HTTP/0.9 Length: unspecified Saving to: ‘index.html’ [ \u003c=\u003e ] 0 --.-K/s in 0s Cannot write to ‘index.html’ (Connection reset by peer). 不通的情况 [root@proxy ~]# wget 127.0.0.1:223 --2021-03-22 17:19:20-- http://127.0.0.1:223/ Connecting to 127.0.0.1:223... failed: Connection refused. ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:0:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#4-wget"},{"categories":["linux"],"content":"5. ssh ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:0:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#5-ssh"},{"categories":["linux"],"content":"通 [root@proxy ~]# ssh 127.0.0.1 -p 25 ^C [root@proxy ~]# ssh 127.0.0.1 -p 25 -v OpenSSH_7.4p1, OpenSSL 1.0.2k-fips 26 Jan 2017 debug1: Reading configuration data /etc/ssh/ssh_config debug1: /etc/ssh/ssh_config line 58: Applying options for * debug1: Connecting to 127.0.0.1 [127.0.0.1] port 25. debug1: Connection established. debug1: permanently_set_uid: 0/0 debug1: identity file /root/.ssh/id_rsa type 1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_rsa-cert type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_dsa type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_dsa-cert type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_ecdsa type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_ecdsa-cert type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_ed25519 type -1 debug1: key_load_public: No such file or directory debug1: identity file /root/.ssh/id_ed25519-cert type -1 debug1: Enabling compatibility mode for protocol 2.0 debug1: Local version string SSH-2.0-OpenSSH_7.4 debug1: ssh_exchange_identification: 220 proxy ESMTP Sendmail 8.14.7/8.14.7; Mon, 22 Mar 2021 17:23:40 +0800 debug1: ssh_exchange_identification: 500 5.5.1 Command unrecognized: \"SSH-2.0-OpenSSH_7.4\" ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:1:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#通-1"},{"categories":["linux"],"content":"不通 [root@proxy ~]# ssh 127.0.0.1 -p 223 -v OpenSSH_7.4p1, OpenSSL 1.0.2k-fips 26 Jan 2017 debug1: Reading configuration data /etc/ssh/ssh_config debug1: /etc/ssh/ssh_config line 58: Applying options for * debug1: Connecting to 127.0.0.1 [127.0.0.1] port 223. debug1: connect to address 127.0.0.1 port 223: Connection refused ssh: connect to host 127.0.0.1 port 223: Connection refused ","date":"2020-11-09","objectID":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/:2:0","series":null,"tags":["nmap"],"title":"端口扫描和脚本批量测通","uri":"/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/#不通"},{"categories":["iptables"],"content":"【iptables】 简单使用","date":"2020-11-09","objectID":"/iptables/","series":null,"tags":["iptables"],"title":"【iptables】 简单使用","uri":"/iptables/"},{"categories":["iptables"],"content":"iptables 管理 iptables 端口映射配置步骤： 保存现有配置，执行如下命令：iptables-save \u003e iptables.config 编辑iptables.config 映射对应端口 更新配置，执行如下命令：iptables-restore \u003c iptables.config ","date":"2020-11-09","objectID":"/iptables/:0:0","series":null,"tags":["iptables"],"title":"【iptables】 简单使用","uri":"/iptables/#iptables-管理"},{"categories":["iptables"],"content":"ip 白名单 # sample configuration for iptables service # you can edit this manually or use system-config-firewall # please do not ask us to add additional ports/services to this default configuration *filter :INPUT ACCEPT [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] ##设置 ip 白名单 -N whitelist ##添加IP到白名单 -A whitelist -s xx.xx.xx.xx/32 -j ACCEPT　##不配置 witelist 列表，允许内网 ip 访问某端口 -A INPUT -s 192.168.105.0/24 -p tcp -m tcp --dport 22 -j ACCEPT -A INPUT -s 10.25.10.0/24 -p tcp -m tcp --dport 22 -j ACCEPT ##禁止访问 27017 -A INPUT -p tcp -m tcp --dport 27017 -j DROP -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT -A INPUT -p icmp -j ACCEPT -A INPUT -i lo -j ACCEPT ##whitelist调用白名单IP列表，22端口只允许白名单IP使用 -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j whitelist　##whitelist调用白名单IP列表，3306端口只允许白名单IP使用 -A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j whitelist　##无调用白名单，外网可访问 -A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT　-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT -A INPUT -j REJECT --reject-with icmp-host-prohibited -A FORWARD -j REJECT --reject-with icmp-host-prohibited COMMIT ","date":"2020-11-09","objectID":"/iptables/:0:0","series":null,"tags":["iptables"],"title":"【iptables】 简单使用","uri":"/iptables/#ip-白名单"},{"categories":["iptables"],"content":"1. 禁止访问外部某个端口 iptables -A OUTPUT -p tcp --dport 6382 -j DROP ","date":"2020-11-09","objectID":"/iptables/:0:1","series":null,"tags":["iptables"],"title":"【iptables】 简单使用","uri":"/iptables/#1-禁止访问外部某个端口"},{"categories":["iptables"],"content":"2. 禁止访问某个 ip 的某个端口 iptables -A OUTPUT -p tcp -d 192.168.1.10 --dport 6382 -j DROP ","date":"2020-11-09","objectID":"/iptables/:0:2","series":null,"tags":["iptables"],"title":"【iptables】 简单使用","uri":"/iptables/#2-禁止访问某个-ip-的某个端口"},{"categories":["Golang"],"content":"vscode 设置 Golang 开发环境","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"},{"categories":["Golang"],"content":"步骤 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#步骤"},{"categories":["Golang"],"content":"1. 始 Golang 语言开发选择一款合适的编辑器，能加速你敲字的灵感，这里推荐微软的 Visual Studio Code，简称 vscode。 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#1-始"},{"categories":["Golang"],"content":"2. 安装 go 插件 首先需要安装 go 语言插件，在 vscode 扩展中搜索 “go”，如下图，下载安装go插件 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:2:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#2-安装-go-插件"},{"categories":["Golang"],"content":"3. 设置 GOPROXY 如果想要 vscode 在 Go语言开发的时候为我们提供诸如代码提示、代码自动补全等功能，需要安装 go tools，但是安装 tools 需要设置 goproxy，否则会因为网络问题无法下载 tools 工具。 在此之前请先设置GOPROXY，打开终端执行以下命令： go env -w GOPROXY=https://goproxy.cn,direct ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:3:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#3-设置-goproxy"},{"categories":["Golang"],"content":"4. 安装 Go语言开发工具包 安装 Golang Tools，按下 Ctrl/Cmd+P，输入\u003e Go: Install/Update Tools，然后回车，选择你要安装的 tools 插件 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:4:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#4-安装-go语言开发工具包"},{"categories":["Golang"],"content":"5. 插件介绍 tools 名称 用途 gocode github.com/mdempsky/gocode 代码自动完成 gopkgs github.com/uudashr/gopkgs/v2/cmd/gopkgs 该工具为未导入的软件包提供自动补全功能 go-outline github.com/ramya-rao-a/go-outline 此工具提供了文档大纲功能以及当前文件功能中的转到符号。 go-symbols github.com/acroca/go-symbols 此工具提供了工作空间中的转到符号功能。 guru golang.org/x/tools/cmd/guru 该工具提供查找参考和查找接口实现功能。 它也可用于通过设置提供转到定义\"go.docsTool\"。 gorename golang.org/x/tools/cmd/gorename 此工具提供了重命名符号功能。 gotests github.com/cweill/gotests/… 该工具为Go: Generate Unit Tests命令集提供支持。 gomodifytags github.com/fatih/gomodifytags 该工具支持Go: Add Tags to Struct Fields和Go: Remove Tags From Struct Fields命令。 impl github.com/josharian/impl 该工具为Go: Generate Interface Stubs命令提供支持。 fillstruct github.com/davidrjenni/reftools/cmd/fillstruct 该工具提供了对Go: Fill struct命令的支持。 goplay github.com/haya14busa/goplay/cmd/goplay 该工具为Go: Run on Go Playground命令提供支持。 godoctor github.com/godoctor/godoctor 该工具提供了重构功能。 它不支持Go模块，因此我们希望gopls它将提供此功能（golang / go＃37170）。 dlv github.com/go-delve/delve/cmd/dlv 这是Go语言的调试器。它用于提供此扩展的调试功能。 gocode-gomod github.com/stamblerre/gocode goreturns github.com/sqs/goreturns golint golang.org/x/lint/golint ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:5:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#5-插件介绍"},{"categories":["Golang"],"content":"6. 打开vscode设置 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:6:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#6-打开vscode设置"},{"categories":["Golang"],"content":"7. settings.json 配置 \"go.inferGopath\": true, \"go.autocompleteUnimportedPackages\": true, \"go.gocodePackageLookupMode\": \"go\", \"go.gotoSymbol.includeImports\": true, \"go.useCodeSnippetsOnFunctionSuggest\": true, \"go.useCodeSnippetsOnFunctionSuggestWithoutType\": true, \"go.docsTool\": \"guru\", ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:7:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#7-settingsjson-配置"},{"categories":["Golang"],"content":"8. settings.json 参数介绍： ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:8:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#8-settingsjson-参数介绍"},{"categories":["Golang"],"content":"8.1 跳转到定义 go.docsTools：这里有三个选项，默认使用 gogetdoc，不知为何我这里选择之后无法使用 ctrl/cmd +鼠标左键点击跳转函数或者源码，于是我选择了 guru ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:8:1","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#81-跳转到定义"},{"categories":["Golang"],"content":"9. 效果 ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:9:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#9-效果"},{"categories":["Golang"],"content":"参考链接： https://github.com/microsoft/vscode-go https://github.com/golang/vscode-go https://github.com/golang/vscode-go/blob/master/docs/tools.md https://golang.google.cn/ ","date":"2020-11-01","objectID":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】vscode 设置 go 开发环境","uri":"/vscode%E8%AE%BE%E7%BD%AEgolang%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/#参考链接"},{"categories":["Golang"],"content":"Golang 字符串的查找方法小结","date":"2020-10-31","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/","series":null,"tags":["Golang","go"],"title":"【Golang】字符串的查找方法小结","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/"},{"categories":["Golang"],"content":"Contains 函数 func Contains(s, substr string) bool 用途：查找字符串 substr 是否在字符串 s 内，存在就返回 true 精确匹配 区分大小写 字符串必须相连，无法个几个再匹配 空字符串也是匹配项 package main import ( \"fmt\" \"strings\" ) func main() { fmt.Println(strings.Contains(\"aomineKing\", \"ao\")) //true fmt.Println(strings.Contains(\"aomineKing\", \"ek\")) //false fmt.Println(strings.Contains(\"aomineKing\", \"aK\")) //false fmt.Println(strings.Contains(\"aomineKing\", \"\")) //true fmt.Println(strings.Contains(\"\", \"\")) //true } func ContainsAny(s, chars string) bool 用途：查找 chars 中任意个字符在 s 中，若存在则返回 true 模糊匹配，只要是一个字符存在，则 true 空字符串不匹配 区分大小写 package main import ( \"fmt\" \"strings\" ) func main() { fmt.Println(strings.ContainsAny(\"aomineKing\", \"k\")) //false fmt.Println(strings.ContainsAny(\"aomineKing\", \"ui\")) //true fmt.Println(strings.ContainsAny(\"aomineKing\", \"qwe\")) //true fmt.Println(strings.ContainsAny(\"aomineKing\", \"uaoK\")) //true fmt.Println(strings.ContainsAny(\"aomineKing\", \"\")) //false fmt.Println(strings.ContainsAny(\"\", \"\")) //false } 参考： package main import ( \"fmt\" \"strings\" ) var ( coins = 50 users = []string{ \"Matthew\", \"Sarah\", \"Augustus\", \"Heidi\", \"Emilie\", \"Peter\", \"Giana\", \"Adriano\", \"Aaron\", \"Elizabeth\", } distribution = make(map[string]int, len(users)) rewardRules = map[string]int{ \"e\": 1, \"i\": 2, \"o\": 3, \"u\": 4, } ) func dispatchCoin() int { var leftCoins int for _, name := range users { tempCount := 0 for k, v := range rewardRules { tempCount += strings.Count(strings.ToLower(name), k) * v } distribution[name] = tempCount } for k, v := range distribution { fmt.Printf(\"【%v】分到多少枚【%d】金币\\n\", k, v) leftCoins += v } return coins - leftCoins } func main() { left := dispatchCoin() fmt.Println(\"剩下：\", left) } 结果： 【Sarah】分到多少枚【0】金币 【Heidi】分到多少枚【5】金币 【Giana】分到多少枚【2】金币 【Adriano】分到多少枚【5】金币 【Aaron】分到多少枚【3】金币 【Elizabeth】分到多少枚【4】金币 【Matthew】分到多少枚【1】金币 【Augustus】分到多少枚【12】金币 【Emilie】分到多少枚【6】金币 【Peter】分到多少枚【2】金币 剩下： 10 ","date":"2020-10-31","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】字符串的查找方法小结","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/#contains-函数"},{"categories":["Golang"],"content":"参考： https://www.godoc.org/strings#Contains ","date":"2020-10-31","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】字符串的查找方法小结","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95%E5%B0%8F%E7%BB%93-contains%E5%87%BD%E6%95%B0/#参考"},{"categories":["Golang"],"content":"自定义 input 函数整理用户输入","date":"2020-10-30","objectID":"/input%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5/","series":null,"tags":["Golang","go"],"title":"【Golang】自定义 input 函数整理用户输入","uri":"/input%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5/"},{"categories":["Golang"],"content":"把 fmt.Scan 用户输入整理成函数，方便底层调用，重复代码 package main import ( \"fmt\" ) func input(prompt string) string { var text string fmt.Print(prompt) fmt.Scan(\u0026text) return text } func main() { a := input(\"你输入的是啥：\") b := input(\"还是 python 简单很多：\") c := input(\"学会 go 好处多多多哦：\") fmt.Printf(\"%v, %v, %v\", a, b, c) } ","date":"2020-10-30","objectID":"/input%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】自定义 input 函数整理用户输入","uri":"/input%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5/#"},{"categories":["Golang"],"content":"Map 如何删除元素","date":"2020-10-30","objectID":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/","series":null,"tags":["Golang","go"],"title":"【Golang】Map 如何删除元素","uri":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/"},{"categories":["Golang"],"content":"map 函数如何进行删除内部元素呢？ 一是使用 append 进行排除不要的元素，重组需要的（案例一）； 而是用 index 索引进行排除（案例二），常规我一般用这种方法通用； ","date":"2020-10-30","objectID":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】Map 如何删除元素","uri":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/#map-函数如何进行删除内部元素呢"},{"categories":["Golang"],"content":"案例一： append for 循环选中需要的 package main import ( \"fmt\" ) func main() { users := []map[string]string{ {\"id\": \"1\", \"name\": \"test1\", \"contact\": \"11234\", \"address\": \"Guangdong\"}, {\"id\": \"2\", \"name\": \"test2\", \"contact\": \"21234\", \"address\": \"Shanghai\"}, {\"id\": \"3\", \"name\": \"test3\", \"contact\": \"31234\", \"address\": \"Hangzhou\"}, {\"id\": \"4\", \"name\": \"test4\", \"contact\": \"41234\", \"address\": \"Shenzhen\"}, } fmt.Println(users) id := \"1\" // 方法1: // 把不需要删除 =\u003e 定义新的切片 =\u003e users，使用 append 进行重新组合 // tempUsers := []map[string]string{} tmpUsers := make([]map[string]string, 0, len(users)-1) // 定义一个临时的 map 函数 for _, user := range users { if user[\"id\"] != id { //这里把不等于的 id 一个一个写入 tmpUsers， // fmt.Println(user) tmpUsers = append(tmpUsers, user) } // users = tmpUsers } fmt.Println(tmpUsers) } ","date":"2020-10-30","objectID":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/:1:1","series":null,"tags":["Golang","go"],"title":"【Golang】Map 如何删除元素","uri":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/#案例一-append-for-循环选中需要的"},{"categories":["Golang"],"content":"案例二：append index 索引排除法 package main import ( \"fmt\" ) func main() { users := []map[string]string{ {\"id\": \"1\", \"name\": \"test1\", \"contact\": \"11234\", \"address\": \"Guangdong\"}, {\"id\": \"2\", \"name\": \"test2\", \"contact\": \"21234\", \"address\": \"Shanghai\"}, {\"id\": \"3\", \"name\": \"test3\", \"contact\": \"31234\", \"address\": \"Hangzhou\"}, {\"id\": \"4\", \"name\": \"test4\", \"contact\": \"41234\", \"address\": \"Shenzhen\"}, } fmt.Println(users) id := \"1\" tmpUsers := make([]map[string]string, 0, len(users)-1) // 定义一个临时的 map 函数 for idx, user := range users { if user[\"id\"] == id { // fmt.Println(idx) tmpUsers = append(users[:idx], users[idx+1:]...) } } fmt.Println(tmpUsers) } 结果示例： ","date":"2020-10-30","objectID":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/:1:3","series":null,"tags":["Golang","go"],"title":"【Golang】Map 如何删除元素","uri":"/map%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0/#案例二append-index-索引排除法"},{"categories":["Golang"],"content":"【Golang】字符串与 int 的转换并打印类型","date":"2020-10-29","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/","series":null,"tags":["Golang","go"],"title":"【Golang】字符串与整数的转换并打印类型","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/"},{"categories":["Golang"],"content":"1. strconv 字符串与 int 的转换然后打印类型，主要使用 strconv 函数实现 package main import ( \"fmt\" \"reflect\" \"strconv\" ) func main() { a := 1 b := \"1\" fmt.Println(\"a\", reflect.TypeOf(a)) fmt.Println(\"b\", reflect.TypeOf(b)) fmt.Printf(\"a type of %T\\n\", a) fmt.Printf(\"b type of %T\\n\", b) a1 := strconv.Itoa(a) if b1, err := strconv.Atoi(b); err == nil { fmt.Println(\"a1\", reflect.TypeOf(a1)) fmt.Println(\"b1\", reflect.TypeOf(b1)) } } 执行结果： a int b string a type of int b type of string a1 string b1 int ","date":"2020-10-29","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/:1:0","series":null,"tags":["Golang","go"],"title":"【Golang】字符串与整数的转换并打印类型","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/#1-strconv"},{"categories":["Golang"],"content":"2. cast 用 strconv.Atoi 的方法，即将字符串转换为整数是要设置 err 错误信息的，那怎么可以省略呢？ 那就是使用 cast 函数 package main import ( \"fmt\" \"reflect\" \"strconv\" \"github.com/spf13/cast\" ) func main() { a := 1 b := \"1\" a2 := cast.ToString(a) fmt.Println(\"a2\", reflect.TypeOf(a2)) b2 := cast.ToInt(b) fmt.Println(\"b2\", reflect.TypeOf(b2)) } ","date":"2020-10-29","objectID":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/:2:0","series":null,"tags":["Golang","go"],"title":"【Golang】字符串与整数的转换并打印类型","uri":"/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%84%B6%E5%90%8E%E6%89%93%E5%8D%B0%E7%B1%BB%E5%9E%8B/#2-cast"},{"categories":["Golang"],"content":"map 使用映射存储操作指令及调用函数关","date":"2020-10-29","objectID":"/map%E4%BD%BF%E7%94%A8%E6%98%A0%E5%B0%84%E5%AD%98%E5%82%A8%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E5%8F%8A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%85%B3%E7%B3%BB/","series":null,"tags":["Golang","go"],"title":"【Golang】map 使用映射存储操作指令及调用函数关系","uri":"/map%E4%BD%BF%E7%94%A8%E6%98%A0%E5%B0%84%E5%AD%98%E5%82%A8%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E5%8F%8A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%85%B3%E7%B3%BB/"},{"categories":["Golang"],"content":"map： 使用映射存储操作指令及调用函数关系 package main import \"fmt\" func addUser() { fmt.Println(\"addUser\") } func modifyUser() { fmt.Println(\"modifyUser\") } func deleteUser() { fmt.Println(\"deleteUser\") } func queryUser() { fmt.Println(\"queryUser\") } func main() { operates := map[string]func(){ \"add\": addUser, \"modify\": modifyUser, \"delete\": deleteUser, \"query\": queryUser, } for { var text string fmt.Print(\"请输入指令: \") fmt.Scan(\u0026text) if text == \"exit\" { fmt.Println(\"退出\") break } if op, ok := operates[text]; ok { op() } else { fmt.Println(\"指令错误\") } } } ","date":"2020-10-29","objectID":"/map%E4%BD%BF%E7%94%A8%E6%98%A0%E5%B0%84%E5%AD%98%E5%82%A8%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E5%8F%8A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%85%B3%E7%B3%BB/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】map 使用映射存储操作指令及调用函数关系","uri":"/map%E4%BD%BF%E7%94%A8%E6%98%A0%E5%B0%84%E5%AD%98%E5%82%A8%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4%E5%8F%8A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%85%B3%E7%B3%BB/#"},{"categories":["Golang"],"content":"【Golang】for case 循环用户选择","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/"},{"categories":["Golang"],"content":" 语法点： for 循环 使用 case 函数，使用 break END 可以再输入 exit 的时候退出，也可以用 return。 Go语言也支持label(标签)语法：分别是 break label 和 goto label，break label 和 goto label 都能在循环中跳出循环。 2.1 break 的跳转标签 (label) 必须放在循环语句 for 前面，并且在 break label 跳出循环不再执行 for 循环里的代码。如 案例一 所示； 不能标签定义在 break 的下面 break 标签只能用于for循环； 2.2 goto label 的 label (标签)既可以定义在 for 循环前面（案例三）,也可以定义在 for 循环后面（案例四），当跳转到标签地方时，继续执行标签下面的代码。 但是由于在大项目中不好控制，所以建议能不使用goto label就不要使用； label 在 for 前后位置不一样，得到的退出结果也不一样； ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:0","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#"},{"categories":["Golang"],"content":"案例一：break label package main import \"fmt\" func main() { END: for { var text string fmt.Print(\"请输入指令: \") fmt.Scan(\u0026text) switch text { case \"add\": fmt.Println(\"添加\") case \"modify\": fmt.Println(\"修改\") case \"delete\": fmt.Println(\"删除\") case \"query\": fmt.Println(\"查询\") case \"exit\": fmt.Println(\"退出\") break END default: fmt.Println(\"输入指令错误\") } } } ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:1","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#案例一break-label"},{"categories":["Golang"],"content":"案例二：return package main import \"fmt\" func main() { for { var text string fmt.Print(\"请输入指令: \") fmt.Scan(\u0026text) switch text { case \"add\": fmt.Println(\"添加\") case \"modify\": fmt.Println(\"修改\") case \"delete\": fmt.Println(\"删除\") case \"query\": fmt.Println(\"查询\") case \"exit\": fmt.Println(\"退出\") return default: fmt.Println(\"输入指令错误\") } } } ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:2","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#案例二return"},{"categories":["Golang"],"content":"案例一、二 的 Gif 动态图展示： ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:3","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#案例一二-的-gif-动态图展示"},{"categories":["Golang"],"content":"案例三：goto ，for 循环前面 package main import \"fmt\" func main() { a := 1 END: for a \u003c 10 { if a == 5 { a++ goto END } fmt.Println(a) a++ } fmt.Println(a) } ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:4","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#案例三goto-for-循环前面"},{"categories":["Golang"],"content":"案例四：goto，for 循环后面 package main import \"fmt\" func main() { a := 1 for a \u003c 5 { if a == 3 { a++ goto END } fmt.Println(a) a++ } END: fmt.Println(a) } ","date":"2020-10-29","objectID":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/:0:5","series":null,"tags":["Golang","go"],"title":"【Golang】for case 循环用户选择","uri":"/forcase%E5%BE%AA%E7%8E%AF%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9/#案例四gotofor-循环后面"},{"categories":["hugo"],"content":"github blog 自定义域名，外加 https cdn 加速","date":"2020-10-29","objectID":"/hugo_03/","series":null,"tags":["hugo","博客"],"title":"Hugo（三）自定义域名\u0026cloudfare github pages 加速https","uri":"/hugo_03/"},{"categories":["hugo"],"content":"一、GitHub Pages + CloudFlare是建立网站的最简单方法之一。 github pages，我这里选择了 hugo+LoveIt 的静态页面 blog 架构，有兴趣自己查看之前的文章。 ","date":"2020-10-29","objectID":"/hugo_03/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（三）自定义域名\u0026cloudfare github pages 加速https","uri":"/hugo_03/#一github-pages--cloudflare是建立网站的最简单方法之一"},{"categories":["hugo"],"content":"1. 配置 github pages 域名 为了使用自己的域名，而不是 username.github.io，我这里使用了 github pages 的设置，进到“Settings”里面，往下拉可以看到，一个是设置自己的顶级域名，不要 zhaouncle.com，一个是开启 https 的选项。开启他可以用 https://zhaouncle.github.io进行访问，另外 https 做 seo 会优先进行，所以开启是有好处的，好像 2018 年才开始有这个功能。以前只能通过反代或者 cloudfare 实现 https。 ","date":"2020-10-29","objectID":"/hugo_03/:1:0","series":null,"tags":["hugo","博客"],"title":"Hugo（三）自定义域名\u0026cloudfare github pages 加速https","uri":"/hugo_03/#1-配置-github-pages-域名"},{"categories":["hugo"],"content":"2.在 username.github.io 仓库下面创建一个 CNAME 的文件并写入自己的域名 ","date":"2020-10-29","objectID":"/hugo_03/:2:0","series":null,"tags":["hugo","博客"],"title":"Hugo（三）自定义域名\u0026cloudfare github pages 加速https","uri":"/hugo_03/#2在-usernamegithubio-仓库下面创建一个-cname-的文件并写入自己的域名"},{"categories":["hugo"],"content":"二、利用Cloudflare为基于GitHub Pages的Hugo博客添加HTTPS支持 1、cloudfare 注册之后会给你两个 dns 地址，我这里是在阿里云上面购买的域名，于是去注册一个，我这里那 zhaowp.com举个例子 这一步先跳过，等会在进行编辑 这一步要去我们的域名采购商那里进行 dns 的更改 这一步默认就行，无需变动 我们可以看到在 Overview 这里，没有进行 dns 服务器更改这里会一直提示，我这里是阿里云的域名购买商，于是去进行更改 dns 服务器地址的操作，因为我之前已经填好了上面的步骤，所以用 zhaowp.com举个例子，别觉得奇怪 周到对应的域名，点击管理 点击确定之后我们回到 cloudfare 进行操作，等了几分钟我们发现这里解析成功了， 我们在 dns 这里设置 4 个 dns A 记录和 1 个CNAME 记录 add recore的时候 A 记录这里可以用@表示，这样cloudfare 会自己解析成你要的域名了，也就是现在为啥A 记录是域名的原因了。 然后到 SSL/TLS这里配置证书启用情况，我这里选了FULL，为何要选 FULL 呢，因为我在 github 上面开启了 https，所以需要进行双方的证书认证，否则无法打开网站 最后，我们创建一条规则，即最简单的永远使用 ssl 访问这个域名，点击 create 一条规则 我刚举了个 zhaowp 的例子，现在要删了，因为我没这个域名 ","date":"2020-10-29","objectID":"/hugo_03/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（三）自定义域名\u0026cloudfare github pages 加速https","uri":"/hugo_03/#二利用cloudflare为基于github-pages的hugo博客添加https支持"},{"categories":["cdn"],"content":"github 图床 cdn","date":"2020-10-29","objectID":"/github%E5%9B%BE%E5%BA%8A/","series":null,"tags":["cdn"],"title":"Github Pages 图床","uri":"/github%E5%9B%BE%E5%BA%8A/"},{"categories":["cdn"],"content":"1. 简介 我们之前介绍过可以用 jsdelivr + github 的方式做自己的 cdn 图床，现在介绍另外一种 github pages + cloudfront 的方式 ","date":"2020-10-29","objectID":"/github%E5%9B%BE%E5%BA%8A/:0:0","series":null,"tags":["cdn"],"title":"Github Pages 图床","uri":"/github%E5%9B%BE%E5%BA%8A/#1-简介"},{"categories":["cdn"],"content":"2. github 新创建的 repo 设置 GitHub Pages 因为我之前创建过基于 github 的 blog，所以早早就配置了域名了，开启新的 repo 无需重新搞一个域名，可以参考 Hugo（三）自定义域名\u0026cloudfare github pages 加速https （一）部分，因为这里面我已经配置好 cloudfront 了，这里就不展示了。 ","date":"2020-10-29","objectID":"/github%E5%9B%BE%E5%BA%8A/:0:0","series":null,"tags":["cdn"],"title":"Github Pages 图床","uri":"/github%E5%9B%BE%E5%BA%8A/#2-github-新创建的-repo-设置-github-pages"},{"categories":["cdn"],"content":"Jsdelivr小坑系列","date":"2020-10-29","objectID":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/","series":null,"tags":["cdn"],"title":"Jsdelivr小坑系列","uri":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/"},{"categories":["cdn"],"content":"1. 50m Size 限制 ","date":"2020-10-29","objectID":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/:0:0","series":null,"tags":["cdn"],"title":"Jsdelivr小坑系列","uri":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/#1-50m-size-限制"},{"categories":["cdn"],"content":"1.1 问题 url 访问：https://cdn.jsdelivr.net/gh/ZhaoUncle/images@master/books/20201029101540.png 出现以下错误 Package size exceeded the configured limit of 50 MB. Try https://github.com/ZhaoUncle/images/tree/master/books/20201029101540.png instead. ","date":"2020-10-29","objectID":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/:1:0","series":null,"tags":["cdn"],"title":"Jsdelivr小坑系列","uri":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/#11-问题"},{"categories":["cdn"],"content":"1.2 解决 ","date":"2020-10-29","objectID":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/:2:0","series":null,"tags":["cdn"],"title":"Jsdelivr小坑系列","uri":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/#12-解决"},{"categories":["cdn"],"content":"1.2.1 进入你的 github image repo，然后创建一个 Releases 版本为 “master” 坑：这里必须你是还没满 50M 的时候先创建的 master，否则等满了之后再创建就无效了，所以我这里也是约到坑了，重新创建了一个新的 repo 创建了 master 的 release ","date":"2020-10-29","objectID":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/:2:1","series":null,"tags":["cdn"],"title":"Jsdelivr小坑系列","uri":"/jsdelivr%E5%B0%8F%E5%9D%91%E7%B3%BB%E5%88%97/#121-进入你的-github-image-repo然后创建一个-releases-版本为-master"},{"categories":["cdn"],"content":"Weserv图片缓存","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/"},{"categories":["cdn"],"content":"1. 介绍 images.weserv.nl 具有全球、缓存、调整大小、开源的属性。主要调用 Cloudfare 的 cdn 来实现图片缓存 支持的图片格式有JPEG, PNG, BMP, GIF, TIFF, WebP, PDF, SVG, WebP, GIF 支持 IPV6 可以使用 https://images.weserv.nl/ 直接调用 http图片缓存，用于通过TLS / SSL进行安全连接 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#1-介绍"},{"categories":["cdn"],"content":"2. 使用 该工具最大的地方是可以直接修改图片的大小，快速参考 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#2-使用"},{"categories":["cdn"],"content":"2.1 尺寸 \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026w=300\u0026h=300\u0026dpr=2\"\u003e w：设置图像的宽度，以像素为单位。 h：设置图像的高度，以像素为单位。 dpr：设备像素比，level 1-8. ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:1:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#21-尺寸"},{"categories":["cdn"],"content":"2.2 自调 \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026w=300\u0026h=300\u0026fit=inside\"\u003e 默认。保留宽高比，将图像调整为尽可能大的尺寸，同时确保其尺寸小于或等于指定的尺寸。 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:2:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#22-自调"},{"categories":["cdn"],"content":"2.3 位置 \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026w=300\u0026h=300\u0026fit=cover\u0026a=centor\"\u003e center：默认 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:3:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#23-位置"},{"categories":["cdn"],"content":"2.4 形状 \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026w=300\u0026h=300\u0026fit=cover\u0026mask=circle\"\u003e 效果： circle：圆圈 ellipse triangle triangle-180：三角形倒置倾斜 pentagon pentagon-180：五角大楼倒置倾斜 hexagon square：方形倾斜45度 star：5点星 heart ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:4:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#24-形状"},{"categories":["cdn"],"content":"2.5 方向 \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026h=300\u0026flip\"\u003e \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026h=300\u0026flop\"\u003e \u003cimg src=\"//images.weserv.nl/?url=images.weserv.nl/lichtenstein.jpg\u0026h=300\u0026ro=45\"\u003e flip: 180°翻转 flop：沿 X 轴翻转 ro：沿定制角度翻转 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:5:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#25-方向"},{"categories":["cdn"],"content":"2.6 时长 //images.weserv.nl?url=images.weserv.nl/lichtenstein.jpg\u0026w=100\u0026maxage=31d maxage: 缓存控制时长， d： 天 y：年，365天 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:6:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#26-时长"},{"categories":["cdn"],"content":"2.7 默认图片 \u003cimg src=\"//images.weserv.nl/?url=example.org/noimage.jpg\u0026default=ssl:images.weserv.nl%2F%3Furl%3Dimages.weserv.nl/lichtenstein.jpg%26w%3D300\"\u003e https://images.weserv.nl/?url=https://wfqqreader-1252317822.image.myqcloud.com/cover/71/25066071/t6_25066071.jpg\u0026default=ssl:images.weserv.nl/?url=https://img9.doubanio.com/view/subject/l/public/s26872396.jpg 如果加载图像时出现问题，则显示错误。但是，可能需要将默认图像传递给用户，而不是向用户提供损坏的图像。 该URL不得包含default查询字符串（如果包含，则将被忽略）。 ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:7:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#27-默认图片"},{"categories":["cdn"],"content":"3. 参考资料： https://github.com/weserv/images https://images.weserv.nl/ ","date":"2020-10-14","objectID":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["Weserv图片缓存"],"title":"Weserv图片缓存","uri":"/weserv%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/#3-参考资料"},{"categories":["cdn"],"content":"jsdelivr 缓存刷新","date":"2020-09-30","objectID":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/","series":null,"tags":["cdn"],"title":"jsdelivr 缓存刷新","uri":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/"},{"categories":["cdn"],"content":"1. cdn 缓存 jsDelivr 提供的全球 CDN 加速，CDN的分流作用不仅减少了用户的访问延时，也减少的源站的负载。因为 jsDelivr 是开源的免费 cdn，所以我个人一直在使用他，当然，你可以使用腾讯云，每个月 10G 基本上也足够用了，老用户甚至还要 50G 每月的流量，也着实很香。 缺点： 当网站更新时，如果CDN节点上数据没有及时更新，即便用户在浏览器使用 Ctrl +F5（win）或者 command+shift+R（mac）的强制刷新方式使浏览器端的缓存失效，也会因为CDN边缘节点没有同步最新数据而导致用户端未能及时更新。 ","date":"2020-09-30","objectID":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["cdn"],"title":"jsdelivr 缓存刷新","uri":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/#1-cdn-缓存"},{"categories":["cdn"],"content":"2. jsdelivr的cdn使用规则 其实如何使用 jsdelivr，在官网上面就有介绍了，不过还是简单介绍下我经常使用的 github https://cdn.jsdelivr.net/gh/user/repo@version/file 具体实例： master 仓库的 https://github.com/ZhaoUncle/images #github 原图 https://github.com/ZhaoUncle/images/blob/master/blog/avatar.png #master 默认不需要加版本号 https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/avatar.png #如果你有多个分支多版本管理 https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/avatar.png ","date":"2020-09-30","objectID":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["cdn"],"title":"jsdelivr 缓存刷新","uri":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/#2-jsdelivr的cdn使用规则"},{"categories":["cdn"],"content":"3. jsdelivr 缓存刷新方法 对于 jsDelivr，缓存刷新的方式也很简单，只需将想刷新的链接的开头的cdn 更改为 purge，不过官网说后面会推出刷新工具，我这边还在观望中 https://cdn.jsdelivr.net/ 切换为 https://purge.jsdelivr.net/ **实验：**https://purge.jsdelivr.net/gh/ZhaoUncle/images@master/static/waifu.css 我直接在浏览器访问这个接口得出以下数据，返回status: ok，就代表完成了。 ","date":"2020-09-30","objectID":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["cdn"],"title":"jsdelivr 缓存刷新","uri":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/#3-jsdelivr-缓存刷新方法"},{"categories":["cdn"],"content":"4. 发现推送上去，但是 cdn 打不开？啥原因 其实也就是 cdn 缓存边缘节点还没缓存过去，方法如 3 那样直接 purge 访问强制刷新到边缘节点就好啦。 ","date":"2020-09-30","objectID":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/:0:0","series":null,"tags":["cdn"],"title":"jsdelivr 缓存刷新","uri":"/jsdelivr%E6%B8%85%E7%BC%93%E5%AD%98/#4-发现推送上去但是-cdn-打不开啥原因"},{"categories":["blog"],"content":"博客园搭建个人博客","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/"},{"categories":["blog"],"content":"记得点“推荐”或者“关注”哦！！！ ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#"},{"categories":["blog"],"content":"1. 主题 Cnblogs-Theme-SimpleMemory 1.3.3 版本 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#1-主题"},{"categories":["blog"],"content":"2. 权限申请 先在博客园申请开通博客，这里就不做介绍了，然后在 “博客侧边栏公告” 申请 js 权限（博客侧边栏公告） ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#2-权限申请"},{"categories":["blog"],"content":"3. 博客园后台设置 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#3-博客园后台httpsicnblogscomsettings设置"},{"categories":["blog"],"content":"3.1 用户设置 参数： 标题：主要影响后台的显示； 博客地址名：https://www.cnblog.com/博客地址名/，这个只会修改只能通过邮件申请，我申请过一次，申请完之后用了 js 的话，还会用旧的链接地址访问，需要把 css 和 js 的代码清掉保存，再重新填写再保存，才能快速清除； 登录用户名：这个影响不大，因为下面有个显示名称，就是替换这个的 密码：忽略 显示名称（作者名）：这里会替换掉登录用户名的显示规则，会影响浏览器标签那里的 title，还有显示作者的地方； 邮箱：评论那里可以选择发送邮箱 回复通知邮箱：默认楼上那个 时区：utc+8 即可，北京时间 语言与地区：简体中文 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#31-用户设置"},{"categories":["blog"],"content":"3.2 模板设置 参数： 博客皮肤：选择SimpleMemory 页面定制 CSS 代码： 2.1 CSS代码位置：/src/style/base.min.css ，拷贝此文件代码至页面定制CSS代码文本框处即可。 2.2 /src/style/base.min.css 的修改参考 /src/style/base.css。博客设置请使用压缩版本，直接使用 /src/style/base.css 会字符超限！ 禁用模板默认 CSS：这里要记得 博客侧边栏公告： 4.1 JavaScript 对象是被命名值的容器。值以名称:值对的方式来书写（名称和值由冒号分隔）。 \u003cscript type=\"text/javascript\"\u003e window.cnblogsConfig = { GhVersions : 'v1.3.3', //这里的版本要与最下面的 scripts 引用的 js 版本一致 blogUser : \"欲戴王冠，必承其重...易波叶平\", //用户名，主要是首页打开的为孩子 blogAvatar : \"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/avatar.png\", //用户头像 blogStartDate : \"2017-11-17\", // 入园时间，年-月-日。入园时间查看方法：鼠标停留园龄时间上，会显示入园时间 webpageTitleOnblur: '(oﾟvﾟ)ノ Hi', //离开页面，title 显示的文字 webpageTitleFocus: '(*´∇｀*) 欢迎回来！',//点击页面，title 显示的文字 webpageIcon: \"https://cdn.jsdelivr.net/gh/BNDong/Cnblogs-Theme-SimpleMemory@master/img/webp/blog_logo.webp\", //网站图标 fontIconExtend: \"//at.alicdn.com/t/font_2104671_57vkche3kz2.css\",//字体图标配置，开个小章节单独讲 menuNavList: [ // 菜单导航 ['导航名称', '链接', 'icon'] ['Blog', 'https://zhaouncle.com/', 'icon-blog-solid'], ['CMS', 'https://link.zhaouncle.com/', 'icon-logo1'], ['k8sYaml 生成器', 'https://k8syaml.com/', 'iconkubernetes1'],//这里的iconkubernetes1就是用的我自己的图标库来配置的，默认不自带 ], //homeBannerText: \"好好学习，天天向上！\",我这里不设置，用的主题的自动获取，默认获取诗词 //homeBannerTextType: \"jinrishici\", //jinrishici：每次刷新随机获取一句古诗词;one：每日获取一句话 homeTopImg: [ //首页轮播图，可以设置多个进行轮播 \"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/home_top_bg.webp\", \"https://cdn.jsdelivr.net/gh/BNDong/Cnblogs-Theme-SimpleMemory@master/img/webp/home_top_bg.webp\" ], essayTopImg: [//文章页面最上面那个图片，每次刷新随机选择 \"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/nothome_top_bg.webp\", \"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/wallhaven-4o5zm9.webp\" ], menuUserInfoBgImg: 'https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/menu_bg.gif',//菜单栏个人信息背景图 codeLineNumber: true, //代码行号渲染 essayCodeHighlightingType: \"prettify\",//代码渲染高亮 essayCodeHighlighting: \"obsidian\", // 代码渲染主题 footerStyle: 2,// 页脚样式，默认有 1、2 两种 bottomText: { //页脚标语 left : \"长风破浪会有时\", right: \"直挂云帆济沧海\", }, reward: { //文章打赏按钮，显示在页面右下角。 enable: true, wechatpay: 'https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/WechatPay.png',//我这里设置的赞赏码 alipay: 'https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/Alipay.png',//支付宝付款码 }, bottomBlogroll: [ // 友情链接，[[链接名,链接]....] [\"易波叶平\", 'https://zhaouncle.com/'], ], consoleList: [ //浏览器 console 输出 ['Zhaouncle CNBlogs', 'https://www.cnblogs.com/UncleZhao/'], ], advertising: true, //博客园广告 } \u003c/script\u003e \u003cscript src=\"https://cdn.jsdelivr.net/gh/BNDong/Cnblogs-Theme-SimpleMemory@v1.3.3/src/script/simpleMemory.min.js\" defer\u003e\u003c/script\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#32-模板设置"},{"categories":["blog"],"content":"3.3 开启公告控件 公告这里要选上，否则部分 js 文件会无法生效，其他的就自行参考自己的需要了。 到了这一步，基本上一个完整的博客主题就搭建完成了，保存即可自由玩耍写博客了。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#33-开启公告控件"},{"categories":["blog"],"content":"4. 功能扩展 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4-功能扩展"},{"categories":["blog"],"content":"4.1 菜单栏图标 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#41-菜单栏图标"},{"categories":["blog"],"content":"4.1.1 查看菜单栏 字体图标库 列举了部分内置的图标，但是还有一些需要自定义，比如 “k8sYmal 生成器” 这个图标就没有内置，需要我们自己去 iconfont ，阿里的图标库自定义。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#411-查看菜单栏"},{"categories":["blog"],"content":"4.1.2 登录 iconfont 我一开始选择“Github”登录的方式，但是直接报错了，所以我只能选择“新浪微博”的登录方式，主要是我不玩微博，我觉得很蛋疼 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#412-登录-iconfonthttpswwwiconfontcn"},{"categories":["blog"],"content":"4.1.3 创建项目 我们先进到 “资源管理” – “我发起的项目” ，创建一个 “博客园” 项目，如图所示 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#413-创建项目"},{"categories":["blog"],"content":"4.1.4 生成代码 然后生成代码，填入 3.2 的 “博客侧边栏公告” 的 js 对象 fontIconExtend 更换成你自己的就行了，这个要添加图标进去后才能生成。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:4","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#414-生成代码"},{"categories":["blog"],"content":"4.1.5 图标加入购物车 你可以直接搜索 “kubernetes”，也可以直接一个一个搜，不过一般不会这么傻吧？哈哈。重要的是选中图标，把鼠标移到图标上面，然后添加进购物车 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:5","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#415-图标加入购物车"},{"categories":["blog"],"content":"4.1.6 从购物车添加至项目 点击购物车图标，然后 “添加至项目” 即可，当然你也可以忽略前面创建项目的步骤，直接在这里的选中添加项目也行，随你自己喜欢了。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:6","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#416-从购物车添加至项目"},{"categories":["blog"],"content":"4.1.7 添加成功 点击确定，就添加成功了，然后在“生成代码”就好啦，鼠标移动到图标上面，直接复制代码， ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:7","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#417-添加成功"},{"categories":["blog"],"content":"4.1.8 配置 js 对象 然后直接生成代码，香气十足，再配置到 3.2 的 js 对象 “menuNavList”，完美添加图标了，当然你也可以自己制作图标然后上传使用。 menuNavList: [ // 菜单导航 ['导航名称', '链接', 'icon'] ['k8sYaml 生成器', 'https://k8syaml.com/', 'iconkubernetes1'],//这里的iconkubernetes1就是用的我自己的图标库来配置的，默认不自带 ], ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:1:8","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#418-配置-js-对象"},{"categories":["blog"],"content":"4.2 鼠标点击特效 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#42-鼠标点击特效"},{"categories":["blog"],"content":"4.2.1 鼠标特效 4.2.1.1 烟花特效，我自己在使用的 4.2.1.2 文字特效 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#421-鼠标特效"},{"categories":["blog"],"content":"4.2.1 鼠标特效 4.2.1.1 烟花特效，我自己在使用的 4.2.1.2 文字特效 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4211-烟花特效我自己在使用的"},{"categories":["blog"],"content":"4.2.1 鼠标特效 4.2.1.1 烟花特效，我自己在使用的 4.2.1.2 文字特效 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4212-文字特效"},{"categories":["blog"],"content":"4.2.2 添加鼠标图像 在博客园的设置那里，我们在 “页面定制 CSS 代码” 的“body” 代码块添加如下几句代码，这几句代码主要添加鼠标的展示图，至于点击效应在下面的 js 代码块里面。如下图所示 注意：至于如何快速找到 body，要么你直接浏览器 F12 搜，要么把 css 代码 copy 出来咯，改完再放进去不就好了吗 background-repeat: repeat;background-attachment: fixed;background-size:cover;cursor: url(https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/cursor.ico),auto; ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#422-添加鼠标图像"},{"categories":["blog"],"content":"4.2.3 添加 js 代码 注意：特效只需要添加一种即可 4.2.3.1 烟花特效 在 **“页首 HTML 代码” **那里添加以下代码 \u003c!--鼠标点击特效，烟花效应--\u003e \u003cscript src=\"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/static/mouse-click.js\"\u003e\u003c/script\u003e \u003ccanvas width=\"1777\" height=\"841\" style=\"position: fixed; left: 0px; top: 0px; z-index: 2147483647; pointer-events: none;\"\u003e\u003c/canvas\u003e 4.2.3.2 文字特效 在 **“页首 HTML 代码” **那里添加以下代码 \u003cscript type=\"text/javascript\"\u003e /* 鼠标特效，文字特效 */ var a_idx = 0; jQuery(document).ready(function($) { $(\"body\").click(function(e) { var a = new Array(\"❤富强❤\",\"❤民主❤\",\"❤文明❤\",\"❤和谐❤\",\"❤自由❤\",\"❤平等❤\",\"❤公正❤\",\"❤法治❤\",\"❤爱国❤\",\"❤敬业❤\",\"❤诚信❤\",\"❤友善❤\"); var $i = $(\"\u003cspan\u003e\u003c/span\u003e\").text(a[a_idx]); a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ \"z-index\": 999999999999999999999999999999999999999999999999999999999999999999999, \"top\": y - 20, \"left\": x, \"position\": \"absolute\", \"font-weight\": \"bold\", \"color\": \"rgb(\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\")\" }); $(\"body\").append($i); $i.animate({ \"top\": y - 180, \"opacity\": 0 }, 1500, function() { $i.remove(); }); }); }); \u003c/script\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#423-添加-js-代码"},{"categories":["blog"],"content":"4.2.3 添加 js 代码 注意：特效只需要添加一种即可 4.2.3.1 烟花特效 在 **“页首 HTML 代码” **那里添加以下代码 4.2.3.2 文字特效 在 **“页首 HTML 代码” **那里添加以下代码 /* 鼠标特效，文字特效 */ var a_idx = 0; jQuery(document).ready(function($) { $(\"body\").click(function(e) { var a = new Array(\"❤富强❤\",\"❤民主❤\",\"❤文明❤\",\"❤和谐❤\",\"❤自由❤\",\"❤平等❤\",\"❤公正❤\",\"❤法治❤\",\"❤爱国❤\",\"❤敬业❤\",\"❤诚信❤\",\"❤友善❤\"); var $i = $(\"\").text(a[a_idx]); a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ \"z-index\": 999999999999999999999999999999999999999999999999999999999999999999999, \"top\": y - 20, \"left\": x, \"position\": \"absolute\", \"font-weight\": \"bold\", \"color\": \"rgb(\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\")\" }); $(\"body\").append($i); $i.animate({ \"top\": y - 180, \"opacity\": 0 }, 1500, function() { $i.remove(); }); }); }); ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4231-烟花特效"},{"categories":["blog"],"content":"4.2.3 添加 js 代码 注意：特效只需要添加一种即可 4.2.3.1 烟花特效 在 **“页首 HTML 代码” **那里添加以下代码 4.2.3.2 文字特效 在 **“页首 HTML 代码” **那里添加以下代码 /* 鼠标特效，文字特效 */ var a_idx = 0; jQuery(document).ready(function($) { $(\"body\").click(function(e) { var a = new Array(\"❤富强❤\",\"❤民主❤\",\"❤文明❤\",\"❤和谐❤\",\"❤自由❤\",\"❤平等❤\",\"❤公正❤\",\"❤法治❤\",\"❤爱国❤\",\"❤敬业❤\",\"❤诚信❤\",\"❤友善❤\"); var $i = $(\"\").text(a[a_idx]); a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ \"z-index\": 999999999999999999999999999999999999999999999999999999999999999999999, \"top\": y - 20, \"left\": x, \"position\": \"absolute\", \"font-weight\": \"bold\", \"color\": \"rgb(\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\",\"+~~(255*Math.random())+\")\" }); $(\"body\").append($i); $i.animate({ \"top\": y - 180, \"opacity\": 0 }, 1500, function() { $i.remove(); }); }); }); ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4232-文字特效"},{"categories":["blog"],"content":"4.2.4 结束语 如上就能完成鼠标的特效了，当然特效也不止这一种，剩下的等以后有兴趣再试了。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:2:4","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#424-结束语"},{"categories":["blog"],"content":"4.3 网站统计 CNZZ 也就是友盟的网站统计功能，主题整合 CNZZ 网站统计，并对样式进行了优化。如果需要本功能，请首先去 CNZZ 配置网站的统计，然后修改下面的代码，添加至页脚 Html 代码中。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#43-网站统计"},{"categories":["blog"],"content":"4.3.1 配置 CNZZ 网址：U-Web ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#431-配置-cnzz"},{"categories":["blog"],"content":"4.3.2 添加站点 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#432-添加站点"},{"categories":["blog"],"content":"4.3.3 获取统计代码 ID ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#433-获取统计代码-id"},{"categories":["blog"],"content":"4.3.4 开启详细数据 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:4","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#434-开启详细数据"},{"categories":["blog"],"content":"4.3.4 配置页脚 HTML 代码 进入博客园后台设置，配置页脚 HTML 代码，将 4.3.3 的统计 ID 替换，然后 copy 进去 \u003c!--友盟访问统计--\u003e \u003cdiv id=\"cnzzProtocol\" style=\"display: none;\"\u003e \u003cspan class=\"id_cnzz_stat_icon\" id='cnzz_stat_icon_你的统计ID'\u003e\u003c/span\u003e \u003cscript src='https://v1.cnzz.com/z_stat.php?id=你的统计ID\u0026online=1\u0026show=line' type='text/javascript'\u003e\u003c/script\u003e \u003c/div\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:3:5","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#434-配置页脚-html-代码"},{"categories":["blog"],"content":"4.4 天气预报 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#44-天气预报"},{"categories":["blog"],"content":"4.4.1 心知天气 注册登录，这就我无需多说啦！ ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#441-心知天气"},{"categories":["blog"],"content":"4.4.2 天气插件 Weather Widget，我们这里直接点击 “立即免费试用” 就可以啦。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#442-天气插件"},{"categories":["blog"],"content":"4.4.3 天气插件配置 4.4.3.1 自定义配置 自动定位：这里不知为何我电脑定位到“福州”，所以我干脆关了算了，可能是免费版导致的。 4.4.3.2 生成代码 将生成的 JS 代码复制到 “页脚 HTML 代码”中，放在 4.3 网站统计的下面就好。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#443-天气插件配置"},{"categories":["blog"],"content":"4.4.3 天气插件配置 4.4.3.1 自定义配置 自动定位：这里不知为何我电脑定位到“福州”，所以我干脆关了算了，可能是免费版导致的。 4.4.3.2 生成代码 将生成的 JS 代码复制到 “页脚 HTML 代码”中，放在 4.3 网站统计的下面就好。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4431-自定义配置"},{"categories":["blog"],"content":"4.4.3 天气插件配置 4.4.3.1 自定义配置 自动定位：这里不知为何我电脑定位到“福州”，所以我干脆关了算了，可能是免费版导致的。 4.4.3.2 生成代码 将生成的 JS 代码复制到 “页脚 HTML 代码”中，放在 4.3 网站统计的下面就好。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4432-生成代码"},{"categories":["blog"],"content":"4.4.4 效果如图所示 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:4:4","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#444-效果如图所示"},{"categories":["blog"],"content":"4.5 背景图片 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:5:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#45-背景图片"},{"categories":["blog"],"content":"4.5.1 原因 打开一篇博文，你是否因其空荡荡的背景而觉得索然无味呢？这个时候我没就要利用自己强大的 copy 能力，给自己找张好看的背景丢上去咯 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:5:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#451-原因"},{"categories":["blog"],"content":"4.5.2 配置到 CSS 的 body 代码段 background-image: url(\"https://img2018.cnblogs.com/blog/1358881/201909/1358881-20190910100015098-837598352.jpg\"); 如图所示： ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:5:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#452-配置到-css-的-body-代码段"},{"categories":["blog"],"content":"4.5.1 效果图如下 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:5:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#451-效果图如下"},{"categories":["blog"],"content":"4.6 网抑云音乐 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:6:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#46-网抑云音乐"},{"categories":["blog"],"content":"4.6.0 效果图 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:6:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#460-效果图"},{"categories":["blog"],"content":"4.6.1 获取网抑云 ID 打开网页版网抑云，然后选择你想播放的歌单，歌单可以是你自己的也可以是别人的，只要歌曲能播放就行，然后把 uri 后面的 id 给 copy 出来 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:6:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#461-获取网抑云-id"},{"categories":["blog"],"content":"4.6.2 代码添加 将一下代码添加至页脚Html代码中，更改 歌单 ID 为你自己的即可 \u003c!-- require APlayer --\u003e \u003clink rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css\"\u003e \u003cscript src=\"https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js\"\u003e\u003c/script\u003e \u003c!-- require MetingJS --\u003e \u003cscript src=\"https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js\"\u003e\u003c/script\u003e \u003cmeting-js id=\"歌单ID\" lrc-type=\"0\" server=\"netease\" order=\"random\" type=\"playlist\" fixed=\"true\" list-olded=\"true\"\u003e \u003c/meting-js\u003e 如图所示，代码存放位置，直接放在之前的代码后面就行 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:6:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#462-代码添加"},{"categories":["blog"],"content":"4.7 去掉反对按钮 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:7:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#47-去掉反对按钮"},{"categories":["blog"],"content":"4.7.1 何谓反对按钮 看到这个按钮，下意识就想删了，大家可不要给我反对哦，否则就不更新了呢，不过我也不给你这个按钮，哈哈！ ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:7:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#471-何谓反对按钮"},{"categories":["blog"],"content":"4.7.2 在配置 CSS 在 **页面定制 CSS 代码 ** 里面直接在最后一行添加一下代码即可，记得保存由 #rightBuryit{display: none !important;}.buryit{display: none;} 如图所示： ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:7:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#472-在配置-css"},{"categories":["blog"],"content":"4.7.3 效果图 这个时候我们再看就没有啦，我是不是很鸡贼呢？ ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:7:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#473-效果图"},{"categories":["blog"],"content":"4.8 复制文字加版权 当用户复制文中内容(ctrl+C或鼠标右击复制)时，会自动加上版权文字，csdn的代码复制以及知乎的内容复制都有此功能。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:8:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#48-复制文字加版权"},{"categories":["blog"],"content":"4.8.1 添加到**页首 HTML 代码 ** \u003c!--自动复制添加版权--\u003e \u003cscript language=\"javascript\" type=\"text/javascript\"\u003e jQuery(document).on('copy', function(e) { var selected = window.getSelection(); var selectedText = selected.toString().replace(/\\n/g, '\u003cbr\u003e'); // Solve the line breaks conversion issue 处理换行转换的问题 var copyFooter = '\u003cbr\u003e---------------------\u003cbr\u003e著作权归作者所有。\u003cbr\u003e' + '商业转载请联系作者获得授权，非商业转载请注明出处。\u003cbr\u003e' + '作者：易波叶平\u003cbr\u003e 源地址：' + document.location.href + '\u003cbr\u003e来源：博客园cnblogs\u003cbr\u003e© 版权声明：本文为博主原创文章，转载请附上博文链接！'; var copyHolder = $('\u003cdiv\u003e', {id: 'temp', html: selectedText + copyFooter, style: {position: 'absolute', left: '-99999px'}}); $('body').append(copyHolder); selected.selectAllChildren( copyHolder[0] ); window.setTimeout(function() { copyHolder.remove(); },0); }); \u003c/script\u003e 如图所示：直接在鼠标特效后面换行加上就好，然后及的保存 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:8:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#481-添加到页首-html-代码-"},{"categories":["blog"],"content":"4.9 看板娘 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:9:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#49-看板娘"},{"categories":["blog"],"content":"4.9.1 效果图 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:9:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#491-效果图"},{"categories":["blog"],"content":"4.9.2 所有文件 可以私聊博主要，博主没有藏私，也可以在下面的代码里面自己获取，如果合适，请给个推荐和关注，感谢博主的无私贡献，虽然博主也是从其他地方获取来着。 点击推荐和关注才会下载哦，不然会出错的呢 emmmm!!! ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:9:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#492-所有文件"},{"categories":["blog"],"content":"4.9.3 “博客侧边栏公告 ”设置 \u003c!--看板娘--\u003e \u003cdiv class=\"waifu\" id=\"waifu\"\u003e \u003cdiv class=\"waifu-tips\" style=\"opacity: 1;\"\u003e\u003c/div\u003e \u003ccanvas id=\"live2d\" width=\"280\" height=\"250\" class=\"live2d\"\u003e\u003c/canvas\u003e \u003cdiv class=\"waifu-tool\"\u003e \u003cspan class=\"fui-home\"\u003e\u003c/span\u003e \u003cspan class=\"fui-chat\"\u003e\u003c/span\u003e \u003cspan class=\"fui-eye\"\u003e\u003c/span\u003e \u003cspan class=\"fui-user\"\u003e\u003c/span\u003e \u003cspan class=\"fui-photo\"\u003e\u003c/span\u003e \u003cspan class=\"fui-info-circle\"\u003e\u003c/span\u003e \u003cspan class=\"fui-cross\"\u003e\u003c/span\u003e \u003c/div\u003e \u003c/div\u003e \u003cscript src=\"https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/static/kanbanniang/live2d.js\"\u003e\u003c/script\u003e \u003cscript src=\"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/static/kanbanniang/waifu-tips.js\"\u003e\u003c/script\u003e \u003cscript type=\"text/javascript\"\u003einitModel()\u003c/script\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:9:3","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#493-博客侧边栏公告-设置"},{"categories":["blog"],"content":"4.9.4 “页首 HTML 代码”配置 \u003c!--看板娘--\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/static/kanbanniang/waifu.css\"/\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/static/kanbanniang/flat-ui.min.css\"/\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:9:4","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#494-页首-html-代码配置"},{"categories":["blog"],"content":"4.10 更改置顶图标 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:10:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#410-更改置顶图标"},{"categories":["blog"],"content":"4.10.1 效果图 原本是 iconfont 的默认图标，我这里用个小火箭给替代了。 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:10:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4101-效果图"},{"categories":["blog"],"content":"4.10.2 配置 在页面定制 CSS 代码那里最后直接追加即可，记得选择保存哦！ i.iconfont.icon-zhiding {background: url(https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/o_rocket.png) no-repeat center center;} ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:10:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4102-配置"},{"categories":["blog"],"content":"4.11 评论区优化 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:11:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#411-评论区优化"},{"categories":["blog"],"content":"4.11.1效果图 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:11:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4111效果图"},{"categories":["blog"],"content":"4.11.2 配置 “页面定制 CSS 代码 ” #tbCommentBody {background: #fff url(https://gitee.com/dbnuo/Cnblogs-Theme-SimpleMemory/raw/master/img/comment_bg.jpg) right -65px;background-size: 250px;background-repeat: no-repeat;} ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:11:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4112-配置-页面定制-css-代码-"},{"categories":["blog"],"content":"4.12 放大图片（low） ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:12:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#412-放大图片low"},{"categories":["blog"],"content":"4.12.1 配置 “页面定制 CSS 代码 ” .post img {cursor: pointer;transition: all 0.5s;}.post img:hover {transform: scale(1.3);} ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:12:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4121-配置-页面定制-css-代码-"},{"categories":["blog"],"content":"4.13 个人书单 ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:13:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#413-个人书单"},{"categories":["blog"],"content":"4.13.1 创建随笔 markdown 格式直接创建一个新“随笔”，然后 markdown 文档模式添加已下数据即可 \u003cinput id=\"bookListFlg\" type=\"hidden\"\u003e ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:13:1","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4131-创建随笔"},{"categories":["blog"],"content":"4.13.2 配置书单数据 博客侧边栏公告设置，因为数据量很大，直接在最后一行新起，就不嵌套在原有的配置里面，不过我觉得后期应该直接加到 github管理引用才方便，期待中。 \u003c!--书单--\u003e \u003cscript type=\"text/javascript\"\u003e window.cnblogsConfig.bookList = [ { title: '在读', books: [ { cover: 'https://images.weserv.nl/?url=https://wfqqreader-1252317822.image.myqcloud.com/cover/71/25066071/t6_25066071.jpg\u0026default=ssl:images.weserv.nl/?url=https://img3.doubanio.com/view/subject/l/public/s29962521.jpg', name: '断舍离', formerNname: '', author: '[日]山下英子', translator: '贾耀平', press: '湖南文艺出版社', year: '2019-01|2020-10-14', score: 2, } ] }, { title: '已读', books: [ { cover: 'https://images.weserv.nl/?url=https://wfqqreader-1252317822.image.myqcloud.com/cover/509/413509/t6_413509.jpg\u0026default=ssl:images.weserv.nl/?url=https://img3.doubanio.com/view/subject/l/public/s27311101.jpg', name: '知行合一王阳明', formerNname: '', author: '度阴山', translator: '', press: '北京联合出版公司', year: '2014-07|2020-04', score: 4, }, ] }, ]; \u003c/script\u003e 如图所在位置所示： ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:13:2","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#4132-配置书单数据"},{"categories":["blog"],"content":"5. 参考资料 https://github.com/BNDong/Cnblogs-Theme-SimpleMemory https://bndong.github.io/Cnblogs-Theme-SimpleMemory/v1.1/#/ https://www.cnblogs.com/wkfvawl/p/9414180.html https://github.com/metowolf/MetingJS https://www.cnblogs.com/enjoy233/p/10328361.html#%E5%A4%8D%E5%88%B6%E6%AD%A3%E6%96%87%E6%96%87%E5%AD%97%E6%97%B6%E8%87%AA%E5%8A%A8%E5%8A%A0%E7%89%88%E6%9D%83 https://www.cnblogs.com/yjlaugus/p/8724881.html#/c/subject/p/8724881.html https://live2d.fghrsh.net/demo/1.4.2/ https://github.com/fghrsh/live2d_demo ","date":"2020-09-27","objectID":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/:0:0","series":null,"tags":["博客"],"title":"博客园主题","uri":"/%E5%8D%9A%E5%AE%A2%E5%9B%ADthemes/#5-参考资料"},{"categories":["浏览器"],"content":"Chrome 谷歌浏览器书签同步方法","date":"2020-09-02","objectID":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/","series":null,"tags":["Chrome","谷歌浏览器"],"title":"Chrome 书签同步","uri":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/"},{"categories":["浏览器"],"content":"1. 使用 Chrome 插件：书签同步 点击下面的超链接就可以进入 Chrome 应用商店去安装和使用了。 https://chrome.google.com/webstore/detail/%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/fbcbemgibdnpboehnfcnkegefaomnlbk?hl=zh-CN 使用这款 Chrome 插件之前你需要申请 github 账号，并配置 token 。 登录Github，在 Settings-\u003ePersonal access tokens-\u003eGenerate new token 生成一个访问token，点击 https://github.com/settings/tokens/new 这个超链接，就是创建你的token。 可以通过以下链接，创建一个 github 私有仓库 “Private” 就可以，这是这个插件好用的地方。 https://github.com/new 点击插件，依次输入“github 用户名”——“github token”——“github 仓库名称/bookmark.json” “书签插件”，左键点击可以直接配置选项 Username：表示github 用户名 Axxess Token：github上生成的token Path是仓库名名称，或者仓库名称+“/”+文件名 Upload：是上传到git上面(每次使用书签后 请点击上传) Download： 是下载网络上的书签 （换电脑以后可以点击download进行同步） Remember Me：是指记住这些配置 上传结果演示 ","date":"2020-09-02","objectID":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/:1:0","series":null,"tags":["Chrome","谷歌浏览器"],"title":"Chrome 书签同步","uri":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/#1-使用-chrome-插件书签同步"},{"categories":["浏览器"],"content":"2. 注意 至于是否需要先关闭chrome的同步功能，这个待测试，如果不影响，那我觉得不需要关闭，随它就行！！！ chrome://settings/syncSetup/advanced?search=%E5%90%8C%E6%AD%A5 ","date":"2020-09-02","objectID":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/:2:0","series":null,"tags":["Chrome","谷歌浏览器"],"title":"Chrome 书签同步","uri":"/chrome%E4%B9%A6%E7%AD%BE%E5%90%8C%E6%AD%A5/#2-注意"},{"categories":["hugo"],"content":"Typora + PicGo 编写 hugo md + 图床","date":"2020-08-24","objectID":"/picgo_typora/","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/"},{"categories":["hugo"],"content":"1.下载 PicGo：https://github.com/Molunerfinn/PicGo Typora：https://www.typora.io/ ","date":"2020-08-24","objectID":"/picgo_typora/:1:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#1下载"},{"categories":["hugo"],"content":"2.软件学习地址 少数派： Typora：https://sspai.com/search/post/Typora PicGo：https://sspai.com/search/post/PicGo ","date":"2020-08-24","objectID":"/picgo_typora/:2:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#2软件学习地址"},{"categories":["hugo"],"content":"3.介绍 Typora 是专注于编写 Markdown 格式的编辑软件，使用方便，支持多种格式导出。 PicGo 是一款免费的图床管理应用，支持拖拽上传，剪切板上传等方式。你可以用它快捷地将图片上传到图床并获得网络链接。 注意：请不要把 PicGo 安装到 C 盘 Program Files 下 ","date":"2020-08-24","objectID":"/picgo_typora/:3:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#3介绍"},{"categories":["hugo"],"content":"4.为什么需要图床 Markdown 可以理解为增强版的文本文档，语法简单，支持更多的风格样式，相比 word 更加轻便，文件大小更小，同时可导出为指定格式，目前大多是技术博客论坛已支持 Markdown 格式，基本上可以做到一次编写多处使用。当然 Markdown 也存在缺点，比如图片。 Markdown 文档编写时可使用本地图片，但是无法在网络上使用。图床的作用可以理解为将文档中的图片放到网络上，直接引用网络地址，这样可以做到无论在那个平台都可以使用统一的图片地址。 搭建图床教程较多此处不做讨论，作者使用的是 github 搭建的免费图床。 ","date":"2020-08-24","objectID":"/picgo_typora/:4:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#4为什么需要图床"},{"categories":["hugo"],"content":"5.设置 GitHub Toekn 参考：https://docs.github.com/cn/github/authenticating-to-github/creating-a-personal-access-token Token 权限只要设置 “repo” 即可。 token： |-seetings |-- Developer settings |------Personal access tokens 下生成 注意：token 只会显示一次，记得保存如果你不建议重新配置一次的话 ","date":"2020-08-24","objectID":"/picgo_typora/:5:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#5设置-github-toekn"},{"categories":["hugo"],"content":"6.配置 PicGo (GitHub) 图床 参考：https://picgo.github.io/PicGo-Doc/zh/guide/config.html#github%E5%9B%BE%E5%BA%8A ","date":"2020-08-24","objectID":"/picgo_typora/:6:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#6配置-picgo-github-图床"},{"categories":["hugo"],"content":"7. 使用了 CDN 加速 https://cdn.jsdelivr.net/gh/用户名/仓库名 ","date":"2020-08-24","objectID":"/picgo_typora/:7:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#7-使用了-cdn-加速"},{"categories":["hugo"],"content":"8.Typora 设置 记得“验证图片上传选项” ","date":"2020-08-24","objectID":"/picgo_typora/:8:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#8typora-设置"},{"categories":["hugo"],"content":"9. 之后你截图然后直接复制到 Typora，它就会自动转化为 markdown 的图片格式并指向你设置的 github 的 url 地址了。 ","date":"2020-08-24","objectID":"/picgo_typora/:9:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#9-之后你截图然后直接复制到-typora它就会自动转化为-markdown-的图片格式并指向你设置的-github-的-url-地址了"},{"categories":["hugo"],"content":"10.MyHugoBlog 设置子模块到 images 这一步是介于之前的 hugo 的配置，其它人可以忽略。 MyBlogHugo/static/ rm -rf images git submodule add https://github.com/ZhaoUncle/images.git images cd MyBlogHugo #添加 sub pull 到 deploy.sh 脚本 gitsubmoduleImages(){ cd static/images/ git submodule foreach git pull } ","date":"2020-08-24","objectID":"/picgo_typora/:10:0","series":null,"tags":["hugo","图床"],"title":"Typora + PicGo 编写 hugo md + 图床","uri":"/picgo_typora/#10myhugoblog-设置子模块到-images"},{"categories":["Tips"],"content":"微信公众号文章搜索方法","date":"2020-08-19","objectID":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/","series":null,"tags":["Tips"],"title":"Wechat_文章搜索方法","uri":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/"},{"categories":["Tips"],"content":"问题： 最近因为学习 jenkins pipeline，加了一堆公众号，现在轮到自己，头疼了！！！ 怎么根据关键字去搜索所有公众号文章呢？ ","date":"2020-08-19","objectID":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/:0:0","series":null,"tags":["Tips"],"title":"Wechat_文章搜索方法","uri":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/#"},{"categories":["Tips"],"content":"1. 手机移动端微信客户端搜索 ","date":"2020-08-19","objectID":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/:0:1","series":null,"tags":["Tips"],"title":"Wechat_文章搜索方法","uri":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/#1-手机移动端微信客户端搜索"},{"categories":["Tips"],"content":"2. pc 端微信客户端搜索 这里的“搜一搜”就是啦 ","date":"2020-08-19","objectID":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/:0:2","series":null,"tags":["Tips"],"title":"Wechat_文章搜索方法","uri":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/#2-pc-端微信客户端搜索"},{"categories":["Tips"],"content":"3. 搜狗 web端搜索 地址：https://weixin.sogou.com/ ","date":"2020-08-19","objectID":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/:0:3","series":null,"tags":["Tips"],"title":"Wechat_文章搜索方法","uri":"/wechat_%E6%96%87%E7%AB%A0%E6%90%9C%E7%B4%A2/#3-搜狗-web端搜索"},{"categories":["Thoughts","三毛"],"content":"三毛相关摘抄","date":"2020-08-12","objectID":"/%E4%B8%89%E6%AF%9B/","series":null,"tags":["三毛"],"title":"三毛","uri":"/%E4%B8%89%E6%AF%9B/"},{"categories":["Thoughts","三毛"],"content":" 黄昏,落雾了,沉沉的,沉沉的雾。 爱情如果不落到穿衣、吃饭、睡觉、数钱这些实实在在的生活中去,是不会长久的。真正的爱情,就是不紧张,就是可以在他面前无所顾忌地打嗝、放屁、挖耳朵、流鼻涕;真正爱你的人,就是那个你可以不洗脸、不梳头、不化妆见到的那个人。 ","date":"2020-08-12","objectID":"/%E4%B8%89%E6%AF%9B/:0:0","series":null,"tags":["三毛"],"title":"三毛","uri":"/%E4%B8%89%E6%AF%9B/#"},{"categories":["Thoughts","三毛"],"content":"《如果有来生》 如果有来生，要做一棵树， 站成永恒。没有悲欢的姿势， 一半在尘土里安详， 一半在风里飞扬； 一半洒落荫凉， 一半沐浴阳光。 非常沉默、非常骄傲。 从不依靠、从不寻找。 如果有来生，要化成一阵风， 一瞬间也能成为永恒。 没有善感的情怀，没有多情的眼睛。 一半在雨里洒脱， 一半在春光里旅行； 寂寞了，孤自去远行， 把淡淡的思念统统带走， 从不思念、从不爱恋； 如果有来生，要做一只鸟， 飞越永恒，没有迷途的苦恼。 东方有火红的希望， 南方有温暖的巢床， 向西逐退残阳，向北唤醒芬芳。 如果有来生， 希望每次相遇， 都能化为永恒。 ","date":"2020-08-12","objectID":"/%E4%B8%89%E6%AF%9B/:0:0","series":null,"tags":["三毛"],"title":"三毛","uri":"/%E4%B8%89%E6%AF%9B/#如果有来生"},{"categories":["Thoughts","电视剧"],"content":"电视剧《三十而已》","date":"2020-08-09","objectID":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/","series":null,"tags":["三十而已"],"title":"三十而已","uri":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/"},{"categories":["Thoughts","电视剧"],"content":"《婚礼誓词》——假想 注：电视剧里面第六集，钟晓芹写给同事的结婚 从今天起， ​ 不管多忙， ​ 我们都要一起吃饭， ​ 饭桌上不玩手机、不开电视， ​ 我们只聊家常。 从今天起， ​ 我不会再跟你吵架， ​ 万一要吵， ​ 今日架今日毕， ​ 我不能让你带着烦恼进入梦乡。 从今天起， ​ 我不会再养任何小动物了， ​ 因为在这个世界上， ​ 任何小猫小鱼小狗， ​ 都不如你可爱！ 从今天起， ​ 项链和耳环 ​ 你就别再对着镜子较劲， ​ 我帮你戴， ​ 为你摘。 从今天起， ​ 在你的世界里， ​ 我不会沉默和假睡， ​ 我保证， ​ 永不失联。 我们一起 ​ 携手抵抗婚姻当中的 ​ 平淡、焦虑和无常. 我们一起 ​ 面对岁月里的 ​ 衰老、健忘和肥胖。 我们一起 ​ 去创造新的生命， ​ 送他们远行， ​ 等他们回家！ ","date":"2020-08-09","objectID":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/:0:0","series":null,"tags":["三十而已"],"title":"三十而已","uri":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/#婚礼誓词假想"},{"categories":["Thoughts","电视剧"],"content":"《顾家》 注：第十六集，三姐妹之顾佳的后顾无忧 人， ​ 不担心后路 ​ 唯一的方式 ​ 就是要把前路 ​ 走长， 就， ​ 像这咖啡 ​ 你一开始 ​ 喝的时候 ​ 觉得它苦， 但， ​ 喝久了 ​ 反而会享受 ​ 这种苦涩带来的 ​ 刺激， 隔几天不喝， ​ 你还会想念 ​ 这种苦涩呢， 所以啊， ​ 再过五年之后 ​ 我们也许回过头来， 看看， ​ 今天遇到的磕磕绊绊 ​ 反而会感激呢 ","date":"2020-08-09","objectID":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/:0:0","series":null,"tags":["三十而已"],"title":"三十而已","uri":"/%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2/#顾家"},{"categories":["Notion"],"content":"Notion 绑定自定义域名","date":"2020-07-28","objectID":"/notion/","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/"},{"categories":["Notion"],"content":"Notion 绑定自定义域名 自定义域名是个很常见的需求，很多 Notion 用户拿 Notion 作博客，想给自己绑定个性化的域名却发现没有很好的途径，最后域名只能做个转发，跳转到 Notion 官方页面。 考虑到很多 Notion 用户并非程序员，所以这个文章不会解释过多的技术细节，是新手向的教程。 按照下面的教程做完，将会实现。 通过自己的域名访问 Notion 浏览器地址上显示自己的域名 访问页面时会有一定程度的加速效果 ","date":"2020-07-28","objectID":"/notion/:0:0","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/#notion-绑定自定义域名"},{"categories":["Notion"],"content":"原理说明 官方目前不打算推出自定义域名的特性。如果你将自己的域名设置为隐式转发会在前端看到一个这样的提示。 其主要的检验手段是在前端 js 做校验， Notion 是一个典型的单页应用，利用 Cloudflare 的 worker 做代理，将 js 中的 notion.so 全部替换成自己的域名，这样即可绕过校验。 如果访问 app.js，则替换 js 中的域名，使前端域名校验失效。 如果访问其它路径，则返回原有内容。 这么做是有局限的。 只读，无法登陆，无法评论。仅仅做展示用。 部分第三发接口无法调用（反正是只读，也没啥问题） ","date":"2020-07-28","objectID":"/notion/:1:0","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/#原理说明"},{"categories":["Notion"],"content":"准备工作 域名一个 Cloudflare 帐号一枚 （后面简称 cf） ","date":"2020-07-28","objectID":"/notion/:2:0","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/#准备工作"},{"categories":["Notion"],"content":"操作过程 域名 DNS 服务器设置为 cf （略）。 为域名配置一条 a 记录，ip 地址随便填（不知道填什么就 ping 下 www.cloudfare.com ，例如 104.17.209.9 ），但是要通过 cf proxy，打开 Cloudflare 的「DNS」编辑页面，添加一条记录。如下图： 注意，其中的 IPv4 地址部分，虽然你可以改成任意 DNS 的 IP，或者是你自己的服务器，但是当你的 IP 为国内 IP 时，有概率会因为备案问题而 404。 创建 Workers，查看如下的“worker 代码” 添加一条 route，并指向上方的 worker rule ","date":"2020-07-28","objectID":"/notion/:2:1","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/#操作过程"},{"categories":["Notion"],"content":"Worker 代码 配置 worker：https://www.bilibili.com/video/av64011915/ cloudfare网址链接：https://dash.cloudflare.com 复制下面代码 第一行改为你的域名。 第二行改为你想让访问者看到的首页地址。 例如 我想要用户 访问 link.zhaouncle.com 时，跳转到指定的页面（Home 页） 例如：https://www.notion.so/e00f6db6166e47279acab60c32094e37?v=efe4879069ed4d5b880c7118fb3a370a const MY_DOMAIN = \"link.zhaouncle.com\" const START_PAGE = \"https://www.notion.so/e00f6db6166e47279acab60c32094e37?v=efe4879069ed4d5b880c7118fb3a370a\" addEventListener('fetch', event =\u003e { event.respondWith(fetchAndApply(event.request)) }) const corsHeaders = { \"Access-Control-Allow-Origin\": \"*\", \"Access-Control-Allow-Methods\": \"GET, HEAD, POST,PUT, OPTIONS\", \"Access-Control-Allow-Headers\": \"Content-Type\", } function handleOptions(request) { if (request.headers.get(\"Origin\") !== null \u0026\u0026 request.headers.get(\"Access-Control-Request-Method\") !== null \u0026\u0026 request.headers.get(\"Access-Control-Request-Headers\") !== null) { // Handle CORS pre-flight request. return new Response(null, { headers: corsHeaders }) } else { // Handle standard OPTIONS request. return new Response(null, { headers: { \"Allow\": \"GET, HEAD, POST, PUT, OPTIONS\", } }) } } async function fetchAndApply(request) { if (request.method === \"OPTIONS\") { return handleOptions(request) } let url = new URL(request.url) let response if (url.pathname.startsWith(\"/app\") \u0026\u0026 url.pathname.endsWith(\"js\")) { response = await fetch(`https://www.notion.so${url.pathname}`) let body = await response.text() try { response = new Response(body.replace(/www.notion.so/g, MY_DOMAIN).replace(/notion.so/g, MY_DOMAIN), response) // response = new Response(response.body, response) response.headers.set('Content-Type', \"application/x-javascript\") console.log(\"get rewrite app.js\") } catch (err) { console.log(err) } } else if ((url.pathname.startsWith(\"/api\"))) { response = await fetch(`https://www.notion.so${url.pathname}`, { body: request.body, // must match 'Content-Type' header headers: { 'content-type': 'application/json;charset=UTF-8', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36' }, method: \"POST\", // *GET, POST, PUT, DELETE, etc. }) response = new Response(response.body, response) response.headers.set('Access-Control-Allow-Origin', \"*\") } else if (url.pathname === `/`) { let pageUrlList = START_PAGE.split(\"/\") let redrictUrl = `https://${MY_DOMAIN}/${pageUrlList[pageUrlList.length-1]}` return Response.redirect(redrictUrl, 301) } else { response = await fetch(`https://www.notion.so${url.pathname}`, { body: request.body, // must match 'Content-Type' header headers: request.headers, method: request.method, // *GET, POST, PUT, DELETE, etc. }) } return response } 参考网站： https://gine.me/posts/466ca19681634b09b123067f880ea396?nsukey=cgA3O8FAmy0q877VvsS2i1DFyHR%2Bk9iwyM%2F%2B7M5zbx9ii20yrqWZwmmKVzd2a2n80FH9U9OaZ1rHrF6UKlksZ6e57XVwZKydlJ1TDg3NtQLHBaeBiAn9%2FIQ9v%2FeKcQKvQfjgpr7xuwiuo8LPMSu6WEyBl3bIUTeXEwj5qHQ8hKXZvERUVYXFT54%2BmbaxpC4RoS7TIgdiB8AAc098g0WUWw%3D%3D https://www.notion.so/URL-e1620aa7a9204c289e0be7c65eaeef48 ","date":"2020-07-28","objectID":"/notion/:2:2","series":null,"tags":["Notion"],"title":"Notion 绑定自定义域名","uri":"/notion/#worker-代码"},{"categories":["github"],"content":"Github 个人主页玩耍初试","date":"2020-07-27","objectID":"/githubtry/","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/"},{"categories":["github"],"content":"1. 个人主页 自定义个人主页之后你会发现除了项目的展示，还有个人的其他信息介绍。下面是小编设计的个人主页，初次尝试，请勿见笑！ ","date":"2020-07-27","objectID":"/githubtry/:1:0","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#1-个人主页"},{"categories":["github"],"content":"2. 在你的 github 上创建一个新仓库 这个新仓库的名称要和你登录账号名称保持一致。 创建结果： ","date":"2020-07-27","objectID":"/githubtry/:2:0","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#2-在你的-github-上创建一个新仓库"},{"categories":["github"],"content":"3. 将远程仓库拉到本地电脑上 用 git clone 一下仓库并且创建 README.md 文件，执行以下命令 git clone git@github.com: 你用户名 / 你用户名. git ","date":"2020-07-27","objectID":"/githubtry/:3:0","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#3-将远程仓库拉到本地电脑上"},{"categories":["github"],"content":"4. 这个时候开始我们的自定义风格页面玩耍了 ","date":"2020-07-27","objectID":"/githubtry/:4:0","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#4-这个时候开始我们的自定义风格页面玩耍了"},{"categories":["github"],"content":"4.1 在你的 README 中 获取动态生成的 GitHub 统计信息！ 上面的 README.md 我插入一个图片，可以实时展示你 github 仓库的一些数据信息，是通过一个链接实现的，如下图，记得设置链接的参数 username = 你的用户名 统计卡片示例： 语言统计： ","date":"2020-07-27","objectID":"/githubtry/:4:1","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#41-在你的-readme-中-获取动态生成的-github-统计信息httpsgithubcomanuraghazragithub-readme-statsblobmasterreadme_cnmd"},{"categories":["github"],"content":"5.完成上面几步之后，我们就可以开始推送到你的远程仓库 手动测试命令成功能够推送之后，直接一个 sh 脚本在当前实现就好啦，每次手动 sh update.sh 就能推送到 github 代码库了。 $ cat update.sh #!/bin/bash git add . git commit -m \"update\" git push -u origin master 上面的按照上面的步骤做完之后就可以查看属于你风格的个人主页了。 感兴趣的小伙伴们快去试试吧！ ","date":"2020-07-27","objectID":"/githubtry/:5:0","series":null,"tags":["github"],"title":"Github 个人主页","uri":"/githubtry/#5完成上面几步之后我们就可以开始推送到你的远程仓库"},{"categories":["Thoughts","庄子"],"content":"逍遥游","date":"2020-07-19","objectID":"/%E5%BA%84%E5%AD%90/","series":null,"tags":["庄子"],"title":"庄子*逍遥游","uri":"/%E5%BA%84%E5%AD%90/"},{"categories":["Thoughts","庄子"],"content":" “吾生也有涯，而知也无涯。以有涯随无涯，殆已！已而为知者，殆而已矣！为善无近名，为恶无近刑，缘督以为经，可以保身，可以全生，可以养亲，可以尽年。”——《庄子·内篇·养生主第三》 ","date":"2020-07-19","objectID":"/%E5%BA%84%E5%AD%90/:0:0","series":null,"tags":["庄子"],"title":"庄子*逍遥游","uri":"/%E5%BA%84%E5%AD%90/#"},{"categories":["Thoughts","人物自传"],"content":"一个人的气质里，藏着她读过的书","date":"2020-06-27","objectID":"/%E6%9E%97%E5%BE%BD%E5%9B%A0/","series":null,"tags":["林徽因"],"title":"林徽因","uri":"/%E6%9E%97%E5%BE%BD%E5%9B%A0/"},{"categories":["Thoughts","人物自传"],"content":" 一身诗意千寻爆，万古人间四月天 大姒嗣徽音，则百斯男。出自《诗·大雅·思齐》 林清玄说：“一个人的气质里，藏着她读过的书” 可谓腹有诗书气自华之奇女子典范也 ","date":"2020-06-27","objectID":"/%E6%9E%97%E5%BE%BD%E5%9B%A0/:0:0","series":null,"tags":["林徽因"],"title":"林徽因","uri":"/%E6%9E%97%E5%BE%BD%E5%9B%A0/#"},{"categories":["hugo"],"content":"hugo 使用 LoveIt 主题搭建个人博客","date":"2020-06-27","objectID":"/hugo_02/","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/"},{"categories":["hugo"],"content":"使用一些简单的 shell 脚本处理自己的 hugo 博客和搜索 ","date":"2020-06-27","objectID":"/hugo_02/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#"},{"categories":["hugo"],"content":"1 config.toml 配置 ","date":"2020-06-27","objectID":"/hugo_02/:1:0","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#1-configtoml-配置"},{"categories":["hugo"],"content":"1.1 首先我们配置好 config.toml 的 algolia 的配置 # 搜索配置 [languages.zh-cn.params.search] enable = true # 搜索引擎的类型 (\"lunr\", \"algolia\") type = \"algolia\" # 文章内容最长索引长度 contentLength = 4000 # 搜索框的占位提示语 placeholder = \"搜索\" # 最大结果数目 maxResultLength = 10 # 结果内容片段长度 snippetLength = 50 # 搜索结果中高亮部分的 HTML 标签 highlightTag = \"em\" # 是否在搜索索引中使用基于 baseURL 的绝对路径 absoluteURL = true [languages.zh-cn.params.search.algolia] index = \"index.zh-cn\" #algolia 里面的 index 名称相对应，如果你有多语言版本，那么就需要创建多个语言的 index，我这里仅举例中文的版本 appID = \"\" searchKey = \"\" ","date":"2020-06-27","objectID":"/hugo_02/:1:1","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#11-首先我们配置好-configtoml-的-algolia-的配置"},{"categories":["hugo"],"content":"2 Algolia 配置 ","date":"2020-06-27","objectID":"/hugo_02/:2:0","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#2-algolia-配置"},{"categories":["hugo"],"content":"2.1 登录 Algolia 官网 ，注册账号，创建 Application 名为 “test01”作为举例，默认选择 “FREE” 即可，这里自定义名称 ","date":"2020-06-27","objectID":"/hugo_02/:2:1","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#21-登录-algolia-官网httpswwwalgoliacom-注册账号创建-application-名为-test01作为举例默认选择-free-即可这里自定义名称"},{"categories":["hugo"],"content":"2.2 我这里选择香港作为存储地区 ","date":"2020-06-27","objectID":"/hugo_02/:2:2","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#22-我这里选择香港作为存储地区"},{"categories":["hugo"],"content":"2.3 创建index，要与config.toml 的配置 index 一样 ","date":"2020-06-27","objectID":"/hugo_02/:2:3","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#23-创建index要与configtoml-的配置-index-一样"},{"categories":["hugo"],"content":"2.4 将 API Keys 里面补充到 config.toml 里面 ","date":"2020-06-27","objectID":"/hugo_02/:2:4","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#24-将-api-keys-里面补充到-configtoml-里面"},{"categories":["hugo"],"content":"2.5 如何删除不需要的APP ","date":"2020-06-27","objectID":"/hugo_02/:2:5","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#25-如何删除不需要的app"},{"categories":["hugo"],"content":"2.5.1 找到设置界面 ","date":"2020-06-27","objectID":"/hugo_02/:2:6","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#251-找到设置界面"},{"categories":["hugo"],"content":"2.5.2 进入 Applications 配置，点击 小三点进行删除 ","date":"2020-06-27","objectID":"/hugo_02/:2:7","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#252-进入-applications-配置点击-小三点进行删除"},{"categories":["hugo"],"content":"3 使用 atomic-algolia 来完成自动更新索引 ","date":"2020-06-27","objectID":"/hugo_02/:3:0","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#3-使用-atomic-algoliahttpsgithubcomchrisdmacraeatomic-algolia-来完成自动更新索引"},{"categories":["hugo"],"content":"3.1 首先安装 npm，这里不介绍 ","date":"2020-06-27","objectID":"/hugo_02/:3:1","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#31-首先安装-npm这里不介绍"},{"categories":["hugo"],"content":"3.2 安装 atomic-algolia npm -g install atomic-algolia ","date":"2020-06-27","objectID":"/hugo_02/:3:2","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#32-安装-atomic-algolia"},{"categories":["hugo"],"content":"3.3 创建 .env 文件存放 algolia 配置 注意：只有执行hugo 生成静态文件，才会在 public 目录生成index.json 索引。 ALGOLIA_APP_ID=\"8GC6CRN3M8\" ALGOLIA_ADMIN_KEY=\"d4467e8c57c2b12f53da9c8ec1c629be\" ALGOLIA_INDEX_NAME=\"index.zh-cn\" ALGOLIA_INDEX_FILE=\"public/index.json\" ","date":"2020-06-27","objectID":"/hugo_02/:3:3","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#33--创建-env-文件存放-algolia-配置"},{"categories":["hugo"],"content":"3.4 创建 push_algolia_json.js 脚本 var atomicalgolia = require(\"atomic-algolia\") var indexName = process.env.ALGOLIA_INDEX_NAME var indexPath = process.env.ALGOLIA_INDEX_FILE var cb = function(error, result) { if (error) throw error console.log(result) } atomicalgolia(indexName, indexPath, cb) ","date":"2020-06-27","objectID":"/hugo_02/:3:4","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#34-创建-push_algolia_jsonjs-脚本"},{"categories":["hugo"],"content":"3.5 手动执行将索引到 algolia source .env node push_algolia_json.js ","date":"2020-06-27","objectID":"/hugo_02/:3:5","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#35-手动执行将索引到-algolia"},{"categories":["hugo"],"content":"4 定制化脚本 ","date":"2020-06-27","objectID":"/hugo_02/:4:0","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#4-定制化脚本"},{"categories":["hugo"],"content":"4.1 统一脚本deploy.sh，配合Hugo（一）Github Pages 搭建个人博客 #!/bin/sh # If a command fails then the deploy stops set -e start_local_hugo_server(){ hugo server --disableFastRender } update_algolia(){ cd ../ type=`cat config.toml|grep -A 5 \"languages.zh-cn.params.search\"|grep type|awk -F'\"' '{print $2}'` if [ \"$type\" == \"algolia\" ];then source .env node push_algolia_json.js printf \"\\033[0;32m已经更新到 algolia ！！！\\033[0m\\n\" fi } pushMyBlogHugo(){ printf \"\\033[0;32mDeploying updates to GitHub \"https://github.com/ZhaoUncle/MyBlogHugo\"\\033[0m\\n\" git pull # Add changes to git. git add . # Commit changes. msg=\"change MyBlogHugo site $(date)\" if [ \"$#\" -gt 1 ]; then msg=\"$2\" fi git commit -m \"$msg\" # Push source and build repos. git push origin master } push_zhaouncle(){ printf \"\\033[0;32mDeploying updates to GitHub \"https://github.com/ZhaoUncle/zhaouncle.github.io\"\\033[0m\\n\" # Build the project. hugo # if using a theme, replace with `hugo -t \u003cYOURTHEME\u003e` # Go To Public folder cd public git pull # Add changes to git. git add . # Commit changes. msg=\"rebuilding site $(date)\" if [ \"$#\" -gt 1 ]; then msg=\"$2\" fi git commit -m \"$msg\" # Push source and build repos. git push origin master update_algolia } case $1 in 1) start_local_hugo_server ;; 2) pushMyBlogHugo $* ;; 3) push_zhaouncle $* ;; 4) hugo serve -e production ;; 5) hugo server --source=themes/LoveIt/exampleSite ;; esac 脚本解析： sh deploy.sh 1：启动 hugo 作为本地调试使用，实时将文章的内容更新到站点，不需要重启也能边修改边观看效果。 sh deploy.sh 2：将 MyHugoBlog 上传到 Github 存储库。 sh deploy.sh 3：将 public 静态文件站点上传到Github Pages 存储库，并更新 algolia 的索引。 sh deploy.sh 4：主要是用来调试 cdn，评论系统等，所以要用 production 变量来启动。 sh deploy.sh 5：查看官方例子，方便调试。 ","date":"2020-06-27","objectID":"/hugo_02/:4:1","series":null,"tags":["hugo","博客"],"title":"Hugo（二）algolia 博客搜索及自动化处理脚本","uri":"/hugo_02/#41-统一脚本deploysh配合hugo一github-pages-搭建个人博客httpszhaounclecom202006hugo"},{"categories":["Thoughts","随笔"],"content":"2020 年端午节有想","date":"2020-06-26","objectID":"/20200626/","series":null,"tags":["无言"],"title":"于 2020 年 6 月 26 日","uri":"/20200626/"},{"categories":["Thoughts","随笔"],"content":"2020 年端午节有想 就像北岛写道：“那时，我们有梦，关于文学，关于爱情，关于理想，关于穿越世界的旅行。如今我们深夜饮酒，杯子碰到一起，都是梦破碎的声音。” ​ 偶然间看到这么一句话，翘起了二郎腿，挠挠不怎么聪明的脑袋，总感觉得来一瓶啤酒才能消愁，如果不能，可能需要两瓶。鉴于自己不会喝酒，想想只能放弃这种不是很成熟确是成年人最常用的手段，于是写起了 blog。 ​ 昨天是端午节，也是放假的第一天，很神奇的起床去爬山，深圳的铁仔山公园，这是第二次，上午 9 点钟这个不算早不算晚的时间点，骑着 ofo 过去就已经开始流了满头大汗。 😌，千篇一律的皮囊下面的厚重脂肪开始了无声的反抗。 ​ 生活的千篇一律，工作的两点一线，可能已经麻木了大多数人的神经，都是为了活着而生活。拨开那一层层的浮华，褪去了虚荣的外表，便只剩下一个孤独的灵魂了吧，也或许是纯净的也说不定，不过始终不可能如孩童刚降临人间般纯粹了。俗世的大染缸终究是左一撇右一撇的挥斥方遒，将纯净的纸张，书写着自己一生的故事，一副含有插画的自传。也不知是否有水墨画如清明上河图那样的巨作诞生，起码过了 26 了，我还是没看见这样的兆头。当然，偶尔做做梦还是可以有的。 ​ 在山顶上找了个无人的阶梯躺下，闭上双眼，除了一身湿透的戎装在树荫下，渐渐被清风逐凉，难得一丝清净。 ","date":"2020-06-26","objectID":"/20200626/:0:0","series":null,"tags":["无言"],"title":"于 2020 年 6 月 26 日","uri":"/20200626/#"},{"categories":["ELK"],"content":"【ELK】centos7 安装 elk 7.6.2","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/"},{"categories":["ELK"],"content":"1. 初始化环境 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#1-初始化环境"},{"categories":["ELK"],"content":"1.0 初始化环境官网参考 https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config.html ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#10-初始化环境官网参考"},{"categories":["ELK"],"content":"1.1 架构 主机 ip hostname 安装的服务 192.168.110.245 node01 es、kibana 192.168.110.246 node02 es、logstash、filebeat、auditbeat 192.168.110.247 node03 es、filebeat、auditbeat ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#11-架构"},{"categories":["ELK"],"content":"1.2 配置 hosts cat \u003c\u003c EOF \u003e\u003e /etc/hosts 192.168.110.245 node01 192.168.110.246 node02 192.168.110.247 node03 EOF ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#12-配置-hosts"},{"categories":["ELK"],"content":"1.3 修改 hostname hostnamectl set-hostname node01 hostnamectl set-hostname node02 hostnamectl set-hostname node03 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#13-修改-hostname"},{"categories":["ELK"],"content":"1.4 时间同步(联网状态) yum -y install ntpdate /bin/echo \"* */1 * * * /usr/sbin/ntpdate pool.ntp.org \u003e /dev/null 2\u003e\u00261\" \u003e\u003e /var/spool/cron/root ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:5:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#14-时间同步联网状态"},{"categories":["ELK"],"content":"1.5 关闭 selinux setenforce 0 #临时，马上生效 sed -i 's/enforcing/disabled/' /etc/selinux/config #永久，重启生效 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:6:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#15-关闭-selinux"},{"categories":["ELK"],"content":"1.6 关闭防火墙 iptables -F systemctl stop firewalld systemctl disable firewalld ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:7:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#16-关闭防火墙"},{"categories":["ELK"],"content":"1.7 内存解锁和文件限制 #临时修改，重启失效 ulimit -n 65535 #永久修改，重启生效 cat \u003c\u003c EOF \u003e\u003e/etc/security/limits.conf elasticsearch soft memlock unlimited elasticsearch hard memlock unlimited * soft nofile 65535 * hard nofile 65535 EOF ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:8:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#17-内存解锁和文件限制"},{"categories":["ELK"],"content":"1.8 关闭 swap 缓存 swapoff -a #临时 sed -i '/swap/s/^/#/' /etc/fstab #永久 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:9:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#18-关闭-swap-缓存"},{"categories":["ELK"],"content":"1.9 设置 es 用户内存限制大小 sysctl -w vm.max_map_count=262144 echo 'vm.max_map_count=262144' \u003e\u003e /etc/sysctl.conf ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:10:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#19-设置-es-用户内存限制大小"},{"categories":["ELK"],"content":"1.10 不能 root 用户启动 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:11:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#110-不能-root-用户启动"},{"categories":["ELK"],"content":"1.11 java版本 es 7.*之后的版本不需要安装环境 java，默认自带 jdk 环境，但是其他的服务还是需要 jdk 环境的，所以还是要统一安装，另外 jdk 版本要为 8 或者 11，我这里默认 8 就好了，直接 yum 安装 yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:12:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#111-java版本"},{"categories":["ELK"],"content":"2. 安装 es 集群 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#2-安装-es-集群"},{"categories":["ELK"],"content":"2.1 官网下载 wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.2-x86_64.rpm wget https://artifacts.elastic.co/downloads/kibana/kibana-7.6.2-x86_64.rpm wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.6.2-x86_64.rpm wget https://artifacts.elastic.co/downloads/logstash/logstash-7.6.2.rpm wget https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-7.6.2-x86_64.rpm ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#21-官网下载"},{"categories":["ELK"],"content":"2.2 yum 直接安装则可 yum -y install elasticsearch yum -y install kibana yum -y install filebeat yum -y install auditbeat ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#22-yum-直接安装则可"},{"categories":["ELK"],"content":"2.3 es 配置修改，3 台机都要，其中 node.name 配置不同，其他一样 cd /etc/elasticsearch/ \u0026\u0026 cp elasticsearch.yml elasticsearch.yml.orig cat \u003c\u003c EOF \u003e elasticsearch.yml cluster.name: es-cluster node.name: node01 path.data: /var/lib/elasticsearch path.logs: /var/log/elasticsearch bootstrap.memory_lock: true network.host: 0.0.0.0 http.port: 9200 discovery.seed_hosts: [\"192.168.110.245\", \"192.168.110.246\", \"192.168.110.247\"] cluster.initial_master_nodes: [\"node01\"] xpack.security.enabled: true xpack.security.transport.ssl.enabled: true xpack.security.transport.ssl.verification_mode: certificate xpack.security.transport.ssl.keystore.path: elastic-certificates.p12 xpack.security.transport.ssl.truststore.path: elastic-certificates.p12 xpack.security.audit.enabled: true xpack.security.audit.logfile.events.emit_request_body: true EOF #node02: sed -i 's#node\\.name\\:\\ node01#node.name: node02#' /etc/elasticsearch/elasticsearch.yml #node03: sed -i 's#node\\.name\\:\\ node01#node.name: node03#' /etc/elasticsearch/elasticsearch.yml 解释说明： cluster.name 集群名字，同一个集群中使用相同名字，单机就随意 node.name: es-cluster 节点名字，每台机都不一样 bootstrap.memory_lock: true 将进程地址所在 RAM 空间中，以防止 es 内存被换出，交换对性能，节点稳定性非常不利，应不惜一切代价避免交换。它可能导致垃圾收集持续数分钟而不是毫秒，并且可能导致节点响应缓慢甚至断开与群集的连接。在弹性分布式系统中，让操作系统杀死该节点更为有效。 1、如果你的机器已经全局进制swap，那么不开启这个配置也无所谓。详情查看 1.8 配置 2、或者配置了/etc/sysctl.conf 的 vm.swappiness = 1 ，所以也不需要配置 true 3、如果以上两个你都没做，那你还是乖乖把 true 配置上。我这里都做了，也不影响。 network.host: 0.0.0.0 需要外网 ip 可以这么配置，不然配置内网也行 http.port: 9200 端口号，不配置的话默认9200 discovery.seed_hosts: [\"192.168.110.245\", \"192.168.110.246\", \"192.168.110.247\"] 这里可以不指定，不过避免 es 回环查找，直接指定方便 cluster.initial_master_nodes: [\"node-1\"] 首次启动 es 集群指定 master 机器，之后重启和添加新服务器都无需更改 xpack.security.enabled: true 启用 xpack 安全模块 xpack.security.transport.ssl.enabled: true TLS 功能，可对通信进行加密 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#23-es-配置修改3-台机都要其中-nodename-配置不同其他一样"},{"categories":["ELK"],"content":"2.4 如果是 yum 安装的方式需要修改es的启动文件 参考地址 cat /usr/lib/systemd/system/elasticsearch.service [Service] LimitMEMLOCK=infinity 修改命令： sed -i '/\\[Service\\]/a\\LimitMEMLOCK=infinity' /usr/lib/systemd/system/elasticsearch.service 修改完之后要reload 一下 sudo systemctl daemon-reload ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#24-如果是-yum-安装的方式需要修改es的启动文件"},{"categories":["ELK"],"content":"2.5 如果你要设置 es 的内存大小，有两个地方 1、jvm.options cat /etc/elasticsearch/jvm.options -Xms512m -Xmx512m 2、这里不做介绍，以上一种为常用方法，如果你设置的 java PATH 有问题，可以在这里面指定 java 环境。 /etc/sysconfig/elasticsearch ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:5:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#25-如果你要设置-es-的内存大小有两个地方"},{"categories":["ELK"],"content":"2.6 在 node01 配置证书，我这里设置的空密码，直接回车便可。 /usr/share/elasticsearch/bin/elasticsearch-certutil ca /usr/share/elasticsearch/bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 cp /usr/share/elasticsearch/{elastic-stack-ca.p12,elastic-certificates.p12} /etc/elasticsearch/ chmod 640 /etc/elasticsearch/elastic-certificates.p12 #scp /etc/elasticsearch/elastic-certificates.p12 root@node02:/etc/elasticsearch/ #scp /etc/elasticsearch/elastic-certificates.p12 root@node03:/etc/elasticsearch/ 生成CA证书 bin/elasticsearch-certutil ca，将产生新文件 elastic-stack-ca.p12。该 elasticsearch-certutil 命令还会提示你输入密码以保护文件和密钥，请保留该文件的副本并记住其密码。 为集群中的每个节点生成证书和私钥 bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12，将产生新文件 elastic-certificates.p12。系统还会提示你输入密码，你可以输入证书和密钥的密码，也可以按Enter键将密码留空。默认情况下 elasticsearch-certutil 生成没有主机名信息的证书，这意味着你可以将证书用于集群中的每个节点，另外要关闭主机名验证。 注意：如果你在创建证书时输入了密码，那可以通过下面的方法设置。 /usr/share/elasticsearch/bin/elasticsearch-keystore add xpack.security.transport.ssl.keystore.secure_password /usr/share/elasticsearch/bin/elasticsearch-keystore add xpack.security.transport.ssl.truststore.secure_password ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:6:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#26--在-node01-配置证书我这里设置的空密码直接回车便可"},{"categories":["ELK"],"content":"2.7 node01启动 es systemctl start elasticsearch systemctl enable elasticsearch systemctl status elasticsearch ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:7:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#27-node01启动-es"},{"categories":["ELK"],"content":"2.8 node01，配置账号密码完成tls通信 命令： /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive 结果： [root@node01 elasticsearch]# /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive Initiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user. You will be prompted to enter passwords as the process progresses. Please confirm that you would like to continue [y/N]y Enter password for [elastic]: Reenter password for [elastic]: Passwords do not match. Try again. Enter password for [elastic]: Reenter password for [elastic]: Enter password for [apm_system]: Reenter password for [apm_system]: Enter password for [kibana]: Reenter password for [kibana]: Enter password for [logstash_system]: Reenter password for [logstash_system]: Enter password for [beats_system]: Reenter password for [beats_system]: Enter password for [remote_monitoring_user]: Reenter password for [remote_monitoring_user]: Changed password for user [apm_system] Changed password for user [kibana] Changed password for user [logstash_system] Changed password for user [beats_system] Changed password for user [remote_monitoring_user] Changed password for user [elastic] 检查：检查 node01是否启动并且密码访问正常 [root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456 ip heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name 192.168.110.245 12 90 3 0.07 0.08 0.08 dilm * node01 注意的问题： 证书权限没设置，创建好默认为 600，手动修改为 640 启动报错相关： org.elasticsearch.ElasticsearchSecurityException: failed to load SSL configuration [xpack.security.transport.ssl] Caused by: org.elasticsearch.ElasticsearchException: failed to initialize SSL TrustManager - not permitted to read truststore file [/etc/elasticsearch/elastic-certificates.p12] Caused by: java.nio.file.AccessDeniedException: /etc/elasticsearch/elastic-certificates.p12 权限查看及修改 [root@node01 elasticsearch]# ll /etc/elasticsearch/elastic-certificates.p12 -rw------- 1 640 elasticsearch 3451 Apr 16 18:57 elastic-certificates.p12 [root@node01 elasticsearch]# chmod 640 /etc/elasticsearch/elastic-certificates.p12 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:8:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#28-node01配置账号密码完成tls通信"},{"categories":["ELK"],"content":"2.9 将 node01 的证书 scp 到 02 和 03，并启动 02 和 03的 es 这里有三个证书 elasticsearch.keystore：这里存放的是 elastic和 123456 的账号密码，给 es 集群使用，默认读取 elastic-stack-ca.p12：这个是 ca 初始证书，保存好就行，生成完 cert 之后用处不大 elastic-certificates.p12：这个是 cert 验证证书，es 集群就是通过这个证书完成 scp /etc/elasticsearch/{elasticsearch.keystore,elastic-stack-ca.p12,elastic-certificates.p12} root@node02:/etc/elasticsearch/ scp /etc/elasticsearch/{elasticsearch.keystore,elastic-stack-ca.p12,elastic-certificates.p12} root@node03:/etc/elasticsearch/ systemctl start elasticsearch systemctl enable elasticsearch systemctl status elasticsearch ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:9:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#29-将-node01-的证书-scp-到-02-和-03并启动-02-和-03的-es"},{"categories":["ELK"],"content":"2.10 基于 api 的检查，集群是否搭建成功。 #查看集群健康状态 curl http://192.168.110.245:9200/_cat/health?v -u elastic:123456 #查看集群节点 curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456 可以发现 es 集群 ok 了！我们可以发现 node01 的 master 字段值为*，没错，它就是 master 节点了。 [root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/health?v -u elastic:123456 epoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent 1591345666 08:27:46 es-cluster green 3 3 2 1 0 0 0 0 - 100.0% [root@node01 elasticsearch]# curl http://192.168.110.245:9200/_cat/nodes?v -u elastic:123456 ip heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name 192.168.110.245 20 91 0 0.00 0.01 0.05 dilm * node01 192.168.110.246 21 78 63 0.42 0.14 0.08 dilm - node02 192.168.110.247 29 76 13 0.89 0.29 0.13 dilm - node03 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:10:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#210-基于-api-的检查集群是否搭建成功"},{"categories":["ELK"],"content":"3. 安装 es 的 web UI ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#3-安装-es-的-web-ui"},{"categories":["ELK"],"content":"3.0 有哪些 web ui ElasticHD 我喜欢用这个，因为临时使用可以直接./ElasticHD 启动，方便快捷。 有 sql 转 json 的小工具，很好用 https://github.com/360EntSecGroup-Skylar/ElasticHD/ elasticsearch-HQ 要安装 python3.6 有 es 默认的接口查询，还有 node 节点的监控数据 https://github.com/ElasticHQ/elasticsearch-HQ/ dejavu 支持从 json 和 csv 导入导出数据 https://github.com/appbaseio/dejavu/ cerebro https://github.com/lmenezes/cerebro elasticsearch-head https://github.com/mobz/elasticsearch-head elasticsearch-browser 不支持 5.0 之后 https://github.com/OlegKunitsyn/elasticsearch-browser elasticsearch-kopf 支持 2.0之前,cerebro 是其替代品 https://github.com/lmenezes/elasticsearch-kopf ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#30-有哪些-web-ui"},{"categories":["ELK"],"content":"3.1 如果带账号密码访问的话 url http://elastic:123456@192.168.110.245:9200 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#31-如果带账号密码访问的话-url"},{"categories":["ELK"],"content":"3.2 安装web UI管理工具ElasticHD: 普通安装： （1）安装supervisord yum -y install supervisor echo_supervisord_conf \u003e supervisord.conf systemctl start supervisord systemctl enable supervisord （2）安装 elasticHD yum -y install xdg-utils cd /usr/local/src/ wget https://github.com/360EntSecGroup-Skylar/ElasticHD/releases/download/1.4/elasticHD_linux_amd64.zip unzip elasticHD_linux_amd64.zip chmod 0777 ElasticHD mv ElasticHD /usr/local/bin/ cat \u003c\u003cEOF\u003e /etc/supervisord.d/ElasticHD.ini [program:ElasticHD] command=/usr/local/bin/ElasticHD -p 0.0.0.0:9800 autostart=true autorestart=true user=elasticsearch redirect_stderr=true stdout_logfile=/tmp/ElasticHD.log EOF supervisorctl update supervisorctl reload supervisorctl status docker 安装： docker run -p 9800:9800 -d --link elasticsearch:demo containerize/elastichd web端访问结果：http://192.168.110.245:9800/ ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#32-安装web-ui管理工具elastichd"},{"categories":["ELK"],"content":"3.3 安装 elasticsearch -HQ 普通安装： (1)安装python3.6 yum install python3 python3-pip python3-devel -y (2) 安装 elasticsearch-HQ cd /usr/local/src/ wget -O elasticsearch-HQ.zip https://github.com/ElasticHQ/elasticsearch-HQ/archive/master.zip unzip elasticsearch-HQ.zip mv elasticsearch-HQ-master /usr/local/elasticsearch-HQ cd /usr/local/elasticsearch-HQ pip3 install -r requirements.txt cat \u003c\u003cEOF\u003e /etc/supervisord.d/ElasticHQ.ini [program:ElasticHQ] command=/usr/bin/python3 /usr/local/elasticsearch-HQ/application.py --host 0.0.0.0 --port 5000 autostart=true autorestart=true #user=elasticsearch redirect_stderr=true stdout_logfile=/tmp/ElasticHQ.log EOF supervisorctl update supervisorctl reload supervisorctl status docker 安装 docker run -p 5000:5000 elastichq/elasticsearch-hq web端访问结果：http://192.168.110.245:5000/ ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#33-安装-elasticsearch--hq"},{"categories":["ELK"],"content":"4. 安装 Kibana ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#4-安装-kibana"},{"categories":["ELK"],"content":"4.1 引用： Kibana是一个针对Elasticsearch的开源分析及可视化平台，用来搜索、查看交互存储在Elasticsearch索引中的数据。使用Kibana，可以通过各种图表进行高级数据分析及展示。 Kibana让海量数据更容易理解。它操作简单，基于浏览器的用户界面可以快速创建仪表板（dashboard）实时显示Elasticsearch查询动态。 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#41-引用"},{"categories":["ELK"],"content":"4.2 安装： yum -y install kibana-7.6.2-x86_64.rpm #创建日志路径 mkdir /var/log/kibana touch /var/log/kibana/kibana.log chmod -R 755 /var/log/kibana/ chown -R kibana /var/log/kibana/ ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#42-安装"},{"categories":["ELK"],"content":"4.3 修改配置文件 [root@node01 elk]# cat /etc/kibana/kibana.yml |grep -Ev '^#|^$' #kibana 端口号 server.port: 5601 #kibana 内网 ip server.host: \"192.168.110.245\" #es 的地址 elasticsearch.hosts: [\"http://192.168.110.245:9200\"] #es 的账号密码，在配置 tls 通信的时候那里就设置了的 elasticsearch.username: \"kibana\" elasticsearch.password: \"123456\" #记录发送到 es 的查询 elasticsearch.logQueries: true # 日志路径 logging.dest: /var/log/kibana/kibana.log # 禁止显示除错误消息以外的所有日志记录输出。 logging.quiet: true # 记录所有日志事件，包括系统使用情况信息和所有请求 logging.verbose: false # 开启 xpack xpack.security.enabled: true ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#43-修改配置文件"},{"categories":["ELK"],"content":"4.4 启动 systemctl restart kibana systemctl status kibana ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#44-启动"},{"categories":["ELK"],"content":"4.5 open kibana url http://192.168.110.245:5601/ ，这里要用 elastic 账号登录，使用 kibana 登录是无法，会报错 403 没权限 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:5:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#45-open-kibana-url"},{"categories":["ELK"],"content":"4.6 内存限制 参考资料：https://www.elastic.co/guide/en/kibana/7.2/production.html#load-balancing-es 默认内存限制 1.4GB，如果过需要可以通过环境变量进行替换，一般不需要更改。 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:6:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#46-内存限制"},{"categories":["ELK"],"content":"5. node02 安装 logstash ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#5-node02-安装-logstash"},{"categories":["ELK"],"content":"5.1 安装 logstash yum -y install logstash-7.6.2.rpm cp /etc/logstash/logstash.yml /etc/logstash/logstash.yml.orig ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#51-安装-logstash"},{"categories":["ELK"],"content":"5.2 配置文件 [root@node02 elk]# cat /etc/logstash/logstash.yml|grep -Ev '#|^$' path.data: /var/lib/logstash # 配置自动加载配置，这样就无须在更改配置时手动重启 logstash 引起数据丢失 config.reload.automatic: true # 自动加载的时间 config.reload.interval: 10s path.logs: /var/log/logstash ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#52-配置文件"},{"categories":["ELK"],"content":"5.3 修改内存地址 vim /etc/logstash/jvm.options -Xms1g -Xmx1g ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#53-修改内存地址"},{"categories":["ELK"],"content":"5.4 手动测试，输入 hello cd /usr/share/logstash ./bin/logstash -e 'input { stdin { } } output { stdout { } }' hello ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#54-手动测试输入-hello"},{"categories":["ELK"],"content":"6. node02、03安装 filebeat ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#6-node0203安装-filebeat"},{"categories":["ELK"],"content":"6.1 安装 yum -y install filebeat-7.6.2-x86_64.rpm cd /etc/filebeat cp filebeat.yml filebeat.yml.orig ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#61-安装"},{"categories":["ELK"],"content":"7. 日志处理 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:0:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#7-日志处理"},{"categories":["ELK"],"content":"案例一：官方例子 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:1:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#案例一官方例子"},{"categories":["ELK"],"content":"参考： https://www.elastic.co/guide/en/logstash/7.7/plugins-inputs-beats.html https://www.elastic.co/guide/en/logstash/current/advanced-pipeline.html ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:2:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#参考"},{"categories":["ELK"],"content":"7.1.1在 node02 调整 logstash 配置 cd /etc/logstash/conf.d/ cat \u003c\u003cEOF\u003e /etc/logstash/conf.d/example.conf input { beats { port =\u003e 5044 } } output { elasticsearch { hosts =\u003e [\"http://192.168.110.245:9200\"] index =\u003e \"%{[@metadata][beat]}-%{[@metadata][version]}\" user =\u003e \"elastic\" password =\u003e \"123456\" } } EOF systemctl restart logstash ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:3:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#711在-node02-调整-logstash-配置"},{"categories":["ELK"],"content":"7.1.2检查端口是否启动： [root@node02 elk]# netstat -nltp|grep 5044 tcp6 0 0 :::5044 :::* LISTEN 31422/java ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:4:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#712检查端口是否启动"},{"categories":["ELK"],"content":"7.1.3 在 node02 配置 filebeat cd /root/src/elk wget https://download.elastic.co/demos/logstash/gettingstarted/logstash-tutorial.log.gz gzip -d logstash-tutorial.log.gz cat \u003c\u003cEOF\u003e filebeat.yml filebeat.inputs: - type: log paths: - /root/src/elk/logstash-tutorial.log output.logstash: hosts: [\"192.168.110.246:5044\"] EOF ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:5:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#713-在-node02-配置-filebeat"},{"categories":["ELK"],"content":"7.1.4 启动 filebeat /usr/share/filebeat/bin/filebeat -e -c filebeat.yml -d \"publish\" 启动结果部分截图： ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:6:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#714-启动-filebeat"},{"categories":["ELK"],"content":"7.1.5 在 kibana 打开“Management”-»“Elasticsearch”-»“IndexManagement”，可以看到 filebeat 的索引 然后我们到 kiabana 那里添加 index 试试。 创建成功 最后我们到 Discover 这里就可以看到相关试图了 ","date":"2020-06-08","objectID":"/centos7-%E5%AE%89%E8%A3%85-elk7/:7:0","series":null,"tags":["ELK","elasticsearch","kibana","logstash"],"title":"【ELK】Centos7 安装 elk 7.6.2","uri":"/centos7-%E5%AE%89%E8%A3%85-elk7/#715-在-kibana-打开management-elasticsearch-indexmanagement可以看到-filebeat-的索引"},{"categories":["hugo"],"content":"hugo 使用 LoveIt 主题搭建个人博客","date":"2020-06-05","objectID":"/hugo/","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/"},{"categories":["hugo"],"content":"序言 Hugo 号称构建网站最快的框架，看过其他相关资料，hexo 在文章数量大的前提下，建站成静态文件的速度很慢，另外从主题（themes）这个角度去考虑，简单也是我的首选，于是从 hugo 下手自己的第一个博客网站。 ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#序言"},{"categories":["hugo"],"content":"安装 mac 安装 hugo brew install hugo 确认安装成功，可用命令行检查版本号进行测试 hugo version 其他平台可用直接下载二进制包进行使用，无需编译 https://github.com/gohugoio/hugo/releases ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#安装"},{"categories":["hugo"],"content":"构建 hugo 项目 新建博客站点 hugo new site MyBlogHugo 创建完站点后的文件结构 MyBlogHugo ├── archetypes │ └── default.md ├── config.toml ├── content ├── data ├── layouts ├── static └── themes ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#构建-hugo-项目"},{"categories":["hugo"],"content":"添加 LoveIt 主题 Why choose it? 在 Hugo 主题市场 挑了半天，还是决定用 LoveIt 这个主题。 这个 themes 简单好看，功能齐全，作者也一直在努力更新，还支持多语言版本，包括 seo、搜索等功能都有，可以参考 demo 地址。 将主题作为子模块 cd MyBlogHugo git init git submodule add https://github.com/dillonzq/LoveIt.git themes/LoveIt ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#添加-loveit-主题"},{"categories":["hugo"],"content":"启动 hugo server 启动 hugo 作为本地调试使用，在浏览器打开 http://localhost:1313/ 即可查看效果。 hugo server --disableFastRender 参数含义： disableFastRender：实时将文章的内容更新到站点，不需要重启也能边修改边观看效果。 生成静态文件，会在MyBlogHugo 下面生成 public 的静态文件目录 hugo 我是使用 LoveIt 主题自带的 exampleSite 的 config.toml 来进行修改和配置的。 cd MyBlogHugo cp themes/LoveIt/exampleSite/config.toml . 创建博客文章之前，我会使用example 的默认创建初始化详情来进行配置和修改. cp themes/LoveIt/archetypes/default.md archetypes/ # 这样，你每次创建文章的时候，都会使用这里的默认配置进行创建 hugo new posts/test01.md default.md 查看 \\--- title: \"{{ replace .TranslationBaseName \"-\" \" \" | title }}\" subtitle: \"\" date: {{ .Date }} lastmod: {{ .Date }} draft: false #是否作为草稿，如果为 true，不会生产静态文件到 public 目录 author: \"赵叔\" authorLink: \"\" description: \"\" tags: [] categories: [] hiddenFromHomePage: false hiddenFromSearch: false featuredImage: \"\" featuredImagePreview: \"\" toc: enable: true #是 否展开右边目录栏 math: enable: false lightgallery: false license: \"\" \\--- \u003c!--more--\u003e ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#启动-hugo-server"},{"categories":["hugo"],"content":"配置 Github Pages 登录 github，在设置那里创建个人 repo 仓库，一共 2 个，一个是 .github.io 作为个人站点 public 的静态文件，一个是 MyBlogHugo 作为除了 public 这个静态目录的所有文件的仓库。记得创建空repo，不要添加 README 文件哦。 初始化仓库 MyBlogHugo，public 目录要忽略，不上传 cd MyBlogHugo echo \"!public/\" \u003e\u003e .gitignore git init git remote add origin git@github.com:ZhaoUncle/MyBlogHugo.git git add . git commit -m \"no public\" git pull --rebase origin master git push -u origin master 初始化仓库 zhaouncle.github.io cd public git init git remote add origin git@github.com:ZhaoUncle/zhaouncle.github.io.git git add . git commit -m \"my blog hugo\" git pull --rebase origin master git push -u origin master 之后就可以打开 http://\u003cusername\u003e.github.io 进入到你的博客了。 ","date":"2020-06-05","objectID":"/hugo/:0:0","series":null,"tags":["hugo","博客"],"title":"Hugo（一）Github Pages 搭建个人博客","uri":"/hugo/#配置-github-pages"},{"categories":["Thoughts","随笔"],"content":"万事开头难 博客本来自 18 年始就有念头，一拖再拖，主要自己懒又不够专注，当然我也不会承认是我自己“无才”之无奈。 ","date":"2020-06-05","objectID":"/%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE/:0:0","series":null,"tags":["无言"],"title":"万事开头难","uri":"/%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE/#万事开头难"},{"categories":["Thoughts","不尽如书"],"content":"闲来读之，不尽如书","date":"2020-06-02","objectID":"/books/","series":null,"tags":["阅读"],"title":"Books","uri":"/books/"},{"categories":["Thoughts","不尽如书"],"content":"《知行合一王阳明》，by 度阴山，2020 年 4 月 《张居正（全集）》，by 熊召政，2020 年 5 月 《人人都是产品经理：写给产品新人》，by苏杰，2020 年 6 月 《白说》，by白岩松，2020 年 7 月 2 日 《中国通史》，by 钱穆讲授 叶龙记录整理，2020 年 8 月 19 日 《人生如逆旅，我亦是行人》，by 余光中，2020 年 9 月 14 日 《技巧：如何用一年时间获得十年的经验》，by 郝培强，9 月 26 日 《人生不过一念间：南怀瑾的 15 堂人生智慧课》，by 柠檬树编著，10 月 14 日 ","date":"2020-06-02","objectID":"/books/:0:0","series":null,"tags":["阅读"],"title":"Books","uri":"/books/#"},{"categories":["前端"],"content":"【layui】tepmlet 格式化 table 数据","date":"2020-01-04","objectID":"/layui_templet-%E6%A0%BC%E5%BC%8F%E5%8C%96/","series":null,"tags":["layui"],"title":"【layui】tepmlet 格式化 table 数据","uri":"/layui_templet-%E6%A0%BC%E5%BC%8F%E5%8C%96/"},{"categories":["前端"],"content":"代码如下所示 \u003cscript src=\"/static/vendor/layuimini/lib/layui-v2.5.5/layui.js\" charset=\"utf-8\"\u003e\u003c/script\u003e \u003cscript\u003e layui.use(['form', 'table'], function () { var $ = layui.jquery, form = layui.form, table = layui.table; table.render({ elem: '#currentTableId', url: '/user/queryjson', toolbar: '#toolbarDemo', defaultToolbar: ['filter', 'exports', 'print', { title: '提示', layEvent: 'LAYTABLE_TIPS', icon: 'layui-icon-tips' }], cols: [[ {type: \"checkbox\", width: 50}, {field: 'id', width: 80, title: 'ID', sort: true}, {field: 'name', width: 80, title: '用户名'}, {field: 'sex', width: 80, title: '性别', sort: true, templet: sexFormat}, {field: 'tel', width: 120, title: '联系方式'}, {field: 'addr', width: 120, title: '地址'}, {field: 'birthday', width: 180, title: '生辰', templet: birFormat}, {title: '操作', minWidth: 150, toolbar: '#currentTableBar', align: \"center\"} ]], limits: [10, 15, 20, 25, 50, 100], limit: 15, page: true, skin: 'line' }); // 格式化显示男女信息，后端返回 true 或者 false，这里做判断 function sexFormat(d) { var str; if (d.sex) { str = '男'; } else { str = '女'; } return str; } // 格式化显示日期，调用layui.util 工具集，参考：https://www.layui.com/doc/modules/util.html function birFormat(d) { birday = layui.util.toDateString(d.birthday, \"yyyy-MM-dd\"); return birday; } }); \u003c/script\u003e ###参考 https://m.yisu.com/zixun/12217.html ","date":"2020-01-04","objectID":"/layui_templet-%E6%A0%BC%E5%BC%8F%E5%8C%96/:0:1","series":null,"tags":["layui"],"title":"【layui】tepmlet 格式化 table 数据","uri":"/layui_templet-%E6%A0%BC%E5%BC%8F%E5%8C%96/#代码如下所示"},{"categories":null,"content":"about me？ 博主非常懒，无颜之，也无以言之。 ","date":"0001-01-01","objectID":"/about/:0:0","series":null,"tags":null,"title":"","uri":"/about/#"},{"categories":null,"content":"#友情链接 怡红院落 一些常用的相关链接 loveit Doc：有关 loveit 的相关文档介绍 LoveIt Github Algolia：用于网站搜索 atomic-algolia：自动更新 index.json ","date":"0001-01-01","objectID":"/link/:0:0","series":null,"tags":null,"title":"","uri":"/link/#"},{"categories":null,"content":"title: “随口胡诌之短句” subtitle: \"\" date: 2020-09-08T11:23:53+08:00 lastmod: 2020-09-08T11:23:53+08:00 draft: false author: “赵叔” authorLink: \"\" description: “于 2020 年 9 月 6 日始于“小不点”” tags: [‘无言’] categories: [‘Thoughts’,‘随笔’] hiddenFromHomePage: false hiddenFromSearch: false featuredImage: “https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/小不点.png” featuredImagePreview: “https://cdn.jsdelivr.net/gh/ZhaoUncle/image@main/blog/小不点.png” toc: enable: true math: enable: false lightgallery: false license: \"\" 以下要么为摘抄，要么随口胡诌之 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:0","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#"},{"categories":null,"content":"2021 年 04 月 25 日 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:1","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日"},{"categories":null,"content":"2021 年 04 月 25 日 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:2","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-1"},{"categories":null,"content":"2021 年 04 月 25 日 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:3","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-2"},{"categories":null,"content":"2021 年 04 月 25 日 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:4","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-3"},{"categories":null,"content":"2021 年 04 月 25 日 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:5","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-4"},{"categories":null,"content":"2021 年 04 月 25 日 我慢慢地、慢慢地了解到，所谓父女母子一场，只不过意味着，你和他的缘分就是今生今世不断地在目送他的背影渐行渐远。——《目送》龙应台 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:6","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-5"},{"categories":null,"content":"2021 年 04 月 25 日 你在的城市，天下起了雨，很想问你有没有带伞，可我却忍住了，因为我怕你说没带，而我却无能为力。——宫崎骏 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:7","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-6"},{"categories":null,"content":"2021 年 04 月 25 日 平时总拿追求安逸平凡作为生活的目标，其实是给自己懒惰找的借口而已。为什么要读书，下面是在知乎里看到的答案， 我读过很多书，但后来大部分都被我忘记了，那阅读的意义是什么？ 答：当我还是个孩子的时候，我吃过很多食物，现在已经记不起来吃过什么了。但可以肯定的是，它们中的一部分已经长成为我的骨头和肉。 ——《知乎 》 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:8","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-7"},{"categories":null,"content":"2021 年 04 月 25 日 这些年我一直提醒自己一件事情，千万不要自己感动自己。大部分人看似的努力，不过是愚蠢导致的。什么熬夜看书到天亮，连续几天只睡几小时，多久没放假了，如果这些东西也值得夸耀，那么富士康流水线上任何一个人都比你努力多了。人难免天生有自怜的情绪，唯有时刻保持清醒，才能看清真正的价值在哪里。 ——于宙TEDx演讲：我们这一代人的困惑 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:9","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-04-月-25-日-8"},{"categories":null,"content":"2021 年 03 月 10 日 书上说，在我们生活的周围，往任何方向延伸一公里，都有我们不熟悉的地方，都有值得我们去探索和拍摄。 生活在别处总是充满想象。 可在你这里，总是充满着踌躇 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:10","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-03-月-10-日"},{"categories":null,"content":"2021 年 01 月 28 日 以大多数人努力程度之低，根本轮不到拼智商。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:11","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-28-日"},{"categories":null,"content":"2021 年 01 月 28 日 你站在桥上看风景，看风景的人在楼上看你。明月装饰了你的窗子，你装饰了别人的梦。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:12","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-28-日-1"},{"categories":null,"content":"2021 年 01 月 28 日 宜将剩勇追穷寇，不可沽名学霸王。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:13","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-28-日-2"},{"categories":null,"content":"2021 年 01 月 26 日 ——张小娴 无论你对家人、恋人和朋友付出多少，无论你做得多好，不要期望回报。 等待回报是多么寂寥？相识、相爱、成为家人，都是今生的因缘。 尽了自己的责任就是惜缘，你是这样流着泪狠狠地珍惜过，无愧就好；惟其如此，你才不会失望和伤心，也才不会抱怨。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:14","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-26-日"},{"categories":null,"content":"2021 年 01 月 26 日 有些人血里有风，注定要一生漂泊。 ——《武林外传》 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:15","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-26-日-1"},{"categories":null,"content":"2021 年 01 月 26 日 印度著名的灵性导师·克里希那穆提曾说过： 自由与爱是并存的，爱不是一种反应，如果我爱你是因为你爱我，那么这只是交易，爱变成了在市场上被卖的东西，那显然不是爱。 爱是不求回报的，甚至不感觉你给予了什么，只有这种爱，才能是你自由。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:16","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-26-日-2"},{"categories":null,"content":"2021 年 01 月 26 日 须知道，人生苦短，能够走在一起的，本身就是缘分。至于一起能走多远，就是彼此的际遇了。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:17","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-26-日-3"},{"categories":null,"content":"2021 年 01 月 26 日 “拟把疏狂图一醉，对酒当歌，强乐还无味。衣带渐宽终不悔，为伊消得人憔悴。” ——《蝶恋花》柳永 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:18","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-26-日-4"},{"categories":null,"content":"2021 年 01 月 17 日 上帝撒下了智慧，你却撑起了伞。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:19","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-17-日"},{"categories":null,"content":"2021 年 01 月 17 日 保性全真，不以外物累形。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:20","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-17-日-1"},{"categories":null,"content":"2021 年 01 月 17 日 人呐，不能既要，又要，总要拿某些东西去替换某些东西，想要得到总得付出某些代价。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:21","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-17-日-2"},{"categories":null,"content":"2021 年 01 月 17 日 应然 实然 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:22","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-17-日-3"},{"categories":null,"content":"2021 年 01 月 16 日 永远不要在别人生命的废墟上 ​ 呼啸而过 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:23","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-16-日"},{"categories":null,"content":"2021 年 01 月 16 日 少年啊 他特别酷 他出走半生 归来仍是少年 成年啊 他出走半生 归来不发一言 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:24","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-16-日-1"},{"categories":null,"content":"2021 年 01 月 16 日 生活啊 好比那黑夜里漫长的路 走过的人 他从不说出来 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:25","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-16-日-2"},{"categories":null,"content":"2021 年 01 月 16 日 胸有激雷而面如平湖者，可拜上将军。——《孙子兵法》 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:26","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-16-日-3"},{"categories":null,"content":"2021 年 01 月 16 日 人最可怕的就是，骗过自己。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:27","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-16-日-4"},{"categories":null,"content":"2021 年 01 月 10 日 曾经以为 30 岁很遥远，却发现 18 岁已经是很久以前的事了，时光好不经用，抬眼已是半生。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:28","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日"},{"categories":null,"content":"2021 年 01 月 10 日 人为什么会流眼泪，大概就是眼睛代替了嘴巴说不出来的悲伤。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:29","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-1"},{"categories":null,"content":"2021 年 01 月 10 日 我哪有能力顾及所有人的感受，我自己的心情，我都照顾不好。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:30","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-2"},{"categories":null,"content":"2021 年 01 月 10 日 我从来不指望任何人心疼我，为我扛下所有。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:31","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-3"},{"categories":null,"content":"2021 年 01 月 10 日 很多关系，走到最后不过是相识一场。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:32","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-4"},{"categories":null,"content":"2021 年 01 月 10 日 可不可以跟世界请个假啊，我想暂时离开一下。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:33","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-5"},{"categories":null,"content":"2021 年 01 月 10 日 时间不会让人忘了痛，只会让人习惯了痛！ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:34","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-6"},{"categories":null,"content":"2021 年 01 月 10 日 家人应该是彼此的安全网，而不是束缚的缰绳。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:35","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-7"},{"categories":null,"content":"2021 年 01 月 10 日 只要思想不滑坡，方法总比困难多。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:36","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-8"},{"categories":null,"content":"2021 年 01 月 10 日 我向你表白，如果你不同意的话也没关系，我只希望今后，你灰心的时候记得有人曾喜欢你。陪你走完了这顿路，我也就变成了你路过的路，从此人山人海，愿各遇良人。 以前我喜欢长得好看的，现在喜欢相处舒服的。越长大越会觉得，一辈子能遇上一个你说上半句，他能接下半句的人有多难！ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:37","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-10-日-9"},{"categories":null,"content":"2021 年 01 月 07 日 人生太过复杂，我也不是万事明了，能送给你的只有四个字「好好感受」。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:38","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-07-日"},{"categories":null,"content":"2021 年 01 月 07 日 You wouldn’t plant a seed and then dig it up every few minutes to see if it has grown. So why do you keep questioning yourself, your hard work and your decisions? Have patience, stop overthinking and keep watering your seeds. ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:39","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-07-日-1"},{"categories":null,"content":"2021 年 01 月 05 日 每个人只能赚自己认知的钱，理解的越深刻，赚得越多。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:40","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-05-日"},{"categories":null,"content":"2021 年 01 月 04 日 其实，我挺想找你聊天的 但看到你爱理不理的样子 突然就不想说了 因为我怕为难了你 也难堪了我自己 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:41","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-04-日"},{"categories":null,"content":"2021 年 01 月 02 日 静中藏了一个争字 稳中藏了一个急字 忙中藏了一个亡字 忍中藏了一个刀字 越想争心越要静 越急心越要稳 越忙越要照顾好自己 越忍越要看清事态！ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:42","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2021-年-01-月-02-日"},{"categories":null,"content":"2020 年 12 月 23 日 是谁来自山川湖海，却囿于昼夜、厨房与爱。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:43","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-12-月-23-日"},{"categories":null,"content":"2020 年 12 月 23 日 不管和谁结婚，过一段时间，都会有激情消退的时候，你在没有激情的时候仍然能保持爱，才算是真的爱一个人。所以说离婚不需要冷静期，结婚才需要。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:44","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-12-月-23-日-1"},{"categories":null,"content":"2020 年 12 月 23 日 毕竟过去的已经过去，就像拜伦的《春逝》——**若我会见到你，事隔经年。我如何和你招呼，以眼泪，以沉默。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:45","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-12-月-23-日-2"},{"categories":null,"content":"2020 年 12 月 23 日 毕竟过去的已经过去，就像拜伦的《春逝》——**若我会见到你，事隔经年。我如何和你招呼，以眼泪，以沉默。 ###2020 年 12 月 22 日 别因渴望你没有的，而错过你已拥有的；要知道，你现在拥有的，也曾是你渴望的。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:46","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-12-月-23-日-3"},{"categories":null,"content":"2020 年 09 月 29 日 每个人都很孤独。在我们的一生中，遇到爱，遇到性，都不稀罕，稀罕的是遇到了解。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:47","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-29-日"},{"categories":null,"content":"2020 年 09 月 13 日 能否做常驻嘉宾 那就要看你怎么去做的呀 如果啥也不做 那也只能做个特邀嘉宾 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:48","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日"},{"categories":null,"content":"2020 年 09 月 13 日 会觉得但凡有趣一点，子这个遥远的国度面对着冰冷的微信文字，我也会出现嘴角上扬的表情呀 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:49","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-1"},{"categories":null,"content":"2020 年 09 月 13 日 有你在，有所期待，有所爱。 会不会，等遇到了就知道了，等明白了也就明白了 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:50","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-2"},{"categories":null,"content":"2020 年 09 月 13 日 纯洁与美好，是柏拉图对爱情的理解。 这位伟大的哲学家，曾经请教苏格拉底，何为爱情？ 苏格拉底让他去果园摘一颗最大最好的桃子，但只能摘一次，且不能回头。 柏拉图最后空手而归，问他为什么，他说：“因为只能摘一次，又不能回头，即使期间看到了最大最饱满的那颗桃子，也因为不知道后面还会不会有更大的而放弃。走到最后面时发现都不如以前的那一颗大而饱满，所以直到走出桃园，也没有摘。” 就怕你看不懂我，而我最后成了那个一无所有的人 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:51","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-3"},{"categories":null,"content":"2020 年 09 月 13 日 我爱你，如你所是 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:52","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-4"},{"categories":null,"content":"2020 年 09 月 13 日 什么是爱情？ 王小波对李银河说：“一想到你，我这张丑脸就泛起了微笑。” 三毛对荷西说：“不多不多，以后还可以少吃一点。” 钱钟书对杨绛说：“没遇到你之前，我没想过结婚，遇见你，结婚这事我没想过和别人。” 其实爱情的定义很简单，就是一屋两人，三餐四季，执子之手，相伴余生。 相信吧，总会有那么一个人，寻你而来，与你一起待霜染白发，陪你看细水长流。 以彼一生，休戚与共。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:53","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-5"},{"categories":null,"content":"2020 年 09 月 13 日 怎么说呢，老实人也不少，不想随便找个，可偏偏总是遇上一些经历了太多的女人 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:54","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-6"},{"categories":null,"content":"2020 年 09 月 13 日 我住长江头,君住长江尾； 日日思君不见君,共饮潮汕茶 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:55","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-7"},{"categories":null,"content":"2020 年 09 月 13 日 一艘孤舟寒江上，你与鱼对望，隔着千重镜 水波岂能无痕，任，千帆浪涛涛，负一人少就，独自漂流 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:56","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-8"},{"categories":null,"content":"2020 年 09 月 13 日 会觉得但凡有趣一点，在这个遥远的国度面对着冰冷的微信文字，我也会出现嘴角上扬的表情呀 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:57","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-9"},{"categories":null,"content":"2020 年 09 月 13 日 雨落成帘，阻断了在远方眺望的视线，落雨念思愁 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:58","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-10"},{"categories":null,"content":"2020 年 09 月 13 日 善良给错了人，会让人心寒；心软给错了人，会让人心痛；有时候啊，人心换不了人心；但是，我们不能放弃善良。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:59","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-11"},{"categories":null,"content":"2020 年 09 月 13 日 喜欢两人一屋三餐四季有你的朝夕，最美不过是有你的天气，你看草木皆情如此如醉、相偎相依。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:60","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-12"},{"categories":null,"content":"2020 年 09 月 13 日 父母在，人生尚有来处；父母去，人生只剩归途。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:61","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-13-日-13"},{"categories":null,"content":"2020 年 09 月 12 日 这辈子不打算活太老，等把养我的人送走就可以收队了，人间没太多意思，下辈子不来了 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:62","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-12-日"},{"categories":null,"content":"2020 年 09 月 10 日 想想你小的时候，紧紧握住不肯放开的小手拉着大手，如今看着挂上了皱纹的脸角，除了深邃的眼神，还有无处安放的大手 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:63","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-10-日"},{"categories":null,"content":"2020 年 09 月 09 日 相约去爬山，你爬得快先到达顶峰看日出，我爬的慢再到顶峰看夕阳，达到一样的高度，看的不同的风景，又何须在乎他人呢？ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:64","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-09-日"},{"categories":null,"content":"2020 年 09 月 08 日 听君一声劝，前路漫漫，可回头看过往，却不可转身往回走。 切莫听心惘了身. 《活着》苟活着，如行尸走般在人生的舞台戏上表演者，压抑的鼓声点缀着哭泣的灵魂，那拙劣的演技与不堪的低沉的喘息声，如履薄冰，蹒跚前行 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:65","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-08-日"},{"categories":null,"content":"2020 年 09 月 07 日 没有，只是觉得人性的自私与愚蠢在涉及到自己利益的时候，体现的淋漓尽致；这样有时候为了大家利益着想，偏偏有些人的自私与愚蠢总会迫不及待的展现出来；然后自己气的火大，觉得别人没用脑子想 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:66","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-07-日"},{"categories":null,"content":"2020 年 09 月 06 日 如白驹过隙，在素描纸上提笔的瞬间划过，留下淡淡的痕迹 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:67","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-06-日"},{"categories":null,"content":"2020 年 09 月 03 日 或许我们在这条前人已经倒下去很多的路途上，无法增光添彩，做不出成绩，不过我们当初不是因为喜欢才做的么，喜欢是我们自己能够抉择的，如果连自己都嫌弃自己了，当初的味道不也是变了吗，世上无难事只怕有心人，即便难于上青天，不也还有飞机送你上去么，想一下从人类文明史开始到飞机出现也有 5000 多年了，而飞机到现在才 100 年左右，你这点算个啥 嗯嗯，不忘初心 热爱不减 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:68","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-09-月-03-日"},{"categories":null,"content":"2020 年 08 月 31 日 一曲肛肠断，天涯何处觅知音 赠你条白绫[奸笑] ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:69","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-31-日"},{"categories":null,"content":"2020 年 08 月 28 日 雨，该是一滴湿漉漉的灵魂，窗外在喊谁。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:70","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-28-日"},{"categories":null,"content":"2020 年 08 月 27 日 终是庄周梦了蝶，你是恩赐也是劫。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:71","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-27-日"},{"categories":null,"content":"2020 年 08 月 25 日 陈根未作去年花， 奕奕天姿照碧纱。 慧影精神知绝俗， 美人尤胜洛阳花。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:72","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-25-日"},{"categories":null,"content":"2020 年 08 月 24 日 我甚至一秒都没有拥有过你，每次望着你远去的身影，却感觉好像失去了万千次 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:73","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-24-日"},{"categories":null,"content":"2020 年 08 月 23 日 突然想起一句话，30岁死掉，别人会说你年轻，而30岁活着，别人会说你年纪不小了 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:74","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-23-日"},{"categories":null,"content":"2020 年 08 月 22 日 初期交往，看礼貌 长期交往，看脾气 一生交往，看人品 时间真是个好东西 验证了人心 见证了人性 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:75","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-22-日"},{"categories":null,"content":"2020 年 08 月 22 日 如果 忙碌不堪的生活 还剩一点空间 那就用“任性”来填满 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:76","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-22-日-1"},{"categories":null,"content":"2020 年 08 月 22 日 突然想起一句话，你必须要塑造自己，否则你就会消失在阳光底下。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:77","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-22-日-2"},{"categories":null,"content":"2020 年 08 月 22 日 灵魂无法解脱，终究得被困在世俗的枷锁里面，心不安，则人不静。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:78","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-22-日-3"},{"categories":null,"content":"2020 年 08 月 22 日 老哥总是旧人听，越听越不是滋味，愁上心头，情浓 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:79","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-22-日-4"},{"categories":null,"content":"2020 年 08 月 20 日 突然想起一句话，你是一年走过了 365 天，还是走了一天，重复了 365 次 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:80","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-20-日"},{"categories":null,"content":"2020 年 08 月 20 日 所谓人生，就是逐渐接受自己普通平凡的事实。努力就会有回报，不过是一句美好，但是无用的客气话。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:81","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-20-日-1"},{"categories":null,"content":"2020 年 08 月 20 日 抱歉，这就是生活 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:82","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-20-日-2"},{"categories":null,"content":"2020 年 08 月 13 日 老夫最近也是少女心泛滥 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:83","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日"},{"categories":null,"content":"2020 年 08 月 13 日 每个人都是人生长河的过路客，无非就是驻足时间的长短不一，并不是留的久的人就是对的人，但是对的人一定能给你留下深刻的印象 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:84","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-1"},{"categories":null,"content":"2020 年 08 月 13 日 这个世界上只有一种真正的英雄主义，那就是认识生活的真相，并且依然热爱它 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:85","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-2"},{"categories":null,"content":"2020 年 08 月 13 日 安得广厦千万间，大庇天下寒士俱欢颜，风雨不动安如山。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:86","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-3"},{"categories":null,"content":"2020 年 08 月 13 日 成功不易，只希望年老了能笑看风云，能约 3、5 好友，品茶驻足，忆当年，争辉岁月，谁敢沉浮 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:87","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-4"},{"categories":null,"content":"2020 年 08 月 13 日 不是有句老话，种一棵树最好的时间是十年前，其次是现在 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:88","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-5"},{"categories":null,"content":"2020 年 08 月 13 日 路上的美人儿， 行色匆匆的从我身旁儿走过， 在我眨眼的那一瞬间， 已经转身消失在角落不知哪儿去了， 没有留下一片云彩， 却留有余香， 那是青春的味道 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:89","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-6"},{"categories":null,"content":"2020 年 08 月 13 日 会觉得但凡有趣一点，在这个遥远的国度面对着冰冷的微信文字，我也会出现嘴角上扬的表情呀。害~ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:90","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-7"},{"categories":null,"content":"2020 年 08 月 13 日 真他妈的矛盾。一边要求自己做自己，一边还要强撑着该有的礼貌 人啊~ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:91","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-13-日-8"},{"categories":null,"content":"2020 年 08 月 10 日 怎么说好呢，该来始终回来的吧，我其实一直在期盼着 我相信爱情，虽然我没经历过 还是希望有个人，能够，你的一生我只借一程，这一程便是余生。 也希望能有个人，我看过春风十里，见过夏至末至，试过秋光涟漪，爱过冬日暖阳，全抵不过你一句，我想见你。 懂我的人，一个足矣。 是啊，这种还是得好好的保持着，宁可没有也不要将就，人活着意思 都不容易，一辈子那么长，为何不选择懂你的人，而去选择一个搭伙过日子的人呢 丧偶式的合伙搭居过日子，行尸走肉般的苟者，太痛苦了 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:92","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-10-日"},{"categories":null,"content":"2020 年 08 月 10 日 以前总对自己说：你值得被温暖，被疼爱，你终会找到那个让你做回孩子，懂你心事的人。而在那之前，请你务必记得“沉稳，自爱，而后爱人”，你得好好照顾自己，不自卑、不将就，才能给频率相同的人，一个更好的你。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:93","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-10-日-1"},{"categories":null,"content":"2020 年 08 月 10 日 频率相同，才能相融；磁场相同，才能被懂。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:94","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-10-日-2"},{"categories":null,"content":"2020 年 08 月 10 日 不管爱与不爱，我都希望你能够不管在什么时候，都能做你自己 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:95","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-10-日-3"},{"categories":null,"content":"2020 年 08 月 10 日 你不必假装大度，你最该感谢的是，是受伤之后依然没有放弃的自己。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:96","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-10-日-4"},{"categories":null,"content":"2020 年 08 月 09 日 幸而有你，可诉衷肠 有幸有你 年纪相仿 齐疑人生 丧久了，连开心的时候都会怀疑人生，这次不怀疑了，我先睡为敬 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:97","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-09-日"},{"categories":null,"content":"2020 年 08 月 09 日 我深怕自己本非美玉，故而不敢加以辛苦琢磨，却又半信自己是块美玉，故有不肯庸庸碌碌，与瓦砾为伍，于是我渐渐脱离凡尘，远离世人结果便是——任愤懑与羞恨日益助长内心那怯弱的自尊心 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:98","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-09-日-1"},{"categories":null,"content":"2020 年 08 月 08 日 就是偶尔看到别人成双成对，遇到问题无人倾述和依靠，就真的很想要有个伴呢 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:99","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-08-日"},{"categories":null,"content":"2020 年 08 月 07 日 不必太纠结于当下，也不必太忧虑未来，当你经历过一些事情的时候，眼前的风景已经和从前不一样了。 不必担心你的前方是悬崖还是岩石，珍惜旅途的风景。有好有坏，从容面对 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:100","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日"},{"categories":null,"content":"2020 年 08 月 07 日 这里有句话赠予你：你要做一个不动声色的大人了。不准情绪化，不准偷偷想念，不准回头看。去过自己另外的生活。你要听话，不是所有的鱼都会生活在同一片海里。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:101","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-1"},{"categories":null,"content":"2020 年 08 月 07 日 现在有时候会发火，会让自己努力静下来，不要去逼性。其实都是一些屁大点事儿 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:102","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-2"},{"categories":null,"content":"2020 年 08 月 07 日 这个世界上一定存在着另外的自己，不要因为别人是否理解和欣赏，去评价自己的兴趣与理想。即便是“万里挑一”，世界上肯定有一个“有趣”的灵魂等待着与你我相遇。你和另外的自己，是时间和空间中一条线段的两个端点，只要你们不断中点前进、不断的扩大自己半径，终究会相遇。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:103","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-3"},{"categories":null,"content":"2020 年 08 月 07 日 正因为我们每个人都自以为是得认为自己拥有了“有趣”的灵魂。我也曾认为自己相当“有趣”，最后才发现，我只不过是个很“有兴趣”的人。真正“有趣”向来来之不易，形象一点的说，你觉得有趣就选了“星爸爸”的杯子，却不知道真正香醇的咖啡该如何享用。这只是有兴趣，真正的有趣的人，是了解你喜欢喝的咖啡的历史，制造，如何品尝，而不是换个杯子和咖啡 “有趣”是少有人走的一条路 再者说，“趣”是由“走”和“取”两个字组成，真正“有趣”的人，要向西天取经一样，走一条少有人走的路。走上一条追求真爱的过程：真正的爱是一种自律，自律是一种成长，成长是一种突破。化茧成蝶也好，鱼跃龙门也好，虎落平阳也罢，也许现实很残酷，我们无法取得物质上的极致享受。 我们所看到的困难是对自己的认知的局限，而你需要做的就是打破他的边界。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:104","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-4"},{"categories":null,"content":"2020 年 08 月 07 日 好看的皮囊千篇一律 有趣的灵魂万里挑一 难得的是频率相同的 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:105","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-5"},{"categories":null,"content":"2020 年 08 月 07 日 如果你曾经遇到过那么一个人，那么其他人都会变成将就，而我，不愿意将就。这是我的一直坚守的执念。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:106","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-6"},{"categories":null,"content":"2020 年 08 月 07 日 表面的幼稚，好玩，不代表我内心也是呀。只是不轻易跟人坦露心声跟内心的想法 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:107","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-7"},{"categories":null,"content":"2020 年 08 月 07 日 需要双方足够的信任。保持的当初在一起的初心。坚贞不渝的信念 起码告诉自己 自己当下选择的已经是最好了的，日后所看到的，觉得他好，也可能是是表面的，再花时间去了解，发现不是自己经历的。再掉头回来，那是不可能的了。不是所有人都会在原地等候着你 信任很重要，更重要的是，能够相知，能够清楚的认知到这样的事实和前提 就像说的，一次的背叛，足以让人跌落谷底了 一次不忠，二次不用嘛 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:108","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-8"},{"categories":null,"content":"2020 年 08 月 07 日 我不想那种过着提线木偶的生活，双方有自己的房间忙自己的事情，也可以一起在一个房间亲热，而不是吵了架还要冷着脸躺在一张床上，这种既独立又在一起生活的婚姻，才是我向往的 安静的时候你可以看你的剧，我看我的书，写我的代码，打你的游戏；热闹的时候可以一起去外面踏青，爬山，拍照，运动，吃饭 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:109","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-9"},{"categories":null,"content":"2020 年 08 月 07 日 有自己热爱的工作，爱好， 就算双方那种可以各玩各的，也可以一起玩，忙的时候各自房间干活，不忙的时候，想对方了，可以一起玩 不要拘束，拘束的夫妻生活是牢笼的开始 但是也要认清一个事实，结婚后会发现其实，还会遇到更好的异性，但是当初决定在一起了的心和意念，不因外在的诱惑而背叛 需要双方有很好的心理承受能力和拒绝诱惑的意志力 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:110","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-10"},{"categories":null,"content":"2020 年 08 月 07 日 就好像，你在看风景 ，他在画画 ，她的风景里有你的画 ，他的画里有你的风景 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:111","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-11"},{"categories":null,"content":"2020 年 08 月 07 日 比起喜欢，更想呗偏爱，没有顾虑的那种纯真 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:112","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-12"},{"categories":null,"content":"2020 年 08 月 07 日 心里有你，何须借酒，有你的日子，快乐犹存 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:113","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-13"},{"categories":null,"content":"2020 年 08 月 07 日 缘分这事能不负对方就好，想要不负此生真的很难。 不负时光，不负卿；不负春光，不负己。 在短暂的一生中，我们永远不知道自己接下来会遇见怎样的未来。专注当下，便不会错过美好。 与其杞人忧天，庸人自扰之，还不如专注的当下的那个我，不迷失不错过 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:114","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-14"},{"categories":null,"content":"2020 年 08 月 07 日 后来的我们什么都有了，却没有了我们 我最大的遗憾就是你的遗憾与我有关。 如果当时你没走，后来的我们会不会不一样？ ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:115","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-15"},{"categories":null,"content":"2020 年 08 月 06 日 你不试着依靠我一下 怎么知道我有多可靠 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:116","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-06-日"},{"categories":null,"content":"2020 年 08 月 06 日 哈哈哈我知道我只要不开口就是冷的。开口了前面的都垮掉了 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:117","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-06-日-1"},{"categories":null,"content":"2020 年 08 月 07 日 爱会 爱你不会 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:118","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-16"},{"categories":null,"content":"2020 年 08 月 07 日 蓝颜的钱可以收，一般男人的钱不能收 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:119","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-07-日-17"},{"categories":null,"content":"2020 年 08 月 04 日 我对感情不抱太大的向往啦，但希望还是有的。对朋友的要求会高一些，就感觉对我来说 朋友比爱情更热爱哈哈哈哈哈 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:120","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-08-月-04-日"},{"categories":null,"content":"2020 年 06 月 05 日 生命不是一个靠拥有而证实的过程,而是一个因失去而证伪的过程。 人这一辈子都在逐渐认识很多人,获得更多事,但只有那些少数的失去,才能让人突然发现生命到底是1么。 之后,才能更加珍惜,要选择与什么样一群人,以什么身份,共同走完以后的路。 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:121","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-06-月-05-日"},{"categories":null,"content":"2020 年 05 月 20 日 咋地，长得丑还不许自豪啊 就咱这长相，古代一战，上将军是也 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:122","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-05-月-20-日"},{"categories":null,"content":"2020 年 05月 07 日 世人皆在争渡，殊不知便是渡了，也不过是蚂蚁里头挑大象，终究挣脱不了这忙忙人世间 ","date":"0001-01-01","objectID":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/:0:123","series":null,"tags":null,"title":"","uri":"/%E9%9A%8F%E5%8F%A3%E8%83%A1%E8%AF%8C%E4%B9%8B/#2020-年-05月-07-日"}]